<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>æ¯•ä¸šè®¾è®¡ä»£ç æ€»ç»“ | Mofan</title><meta name="author" content="é»˜çƒ¦,cy.mofan@foxmail.com"><meta name="copyright" content="é»˜çƒ¦"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="è®°å½•ä¸€ä¸‹æ¯•ä¸šè®¾è®¡ä¸­é‡åˆ°çš„å„ä¸ªé—®é¢˜å¹¶å¯¹è¿™ä¸ªè¿‡ç¨‹åšä¸ªæ€»ç»“ï¼Œä¹Ÿç®—æ˜¯è®°å½•é€å»çš„å¤§å­¦æ—¶å…‰ã€‚">
<meta property="og:type" content="article">
<meta property="og:title" content="æ¯•ä¸šè®¾è®¡ä»£ç æ€»ç»“">
<meta property="og:url" content="https://mofan212.github.io/posts/Code-Summary-Of-Graduation-Project/">
<meta property="og:site_name" content="Mofan">
<meta property="og:description" content="è®°å½•ä¸€ä¸‹æ¯•ä¸šè®¾è®¡ä¸­é‡åˆ°çš„å„ä¸ªé—®é¢˜å¹¶å¯¹è¿™ä¸ªè¿‡ç¨‹åšä¸ªæ€»ç»“ï¼Œä¹Ÿç®—æ˜¯è®°å½•é€å»çš„å¤§å­¦æ—¶å…‰ã€‚">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/ArticleCover/87.png">
<meta property="article:published_time" content="2021-06-26T16:00:00.000Z">
<meta property="article:modified_time" content="2021-07-30T16:00:00.000Z">
<meta property="article:author" content="é»˜çƒ¦">
<meta property="article:tag" content="Code-In-Practice">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/ArticleCover/87.png"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "æ¯•ä¸šè®¾è®¡ä»£ç æ€»ç»“",
  "url": "https://mofan212.github.io/posts/Code-Summary-Of-Graduation-Project/",
  "image": "https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/ArticleCover/87.png",
  "datePublished": "2021-06-26T16:00:00.000Z",
  "dateModified": "2021-07-30T16:00:00.000Z",
  "author": [
    {
      "@type": "Person",
      "name": "é»˜çƒ¦",
      "url": "https://mofan212.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/favicon.png"><link rel="canonical" href="https://mofan212.github.io/posts/Code-Summary-Of-Graduation-Project/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=5.5.4"><link rel="stylesheet" href="https://testingcf.jsdelivr.net/npm/@fortawesome/fontawesome-free@latest/css/all.min.css"><link rel="stylesheet" href="https://testingcf.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://testingcf.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          const mediaQueryDark = window.matchMedia('(prefers-color-scheme: dark)')
          const mediaQueryLight = window.matchMedia('(prefers-color-scheme: light)')

          if (theme === undefined) {
            if (mediaQueryLight.matches) activateLightMode()
            else if (mediaQueryDark.matches) activateDarkMode()
            else {
              const hour = new Date().getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            mediaQueryDark.addEventListener('change', () => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else {
            theme === 'light' ? activateLightMode() : activateDarkMode()
          }
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":true,"highlightMacStyle":true},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶å¤±è´¥',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'å¤©',
  dateSuffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: {"limitCount":150,"languages":{"author":"ä½œè€…: é»˜çƒ¦","link":"é“¾æ¥: ","source":"æ¥æº: Mofan","info":"è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"å·²åˆ‡æ¢ä¸ºç¹ä½“ä¸­æ–‡","cht_to_chs":"å·²åˆ‡æ¢ä¸ºç®€ä½“ä¸­æ–‡","day_to_night":"å·²åˆ‡æ¢ä¸ºæ·±è‰²æ¨¡å¼","night_to_day":"å·²åˆ‡æ¢ä¸ºæµ…è‰²æ¨¡å¼","bgLight":"#49b1f5","bgDark":"#121212","position":"bottom-left"},
  infinitegrid: {
    js: 'https://testingcf.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'åŠ è½½æ›´å¤š'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: true,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'æ¯•ä¸šè®¾è®¡ä»£ç æ€»ç»“',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="referrer" content="no-referrer-when-downgrade" /><link rel="stylesheet" href="https://testingcf.jsdelivr.net/gh/mofan212/blog-static-resources@master/css/myStyle.min.css"><link rel="stylesheet" href="https://npm.elemecdn.com/lxgw-wenkai-screen-webfont@1.7.0/style.css" /><link rel="stylesheet" href="https://gcore.jsdelivr.net/npm/jetbrains-mono@1.0.6/css/jetbrains-mono-nl.min.css" /><link rel="stylesheet" href="/css/custom.css"><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="Mofan" type="application/atom+xml">
</head><body><script>window.paceOptions = {
  restartOnPushState: false
}

btf.addGlobalFn('pjaxSend', () => {
  Pace.restart()
}, 'pace_restart')

</script><link rel="stylesheet" href="https://testingcf.jsdelivr.net/gh/mofan212/blog-static-resources/css/minimal.min.css"/><script src="https://testingcf.jsdelivr.net/npm/pace-js/pace.min.js"></script><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/loading.gif" data-lazy-src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/avatar.jpg" onerror="this.onerror=null;this.src='https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">174</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">54</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">37</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><span class="site-page group hide"><i class="fa-fw fas fa-book-reader"></i><span> æ–‡ç« </span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> å½’æ¡£</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/schedule/"><i class="fa-fw fas fa-list-alt"></i><span> è®¡åˆ’</span></a></div><div class="menus_item"><a class="site-page" href="/update/"><i class="fa-fw fas fa-tools"></i><span> ç»´æŠ¤</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> å‹é“¾</span></a></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fa fa-comments"></i><span> ç•™è¨€æ¿</span></a></div><div class="menus_item"><span class="site-page group hide"><i class="fa-fw fa fa-heart"></i><span> å…³äº</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/about/"><i class="fa-fw fa fa-sitemap"></i><span> å…³äºæœ¬ç«™</span></a></li><li><a class="site-page child" href="/mine/"><i class="fa-fw fa fa-id-card"></i><span> å…³äºæˆ‘</span></a></li><li><a class="site-page child" href="/reward/"><i class="fa-fw fa-solid fa-coins"></i><span> èµåŠ©</span></a></li><li><a class="site-page child" href="/milestones/"><i class="fa-fw fa-solid fa-monument"></i><span> é‡Œç¨‹ç¢‘</span></a></li></ul></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://www.travellings.cn/go.html"><i class="fa-fw fas fa-subway"></i><span> å¼€å¾€</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/post_top_img.png);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">Mofan</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> æœç´¢</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><span class="site-page group hide"><i class="fa-fw fas fa-book-reader"></i><span> æ–‡ç« </span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> å½’æ¡£</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/schedule/"><i class="fa-fw fas fa-list-alt"></i><span> è®¡åˆ’</span></a></div><div class="menus_item"><a class="site-page" href="/update/"><i class="fa-fw fas fa-tools"></i><span> ç»´æŠ¤</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> å‹é“¾</span></a></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fa fa-comments"></i><span> ç•™è¨€æ¿</span></a></div><div class="menus_item"><span class="site-page group hide"><i class="fa-fw fa fa-heart"></i><span> å…³äº</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/about/"><i class="fa-fw fa fa-sitemap"></i><span> å…³äºæœ¬ç«™</span></a></li><li><a class="site-page child" href="/mine/"><i class="fa-fw fa fa-id-card"></i><span> å…³äºæˆ‘</span></a></li><li><a class="site-page child" href="/reward/"><i class="fa-fw fa-solid fa-coins"></i><span> èµåŠ©</span></a></li><li><a class="site-page child" href="/milestones/"><i class="fa-fw fa-solid fa-monument"></i><span> é‡Œç¨‹ç¢‘</span></a></li></ul></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://www.travellings.cn/go.html"><i class="fa-fw fas fa-subway"></i><span> å¼€å¾€</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">æ¯•ä¸šè®¾è®¡ä»£ç æ€»ç»“</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2021-06-26T16:00:00.000Z" title="å‘è¡¨äº 2021-06-27 00:00:00">2021-06-27</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2021-07-30T16:00:00.000Z" title="æ›´æ–°äº 2021-07-31 00:00:00">2021-07-31</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Code-In-Practice/">Code-In-Practice</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">æ€»å­—æ•°:</span><span class="word-count">12.3k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»æ—¶é•¿:</span><span>51åˆ†é’Ÿ</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">æµè§ˆé‡:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><div id="post-outdate-notice" data="{&quot;limitDay&quot;:365,&quot;messagePrev&quot;:&quot;è·ç¦»æœ¬æ–‡ä¸Šæ¬¡æ›´æ–°å·²ç»è¿‡å»&quot;,&quot;messageNext&quot;:&quot;å¤©ï¼Œè¯·æ³¨æ„æ—¶æ•ˆæ€§ã€‚&quot;,&quot;postUpdate&quot;:&quot;2021-07-31 00:00:00&quot;}" hidden></div>
    <style>
      .highlight-tools {
        background: #262931 !important;
      }
    </style>
    <html><head></head><body><p>å°é¢æ¥æºï¼šç”±åšä¸»ä¸ªäººç»˜åˆ¶ï¼Œå¦‚éœ€ä½¿ç”¨è¯·è”ç³»åšä¸»ã€‚</p>
<h1 id="0-å‰è¨€"><a class="header-anchor" href="#0-å‰è¨€"></a>0. å‰è¨€</h1>
<p>ä¸çŸ¥ä¸è§‰å¤§å­¦éƒ½è¦æ¯•ä¸šäº†ï¼Œç„¶è€Œè‡ªå·±è¿˜æ˜¯ä¸ªèœç‹— ğŸ¶ï¼Œå†™ä¸ªæ¯•ä¸šè®¾è®¡å‰ç«¯ä¸å’‹ä¼šå°±ç®—äº†ï¼Œåç«¯ä¹Ÿå†™å¾—èœ ğŸ¥¬ã€‚å›æœ›å››å¹´ï¼Œè¿™æ¯•ä¸šè®¾è®¡è¿˜æ˜¯æˆ‘çœŸæ­£å†™å®Œçš„ä¸€ä¸ªé¡¹ç›®ï¼ˆä»¥å‰çš„é¡¹ç›®è¦ä¹ˆåŠé€”è€ŒåºŸï¼Œè¦ä¹ˆä»…ä»…æ˜¯ä¸€ä¸ª demoï¼‰ã€‚</p>
<p>æ›¾å­æ›°ï¼šâ€œå¾æ—¥ä¸‰çœå¾èº«â€ï¼Œå®Œæˆäº†æ¯•ä¸šè®¾è®¡åè¿›è¡Œä¸€ä¸ªæ€»ç»“è¿˜æ˜¯å¾ˆæœ‰å¿…è¦çš„ã€‚</p>
<p>åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†ä»å‰ç«¯ä¸åç«¯è¿›è¡Œæ€»ç»“ï¼Œè™½è¯´æ˜¯æ€»ç»“ï¼Œä¹Ÿä»…ä»…æ˜¯è®°å½•ä¸€ä¸‹è‡ªå·±æ›¾ç»çš„çŸ¥è¯†ç›²ç‚¹ç½¢äº†ã€‚</p>
<p>åç«¯æŠ€æœ¯æ ˆï¼šSpringBoot + SpringSecurity + JWT + MyBatis-Plus + MapStruct + Hutoolï¼ˆé»˜è®¤å¼•å…¥ Lombokï¼‰</p>
<p>åç«¯æ•°æ®åº“ï¼šRedis + MySQL 8.0</p>
<p>å‰ç«¯æŠ€æœ¯æ ˆï¼šVue.js + Element-UI</p>
<hr>
<p>å…³äºåç«¯ JWT å’Œ SpringSecurity çš„ç›¸å…³ä½¿ç”¨ï¼Œå¯ä»¥å‚çœ‹ã€JWTçš„åŸºæœ¬ä½¿ç”¨ã€‘ä¸€æ–‡ã€‚</p>
<p>å…³äºåç«¯ MapStruct çš„ä½¿ç”¨ï¼Œå¯ä»¥å‚çœ‹ã€MapStructä½¿ç”¨æ‰‹å†Œã€‘ä¸€æ–‡ã€‚</p>
<p>å…³äºåç«¯ MyBatis-Plus çš„ä½¿ç”¨ï¼Œå¯ä»¥å‚çœ‹ã€MyBatisçš„â€œå¥½åŸºå‹â€â€”â€”MyBatisPlusã€‘ä¸€æ–‡ã€‚</p>
<h1 id="1-åç«¯-è‡ªå®šä¹‰ç±»"><a class="header-anchor" href="#1-åç«¯-è‡ªå®šä¹‰ç±»"></a>1. åç«¯ - è‡ªå®šä¹‰ç±»</h1>
<h2 id="1-1-JSR-303-å¼‚å¸¸ä¿¡æ¯ç±»"><a class="header-anchor" href="#1-1-JSR-303-å¼‚å¸¸ä¿¡æ¯ç±»"></a>1.1 JSR-303 å¼‚å¸¸ä¿¡æ¯ç±»</h2>
<p>JSR-303 å¼‚å¸¸ä¿¡æ¯ç±»ï¼Œåœ¨ä½¿ç”¨ SpringBoot è¿›è¡Œå…¨å±€å¼‚å¸¸å¤„ç†æ—¶ï¼Œé’ˆå¯¹äº§ç”Ÿçš„ <code>MethodArgumentNotValidException</code> å¼‚å¸¸è¿›è¡Œé”™è¯¯ä¿¡æ¯ç»„è£…ã€‚</p>
<figure class="highlight java line-numbers" data-language="JAVA">
        <table style="background-color: #282c34"><tbody><tr><td class="gutter" style="background-color: #282c34"><pre style="background-color: #282c34"><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code" style="background-color: #282c34"><pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF">@</span><span style="color:#E5C07B">Getter</span></span>
<span class="line"><span style="color:#ABB2BF">@</span><span style="color:#E5C07B">Setter</span></span>
<span class="line"><span style="color:#C678DD">public</span><span style="color:#C678DD"> class</span><span style="color:#E5C07B"> JSR303ExceptionMessage</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * é”™è¯¯å­—æ®µ</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     */</span></span>
<span class="line"><span style="color:#C678DD">    private</span><span style="color:#E5C07B"> String</span><span style="color:#E06C75"> field</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * é”™è¯¯å¯¹è±¡</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     */</span></span>
<span class="line"><span style="color:#C678DD">    private</span><span style="color:#E5C07B"> String</span><span style="color:#E06C75"> objectName</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * é”™è¯¯çš„å€¼</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     */</span></span>
<span class="line"><span style="color:#C678DD">    private</span><span style="color:#E5C07B"> Object</span><span style="color:#E06C75"> rejectedValue</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * é”™è¯¯ä¿¡æ¯</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     */</span></span>
<span class="line"><span style="color:#C678DD">    private</span><span style="color:#E5C07B"> String</span><span style="color:#E06C75"> errorMsg</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#ABB2BF">}</span></span></code></pre></td></tr></tbody></table>
      </figure>
<h2 id="1-2-è‡ªå®šä¹‰ä¸šåŠ¡å¼‚å¸¸ç±»"><a class="header-anchor" href="#1-2-è‡ªå®šä¹‰ä¸šåŠ¡å¼‚å¸¸ç±»"></a>1.2 è‡ªå®šä¹‰ä¸šåŠ¡å¼‚å¸¸ç±»</h2>
<figure class="highlight java line-numbers" data-language="JAVA">
        <table style="background-color: #282c34"><tbody><tr><td class="gutter" style="background-color: #282c34"><pre style="background-color: #282c34"><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code" style="background-color: #282c34"><pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic">/**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * è‡ªå®šä¹‰ä¸šåŠ¡å¼‚å¸¸ç±»ï¼Œç”¨äºåœ¨ä¸šåŠ¡å±‚æŠ›å‡ºå¼‚å¸¸</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> */</span></span>
<span class="line"><span style="color:#C678DD">public</span><span style="color:#C678DD"> class</span><span style="color:#E5C07B"> BusinessException</span><span style="color:#C678DD"> extends</span><span style="color:#E5C07B"> RuntimeException</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#C678DD">    private</span><span style="color:#C678DD"> static</span><span style="color:#C678DD"> final</span><span style="color:#C678DD"> long</span><span style="color:#E06C75"> serialVersionUID </span><span style="color:#56B6C2">=</span><span style="color:#D19A66"> 5382880814065968592L</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * é»˜è®¤å¼‚å¸¸ç </span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     */</span></span>
<span class="line"><span style="color:#C678DD">    private</span><span style="color:#E5C07B"> String</span><span style="color:#E06C75"> code </span><span style="color:#56B6C2">=</span><span style="color:#98C379"> "BOOT-001"</span><span style="color:#ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">    private</span><span style="color:#E5C07B"> Set</span><span style="color:#ABB2BF">&lt;</span><span style="color:#E5C07B">String</span><span style="color:#ABB2BF">&gt;</span><span style="color:#E06C75"> errors </span><span style="color:#56B6C2">=</span><span style="color:#C678DD"> new</span><span style="color:#E5C07B"> HashSet</span><span style="color:#ABB2BF">&lt;&gt;</span><span style="color:#E06C75">()</span><span style="color:#ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#61AFEF"> BusinessException</span><span style="color:#ABB2BF">()</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#61AFEF"> BusinessException</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">String</span><span style="color:#E06C75;font-style:italic"> code</span><span style="color:#ABB2BF">)</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#E5C07B">        this</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">code</span><span style="color:#56B6C2"> =</span><span style="color:#ABB2BF"> code;</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#61AFEF"> BusinessException</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">String</span><span style="color:#E06C75;font-style:italic"> code</span><span style="color:#ABB2BF">, </span><span style="color:#E5C07B">Throwable</span><span style="color:#E06C75;font-style:italic"> cause</span><span style="color:#ABB2BF">)</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#E5C07B">        super</span><span style="color:#ABB2BF">(cause);</span></span>
<span class="line"><span style="color:#E5C07B">        this</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">code</span><span style="color:#56B6C2"> =</span><span style="color:#ABB2BF"> code;</span></span>
<span class="line"><span style="color:#E5C07B">        this</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">errors</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">add</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">cause</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getMessage</span><span style="color:#ABB2BF">());</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#E5C07B"> BusinessException</span><span style="color:#61AFEF"> addError</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">String</span><span style="color:#E06C75;font-style:italic"> msg</span><span style="color:#ABB2BF">)</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#E5C07B">        this</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">errors</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">add</span><span style="color:#ABB2BF">(msg);</span></span>
<span class="line"><span style="color:#C678DD">        return</span><span style="color:#E5C07B"> this</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF">    @</span><span style="color:#E5C07B">Override</span></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#E5C07B"> String</span><span style="color:#61AFEF"> getMessage</span><span style="color:#ABB2BF">()</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#E5C07B">        String</span><span style="color:#E06C75"> msg</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD">        if</span><span style="color:#ABB2BF"> (</span><span style="color:#E5C07B">this</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">errors</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">isEmpty</span><span style="color:#ABB2BF">()) {</span></span>
<span class="line"><span style="color:#ABB2BF">            msg </span><span style="color:#56B6C2">=</span><span style="color:#E5C07B"> super</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getMessage</span><span style="color:#ABB2BF">();</span></span>
<span class="line"><span style="color:#ABB2BF">        } </span><span style="color:#C678DD">else</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#E5C07B">            StringBuilder</span><span style="color:#E06C75"> sb</span><span style="color:#56B6C2"> =</span><span style="color:#C678DD"> new</span><span style="color:#61AFEF"> StringBuilder</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">this</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">errors</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">size</span><span style="color:#ABB2BF">() </span><span style="color:#56B6C2">*</span><span style="color:#D19A66"> 15</span><span style="color:#ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">            for</span><span style="color:#ABB2BF"> (</span><span style="color:#E5C07B">String</span><span style="color:#E06C75"> message</span><span style="color:#C678DD"> :</span><span style="color:#E5C07B"> this</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">errors</span><span style="color:#ABB2BF">) {</span></span>
<span class="line"><span style="color:#E5C07B">                sb</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">append</span><span style="color:#ABB2BF">(message).</span><span style="color:#61AFEF">append</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">","</span><span style="color:#ABB2BF">);</span></span>
<span class="line"><span style="color:#ABB2BF">            }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B">            sb</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">deleteCharAt</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">sb</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">length</span><span style="color:#ABB2BF">() </span><span style="color:#56B6C2">-</span><span style="color:#D19A66"> 1</span><span style="color:#ABB2BF">);</span></span>
<span class="line"><span style="color:#ABB2BF">            msg </span><span style="color:#56B6C2">=</span><span style="color:#E5C07B"> sb</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">toString</span><span style="color:#ABB2BF">();</span></span>
<span class="line"><span style="color:#ABB2BF">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">        return</span><span style="color:#ABB2BF"> msg </span><span style="color:#56B6C2">==</span><span style="color:#D19A66"> null</span><span style="color:#C678DD"> ?</span><span style="color:#E5C07B"> this</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">code</span><span style="color:#ABB2BF">() </span><span style="color:#C678DD">:</span><span style="color:#ABB2BF"> msg;</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#E5C07B"> String</span><span style="color:#61AFEF"> code</span><span style="color:#ABB2BF">()</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#C678DD">        return</span><span style="color:#E5C07B"> this</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">code</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#E5C07B"> String</span><span style="color:#61AFEF"> message</span><span style="color:#ABB2BF">()</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#C678DD">        return</span><span style="color:#E5C07B"> this</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getMessage</span><span style="color:#ABB2BF">();</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF">}</span></span></code></pre></td></tr></tbody></table>
      </figure>
<h2 id="1-3-ç»Ÿä¸€è¿”å›å€¼"><a class="header-anchor" href="#1-3-ç»Ÿä¸€è¿”å›å€¼"></a>1.3 ç»Ÿä¸€è¿”å›å€¼</h2>
<p>åç«¯ Service å±‚éƒ½å°†ç»Ÿä¸€è¿”å›ä¸€ä¸ªç±»å‹ï¼Œä¾¿äºåç»­æ“ä½œã€‚</p>
<figure class="highlight java line-numbers" data-language="JAVA">
        <table style="background-color: #282c34"><tbody><tr><td class="gutter" style="background-color: #282c34"><pre style="background-color: #282c34"><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code" style="background-color: #282c34"><pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic">/**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * </span><span style="color:#C678DD;font-style:italic">@author</span><span style="color:#7F848E;font-style:italic"> mofan 2021/2/28</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * æ§åˆ¶å™¨ç»“æœä¿¡æ¯è¿”å›ç±»</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> */</span></span>
<span class="line"><span style="color:#C678DD">public</span><span style="color:#C678DD"> class</span><span style="color:#E5C07B"> Result</span><span style="color:#ABB2BF">&lt;</span><span style="color:#E5C07B">T</span><span style="color:#ABB2BF">&gt;</span><span style="color:#C678DD"> implements</span><span style="color:#E5C07B"> Serializable</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#C678DD">    private</span><span style="color:#C678DD"> static</span><span style="color:#C678DD"> final</span><span style="color:#C678DD"> long</span><span style="color:#E06C75"> serialVersionUID </span><span style="color:#56B6C2">=</span><span style="color:#D19A66"> 5244827382777974660L</span><span style="color:#ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#C678DD"> static</span><span style="color:#C678DD"> final</span><span style="color:#E5C07B"> String</span><span style="color:#E06C75"> SUCCESS_CODE </span><span style="color:#56B6C2">=</span><span style="color:#98C379"> "BOOT-000"</span><span style="color:#ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">    private</span><span style="color:#E5C07B"> String</span><span style="color:#E06C75"> code</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD">    private</span><span style="color:#E5C07B"> String</span><span style="color:#E06C75"> msg</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD">    private</span><span style="color:#E5C07B"> T</span><span style="color:#E06C75"> data</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * æ˜¯å¦éœ€è¦æ‰“å°æ—¥å¿—çš„æ ‡å¿—</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     */</span></span>
<span class="line"><span style="color:#C678DD">    private</span><span style="color:#C678DD"> boolean</span><span style="color:#E06C75"> log </span><span style="color:#56B6C2">=</span><span style="color:#D19A66"> false</span><span style="color:#ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#C678DD"> static</span><span style="color:#ABB2BF"> &lt;</span><span style="color:#E5C07B">T</span><span style="color:#ABB2BF">&gt;</span><span style="color:#E5C07B"> Result</span><span style="color:#ABB2BF">&lt;</span><span style="color:#E5C07B">T</span><span style="color:#ABB2BF">&gt;</span><span style="color:#61AFEF"> success</span><span style="color:#ABB2BF">()</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#C678DD">        return</span><span style="color:#C678DD"> new</span><span style="color:#E5C07B"> Result</span><span style="color:#ABB2BF">&lt;&gt;();</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#C678DD"> static</span><span style="color:#ABB2BF"> &lt;</span><span style="color:#E5C07B">T</span><span style="color:#ABB2BF">&gt;</span><span style="color:#E5C07B"> Result</span><span style="color:#ABB2BF">&lt;</span><span style="color:#E5C07B">T</span><span style="color:#ABB2BF">&gt;</span><span style="color:#61AFEF"> success</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">T</span><span style="color:#E06C75;font-style:italic"> data</span><span style="color:#ABB2BF">)</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#C678DD">        return</span><span style="color:#C678DD"> new</span><span style="color:#E5C07B"> Result</span><span style="color:#ABB2BF">&lt;&gt;(data);</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#C678DD"> static</span><span style="color:#ABB2BF"> &lt;</span><span style="color:#E5C07B">T</span><span style="color:#ABB2BF">&gt;</span><span style="color:#E5C07B"> Result</span><span style="color:#ABB2BF">&lt;</span><span style="color:#E5C07B">T</span><span style="color:#ABB2BF">&gt;</span><span style="color:#61AFEF"> error</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">String</span><span style="color:#E06C75;font-style:italic"> code</span><span style="color:#ABB2BF">, </span><span style="color:#E5C07B">String</span><span style="color:#E06C75;font-style:italic"> msg</span><span style="color:#ABB2BF">)</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#C678DD">        return</span><span style="color:#C678DD"> new</span><span style="color:#E5C07B"> Result</span><span style="color:#ABB2BF">&lt;&gt;(code, msg);</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#61AFEF"> Result</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">String</span><span style="color:#E06C75;font-style:italic"> code</span><span style="color:#ABB2BF">, </span><span style="color:#E5C07B">String</span><span style="color:#E06C75;font-style:italic"> msg</span><span style="color:#ABB2BF">)</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#E5C07B">        this</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">code</span><span style="color:#56B6C2"> =</span><span style="color:#ABB2BF"> code;</span></span>
<span class="line"><span style="color:#E5C07B">        this</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">msg</span><span style="color:#56B6C2"> =</span><span style="color:#ABB2BF"> msg;</span></span>
<span class="line"><span style="color:#E5C07B">        this</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">data</span><span style="color:#56B6C2"> =</span><span style="color:#D19A66"> null</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#61AFEF"> Result</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">T</span><span style="color:#E06C75;font-style:italic"> data</span><span style="color:#ABB2BF">)</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#E5C07B">        this</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">code</span><span style="color:#56B6C2"> =</span><span style="color:#ABB2BF"> SUCCESS_CODE;</span></span>
<span class="line"><span style="color:#E5C07B">        this</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">msg</span><span style="color:#56B6C2"> =</span><span style="color:#E5C07B"> ResultMsg</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">SUCCESS</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#E5C07B">        this</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">data</span><span style="color:#56B6C2"> =</span><span style="color:#ABB2BF"> data;</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#61AFEF"> Result</span><span style="color:#ABB2BF">()</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#E5C07B">        this</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">code</span><span style="color:#56B6C2"> =</span><span style="color:#ABB2BF"> SUCCESS_CODE;</span></span>
<span class="line"><span style="color:#E5C07B">        this</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">msg</span><span style="color:#56B6C2"> =</span><span style="color:#E5C07B"> ResultMsg</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">SUCCESS</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#E5C07B">        this</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">data</span><span style="color:#56B6C2"> =</span><span style="color:#D19A66"> null</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#E5C07B"> String</span><span style="color:#61AFEF"> getCode</span><span style="color:#ABB2BF">()</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#C678DD">        return</span><span style="color:#ABB2BF"> code;</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#E5C07B"> Result</span><span style="color:#ABB2BF">&lt;</span><span style="color:#E5C07B">T</span><span style="color:#ABB2BF">&gt;</span><span style="color:#61AFEF"> setCode</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">String</span><span style="color:#E06C75;font-style:italic"> code</span><span style="color:#ABB2BF">)</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#E5C07B">        this</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">code</span><span style="color:#56B6C2"> =</span><span style="color:#ABB2BF"> code;</span></span>
<span class="line"><span style="color:#C678DD">        return</span><span style="color:#E5C07B"> this</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#E5C07B"> String</span><span style="color:#61AFEF"> getMsg</span><span style="color:#ABB2BF">()</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#C678DD">        return</span><span style="color:#ABB2BF"> msg;</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#E5C07B"> Result</span><span style="color:#ABB2BF">&lt;</span><span style="color:#E5C07B">T</span><span style="color:#ABB2BF">&gt;</span><span style="color:#61AFEF"> setMsg</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">String</span><span style="color:#E06C75;font-style:italic"> msg</span><span style="color:#ABB2BF">)</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#E5C07B">        this</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">msg</span><span style="color:#56B6C2"> =</span><span style="color:#ABB2BF"> msg;</span></span>
<span class="line"><span style="color:#C678DD">        return</span><span style="color:#E5C07B"> this</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#E5C07B"> T</span><span style="color:#61AFEF"> getData</span><span style="color:#ABB2BF">()</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#C678DD">        return</span><span style="color:#ABB2BF"> data;</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#C678DD"> void</span><span style="color:#61AFEF"> setData</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">T</span><span style="color:#E06C75;font-style:italic"> data</span><span style="color:#ABB2BF">)</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#E5C07B">        this</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">data</span><span style="color:#56B6C2"> =</span><span style="color:#ABB2BF"> data;</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#C678DD"> boolean</span><span style="color:#61AFEF"> isLog</span><span style="color:#ABB2BF">()</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#C678DD">        return</span><span style="color:#E5C07B"> this</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">log</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#E5C07B"> Result</span><span style="color:#ABB2BF">&lt;</span><span style="color:#E5C07B">T</span><span style="color:#ABB2BF">&gt;</span><span style="color:#61AFEF"> setLog</span><span style="color:#ABB2BF">(</span><span style="color:#C678DD">boolean</span><span style="color:#E06C75;font-style:italic"> log</span><span style="color:#ABB2BF">)</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#E5C07B">        this</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">log</span><span style="color:#56B6C2"> =</span><span style="color:#ABB2BF"> log;</span></span>
<span class="line"><span style="color:#C678DD">        return</span><span style="color:#E5C07B"> this</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF">}</span></span></code></pre></td></tr></tbody></table>
      </figure>
<h2 id="1-4-åˆ†é¡µè¯·æ±‚å¯¹è±¡"><a class="header-anchor" href="#1-4-åˆ†é¡µè¯·æ±‚å¯¹è±¡"></a>1.4 åˆ†é¡µè¯·æ±‚å¯¹è±¡</h2>
<p>ä¸ºæ–¹ä¾¿åœ¨æŸ¥è¯¢æ—¶è¿›è¡Œåˆ†é¡µæ“ä½œï¼Œè§„å®šå°†å‰ç«¯ä¼ é€’çš„åˆ†é¡µè¯·æ±‚è¿›è¡ŒåŒ…è£…ã€‚</p>
<p><mark>æ³¨æ„ï¼š</mark> åç«¯ä½¿ç”¨çš„æ•°æ®æŒä¹…å±‚æ¡†æ¶æ˜¯ Mybatis-Plusã€‚</p>
<figure class="highlight java line-numbers" data-language="JAVA">
        <table style="background-color: #282c34"><tbody><tr><td class="gutter" style="background-color: #282c34"><pre style="background-color: #282c34"><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code" style="background-color: #282c34"><pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF">@</span><span style="color:#E5C07B">Getter</span></span>
<span class="line"><span style="color:#ABB2BF">@</span><span style="color:#E5C07B">Setter</span></span>
<span class="line"><span style="color:#ABB2BF">@</span><span style="color:#E5C07B">AllArgsConstructor</span></span>
<span class="line"><span style="color:#ABB2BF">@</span><span style="color:#E5C07B">NoArgsConstructor</span></span>
<span class="line"><span style="color:#C678DD">public</span><span style="color:#C678DD"> class</span><span style="color:#E5C07B"> PageRequest</span><span style="color:#ABB2BF">&lt;</span><span style="color:#E5C07B">T</span><span style="color:#ABB2BF">&gt;</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * å½“å‰é¡µæ•°</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     */</span></span>
<span class="line"><span style="color:#C678DD">    private</span><span style="color:#E5C07B"> Integer</span><span style="color:#E06C75"> currentPage</span><span style="color:#ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * é¡µé¢æ•°æ®å¤§å°</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     */</span></span>
<span class="line"><span style="color:#C678DD">    private</span><span style="color:#E5C07B"> Integer</span><span style="color:#E06C75"> pageSize</span><span style="color:#ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * è¯·æ±‚æ•°æ®</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     */</span></span>
<span class="line"><span style="color:#C678DD">    private</span><span style="color:#E5C07B"> Map</span><span style="color:#ABB2BF">&lt;</span><span style="color:#E5C07B">String</span><span style="color:#ABB2BF">,</span><span style="color:#E5C07B"> Object</span><span style="color:#ABB2BF">&gt;</span><span style="color:#E06C75"> data</span><span style="color:#ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * æ ¹æ® PageRequest è·å– MyBatis-Plus çš„åˆ†é¡µå¯¹è±¡</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * </span><span style="color:#C678DD;font-style:italic">@param</span><span style="color:#E06C75;font-style:italic"> pageRequest</span><span style="color:#7F848E;font-style:italic"> å‰ç«¯ä¼ é€’çš„ PageRequest ä¿¡æ¯</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * </span><span style="color:#C678DD;font-style:italic">@param</span><span style="color:#E06C75;font-style:italic"> &lt;T&gt;</span><span style="color:#7F848E;font-style:italic"> æ³›å‹</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * </span><span style="color:#C678DD;font-style:italic">@return</span><span style="color:#7F848E;font-style:italic"> MP çš„ Page åˆ†é¡µå¯¹è±¡</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     */</span></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#C678DD"> static</span><span style="color:#ABB2BF">&lt;</span><span style="color:#E5C07B">T</span><span style="color:#ABB2BF">&gt;</span><span style="color:#E5C07B"> Page</span><span style="color:#ABB2BF">&lt;</span><span style="color:#E5C07B">T</span><span style="color:#ABB2BF">&gt;</span><span style="color:#61AFEF"> getPageInfo</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">PageRequest</span><span style="color:#ABB2BF">&lt;</span><span style="color:#E5C07B">T</span><span style="color:#ABB2BF">&gt; </span><span style="color:#E06C75;font-style:italic">pageRequest</span><span style="color:#ABB2BF">)</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#C678DD">        return</span><span style="color:#C678DD"> new</span><span style="color:#E5C07B"> Page</span><span style="color:#ABB2BF">&lt;&gt;(</span><span style="color:#E5C07B">pageRequest</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getCurrentPage</span><span style="color:#ABB2BF">(), </span><span style="color:#E5C07B">pageRequest</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getPageSize</span><span style="color:#ABB2BF">());</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF">}</span></span></code></pre></td></tr></tbody></table>
      </figure>
<h2 id="1-5-æšä¸¾æ¥å£"><a class="header-anchor" href="#1-5-æšä¸¾æ¥å£"></a>1.5 æšä¸¾æ¥å£</h2>
<p>åç«¯ä¸­çš„å¤§å¤šæ•°æšä¸¾éƒ½éœ€è¦å®ç°è¿™ä¸ªæ¥å£å¹¶é‡å†™å…¶ä¸­çš„æ–¹æ³•ã€‚</p>
<figure class="highlight java line-numbers" data-language="JAVA">
        <table style="background-color: #282c34"><tbody><tr><td class="gutter" style="background-color: #282c34"><pre style="background-color: #282c34"><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code" style="background-color: #282c34"><pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic">/**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * </span><span style="color:#C678DD;font-style:italic">@author</span><span style="color:#7F848E;font-style:italic"> mofan 2021/2/1</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * æšä¸¾ä¿¡æ¯ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œæ¯ä¸ªæšä¸¾ç±»éƒ½åº”è¯¥å®ç°è¿™ä¸ªæ¥å£</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> */</span></span>
<span class="line"><span style="color:#C678DD">public</span><span style="color:#C678DD"> interface</span><span style="color:#E5C07B"> EnumInfo</span><span style="color:#C678DD"> extends</span><span style="color:#E5C07B"> Serializable</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * è·å–æšä¸¾å€¼å¯¹åº”çš„ä»£ç </span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * </span><span style="color:#C678DD;font-style:italic">@return</span><span style="color:#7F848E;font-style:italic"> å¯¹åº”çš„ä»£ç </span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     */</span></span>
<span class="line"><span style="color:#E5C07B">    String</span><span style="color:#61AFEF"> code</span><span style="color:#ABB2BF">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * è·å–æšä¸¾å€¼å¯¹åº”çš„ä¿¡æ¯</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * </span><span style="color:#C678DD;font-style:italic">@return</span><span style="color:#7F848E;font-style:italic"> å¯¹åº”çš„ä¿¡æ¯</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     */</span></span>
<span class="line"><span style="color:#E5C07B">    String</span><span style="color:#61AFEF"> message</span><span style="color:#ABB2BF">();</span></span>
<span class="line"><span style="color:#ABB2BF">}</span></span></code></pre></td></tr></tbody></table>
      </figure>
<h2 id="1-6-å®ä½“åŸºç±»"><a class="header-anchor" href="#1-6-å®ä½“åŸºç±»"></a>1.6 å®ä½“åŸºç±»</h2>
<p>åç«¯ä¸­ä½¿ç”¨åˆ°çš„ <strong>æ‰€æœ‰</strong> å®ä½“éƒ½éœ€è¦ç»§æ‰¿å®ä½“åŸºç±»ã€‚</p>
<figure class="highlight java line-numbers" data-language="JAVA">
        <table style="background-color: #282c34"><tbody><tr><td class="gutter" style="background-color: #282c34"><pre style="background-color: #282c34"><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code" style="background-color: #282c34"><pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic">/**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * </span><span style="color:#C678DD;font-style:italic">@author</span><span style="color:#7F848E;font-style:italic"> mofan 2021/2/1</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * å®ä½“åŸºç±»ï¼Œæ¯ä¸ªå®ä½“éƒ½éœ€è¦ç»§æ‰¿è¯¥ç±»</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> */</span></span>
<span class="line"><span style="color:#C678DD">public</span><span style="color:#C678DD"> abstract</span><span style="color:#C678DD"> class</span><span style="color:#E5C07B"> BaseEntity</span><span style="color:#C678DD"> implements</span><span style="color:#E5C07B"> Serializable</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">    private</span><span style="color:#C678DD"> static</span><span style="color:#C678DD"> final</span><span style="color:#C678DD"> long</span><span style="color:#E06C75"> serialVersionUID </span><span style="color:#56B6C2">=</span><span style="color:#D19A66"> 6581451145034114785L</span><span style="color:#ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * ä¸»é”® é›ªèŠ±ç®—æ³•</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     */</span></span>
<span class="line"><span style="color:#ABB2BF">    @</span><span style="color:#E5C07B">TableId</span><span style="color:#E06C75">(</span><span style="color:#D19A66">type</span><span style="color:#56B6C2"> =</span><span style="color:#E5C07B"> IdType</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">ASSIGN_ID</span><span style="color:#E06C75">)</span></span>
<span class="line"><span style="color:#C678DD">    private</span><span style="color:#E5C07B"> Long</span><span style="color:#E06C75"> id</span><span style="color:#ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * åˆ›å»ºæ—¶é—´</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     */</span></span>
<span class="line"><span style="color:#ABB2BF">    @</span><span style="color:#E5C07B">TableField</span><span style="color:#E06C75">(</span><span style="color:#D19A66">fill</span><span style="color:#56B6C2"> =</span><span style="color:#E5C07B"> FieldFill</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">INSERT</span><span style="color:#E06C75">)</span></span>
<span class="line"><span style="color:#C678DD">    private</span><span style="color:#E5C07B"> Date</span><span style="color:#E06C75"> createTime</span><span style="color:#ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * æ›´æ–°æ—¶é—´</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     */</span></span>
<span class="line"><span style="color:#ABB2BF">    @</span><span style="color:#E5C07B">TableField</span><span style="color:#E06C75">(</span><span style="color:#D19A66">fill</span><span style="color:#56B6C2"> =</span><span style="color:#E5C07B"> FieldFill</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">INSERT_UPDATE</span><span style="color:#E06C75">)</span></span>
<span class="line"><span style="color:#C678DD">    private</span><span style="color:#E5C07B"> Date</span><span style="color:#E06C75"> updateTime</span><span style="color:#ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * æ˜¯å¦è¢«åˆ é™¤ ä½¿ç”¨é€»è¾‘åˆ é™¤</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     */</span></span>
<span class="line"><span style="color:#ABB2BF">    @</span><span style="color:#E5C07B">TableField</span><span style="color:#E06C75">(</span><span style="color:#D19A66">fill</span><span style="color:#56B6C2"> =</span><span style="color:#E5C07B"> FieldFill</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">INSERT</span><span style="color:#ABB2BF">,</span><span style="color:#D19A66"> value</span><span style="color:#56B6C2"> =</span><span style="color:#98C379"> "is_deleted"</span><span style="color:#E06C75">)</span></span>
<span class="line"><span style="color:#ABB2BF">    @</span><span style="color:#E5C07B">TableLogic</span></span>
<span class="line"><span style="color:#C678DD">    private</span><span style="color:#E5C07B"> Integer</span><span style="color:#E06C75"> deleted</span><span style="color:#ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#E5C07B"> Integer</span><span style="color:#61AFEF"> getDeleted</span><span style="color:#ABB2BF">()</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#C678DD">        return</span><span style="color:#ABB2BF"> deleted;</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#C678DD"> void</span><span style="color:#61AFEF"> setDeleted</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">Integer</span><span style="color:#E06C75;font-style:italic"> deleted</span><span style="color:#ABB2BF">)</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#E5C07B">        this</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">deleted</span><span style="color:#56B6C2"> =</span><span style="color:#ABB2BF"> deleted;</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#E5C07B"> Long</span><span style="color:#61AFEF"> getId</span><span style="color:#ABB2BF">()</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#C678DD">        return</span><span style="color:#ABB2BF"> id;</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#C678DD"> void</span><span style="color:#61AFEF"> setId</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">Long</span><span style="color:#E06C75;font-style:italic"> id</span><span style="color:#ABB2BF">)</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#E5C07B">        this</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">id</span><span style="color:#56B6C2"> =</span><span style="color:#ABB2BF"> id;</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#E5C07B"> Date</span><span style="color:#61AFEF"> getCreateTime</span><span style="color:#ABB2BF">()</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#C678DD">        return</span><span style="color:#ABB2BF"> createTime;</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF">    @</span><span style="color:#E5C07B">JsonFormat</span><span style="color:#E06C75">(</span><span style="color:#D19A66">pattern</span><span style="color:#56B6C2"> =</span><span style="color:#98C379"> "yyyy-MM-dd HH:mm:ss"</span><span style="color:#E06C75">)</span></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#C678DD"> void</span><span style="color:#61AFEF"> setCreateTime</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">Date</span><span style="color:#E06C75;font-style:italic"> createTime</span><span style="color:#ABB2BF">)</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#E5C07B">        this</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">createTime</span><span style="color:#56B6C2"> =</span><span style="color:#ABB2BF"> createTime;</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#E5C07B"> Date</span><span style="color:#61AFEF"> getUpdateTime</span><span style="color:#ABB2BF">()</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#C678DD">        return</span><span style="color:#ABB2BF"> updateTime;</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF">    @</span><span style="color:#E5C07B">JsonFormat</span><span style="color:#E06C75">(</span><span style="color:#D19A66">pattern</span><span style="color:#56B6C2"> =</span><span style="color:#98C379"> "yyyy-MM-dd HH:mm:ss"</span><span style="color:#E06C75">)</span></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#C678DD"> void</span><span style="color:#61AFEF"> setUpdateTime</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">Date</span><span style="color:#E06C75;font-style:italic"> updateTime</span><span style="color:#ABB2BF">)</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#E5C07B">        this</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">updateTime</span><span style="color:#56B6C2"> =</span><span style="color:#ABB2BF"> updateTime;</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF">}</span></span></code></pre></td></tr></tbody></table>
      </figure>
<h2 id="1-7-æ•°æ®ä¼ è¾“å¯¹è±¡åŸºç±»"><a class="header-anchor" href="#1-7-æ•°æ®ä¼ è¾“å¯¹è±¡åŸºç±»"></a>1.7 æ•°æ®ä¼ è¾“å¯¹è±¡åŸºç±»</h2>
<p>åç«¯ä½¿ç”¨åˆ°çš„æ‰€æœ‰ DTOï¼ˆæ•°æ®ä¼ è¾“å¯¹è±¡ï¼‰éƒ½éœ€è¦ç»§æ‰¿æ•°æ®ä¼ è¾“å¯¹è±¡åŸºç±»ã€‚</p>
<figure class="highlight java line-numbers" data-language="JAVA">
        <table style="background-color: #282c34"><tbody><tr><td class="gutter" style="background-color: #282c34"><pre style="background-color: #282c34"><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code" style="background-color: #282c34"><pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic">/**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * </span><span style="color:#C678DD;font-style:italic">@author</span><span style="color:#7F848E;font-style:italic"> mofan 2021/2/1</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> */</span></span>
<span class="line"><span style="color:#C678DD">public</span><span style="color:#C678DD"> abstract</span><span style="color:#C678DD"> class</span><span style="color:#E5C07B"> BaseDto</span><span style="color:#C678DD"> implements</span><span style="color:#E5C07B"> Serializable</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">    private</span><span style="color:#C678DD"> static</span><span style="color:#C678DD"> final</span><span style="color:#C678DD"> long</span><span style="color:#E06C75"> serialVersionUID </span><span style="color:#56B6C2">=</span><span style="color:#56B6C2"> -</span><span style="color:#D19A66">6349988895227283284L</span><span style="color:#ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * ä¸»é”®</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     */</span></span>
<span class="line"><span style="color:#ABB2BF">    @</span><span style="color:#E5C07B">JsonSerialize</span><span style="color:#E06C75">(</span><span style="color:#D19A66">using</span><span style="color:#56B6C2"> =</span><span style="color:#E5C07B"> ToStringSerializer</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">class</span><span style="color:#E06C75">)</span></span>
<span class="line"><span style="color:#C678DD">    private</span><span style="color:#E5C07B"> Long</span><span style="color:#E06C75"> id</span><span style="color:#ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#61AFEF"> BaseDto</span><span style="color:#ABB2BF">()</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#E5C07B"> Long</span><span style="color:#61AFEF"> getId</span><span style="color:#ABB2BF">()</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#C678DD">        return</span><span style="color:#ABB2BF"> id;</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#C678DD"> void</span><span style="color:#61AFEF"> setId</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">Long</span><span style="color:#E06C75;font-style:italic"> id</span><span style="color:#ABB2BF">)</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#E5C07B">        this</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">id</span><span style="color:#56B6C2"> =</span><span style="color:#ABB2BF"> id;</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF">}</span></span></code></pre></td></tr></tbody></table>
      </figure>
<h1 id="2-åç«¯-SpringBoot"><a class="header-anchor" href="#2-åç«¯-SpringBoot"></a>2. åç«¯ - SpringBoot</h1>
<h2 id="2-1-ç»Ÿä¸€å¼‚å¸¸æ‹¦æˆª"><a class="header-anchor" href="#2-1-ç»Ÿä¸€å¼‚å¸¸æ‹¦æˆª"></a>2.1 ç»Ÿä¸€å¼‚å¸¸æ‹¦æˆª</h2>
<p>ä¸ºäº†æ›´å¥½åœ°å¤„ç†åç«¯ä»£ç ä¸­çš„å¼‚å¸¸ä¿¡æ¯ï¼Œå¯ä»¥ä½¿ç”¨ SpringBoot æä¾›çš„ç»Ÿä¸€å¼‚å¸¸æ‹¦æˆªã€‚</p>
<p>æ­¥éª¤ä¹Ÿå¾ˆç®€å•ï¼š</p>
<p>1ã€åˆ›å»ºä¸€ä¸ªå…¨å±€å¼‚å¸¸æ‹¦æˆªå™¨ç±»ï¼Œå‡è®¾å«ï¼š<code>GlobalExceptionInterceptor</code>ï¼›</p>
<p>2ã€åœ¨è¿™ä¸ªç±»ä¸Šä½¿ç”¨æ³¨è§£ï¼š<code>@ControllerAdvice</code>ï¼›</p>
<p>3ã€åœ¨è¿™ä¸ªç±»ä¸­ç¼–å†™å¤„ç†å„ä¸ªå¼‚å¸¸çš„æ–¹æ³•ï¼ˆé€šå¸¸å¤„ç†ä¸€ä¸ªå¼‚å¸¸ç¼–å†™ä¸€ä¸ªæ–¹æ³•ï¼‰ï¼Œå¹¶åœ¨æ–¹æ³•ä¸Šä½¿ç”¨æ³¨è§£ï¼š <code>@ExceptionHandler</code>ï¼Œè¿™ä¸ªæ³¨è§£çš„ value å±æ€§å€¼ä¸ºè¢«å¤„ç†çš„å¼‚å¸¸ç±»ã€‚</p>
<p>æ¯”å¦‚æˆ‘æ‰€ä½¿ç”¨çš„å…¨å±€å¼‚å¸¸æ‹¦æˆªå™¨ç±»æ˜¯è¿™æ ·çš„ï¼š</p>
<figure class="highlight java line-numbers" data-language="JAVA">
        <table style="background-color: #282c34"><tbody><tr><td class="gutter" style="background-color: #282c34"><pre style="background-color: #282c34"><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code" style="background-color: #282c34"><pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF">@</span><span style="color:#E5C07B">Slf4j</span></span>
<span class="line"><span style="color:#ABB2BF">@</span><span style="color:#E5C07B">ControllerAdvice</span></span>
<span class="line"><span style="color:#ABB2BF">@</span><span style="color:#E5C07B">ResponseBody</span></span>
<span class="line"><span style="color:#C678DD">public</span><span style="color:#C678DD"> class</span><span style="color:#E5C07B"> GlobalExceptionInterceptor</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * ç”¨äº DTO çš„ JSR303 æ ¡éªŒè¿”å›</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * </span><span style="color:#C678DD;font-style:italic">@param</span><span style="color:#E06C75;font-style:italic"> e</span><span style="color:#7F848E;font-style:italic">       å¼‚å¸¸</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * </span><span style="color:#C678DD;font-style:italic">@return</span><span style="color:#7F848E;font-style:italic"> å¼‚å¸¸ä¿¡æ¯</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     */</span></span>
<span class="line"><span style="color:#ABB2BF">    @</span><span style="color:#E5C07B">ExceptionHandler</span><span style="color:#E06C75">(</span><span style="color:#D19A66">value</span><span style="color:#56B6C2"> =</span><span style="color:#E5C07B"> MethodArgumentNotValidException</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">class</span><span style="color:#E06C75">)</span></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#E5C07B"> Result</span><span style="color:#ABB2BF">&lt;</span><span style="color:#E5C07B">JSR303ExceptionMessage</span><span style="color:#ABB2BF">&gt;</span><span style="color:#61AFEF"> jsr303ExceptionHandler</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">MethodArgumentNotValidException</span><span style="color:#E06C75;font-style:italic"> e</span><span style="color:#ABB2BF">)</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#E5C07B">        JSR303ExceptionMessage</span><span style="color:#E06C75"> jsr303ExceptionMessage</span><span style="color:#56B6C2"> =</span><span style="color:#C678DD"> new</span><span style="color:#61AFEF"> JSR303ExceptionMessage</span><span style="color:#ABB2BF">();</span></span>
<span class="line"><span style="color:#E5C07B">        FieldError</span><span style="color:#E06C75"> fieldError</span><span style="color:#56B6C2"> =</span><span style="color:#E5C07B"> Objects</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">requireNonNull</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">e</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getBindingResult</span><span style="color:#ABB2BF">().</span><span style="color:#61AFEF">getFieldError</span><span style="color:#ABB2BF">());</span></span>
<span class="line"><span style="color:#E5C07B">        jsr303ExceptionMessage</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">setErrorMsg</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">fieldError</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getDefaultMessage</span><span style="color:#ABB2BF">());</span></span>
<span class="line"><span style="color:#E5C07B">        jsr303ExceptionMessage</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">setField</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">fieldError</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getField</span><span style="color:#ABB2BF">());</span></span>
<span class="line"><span style="color:#E5C07B">        jsr303ExceptionMessage</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">setObjectName</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">fieldError</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getObjectName</span><span style="color:#ABB2BF">());</span></span>
<span class="line"><span style="color:#E5C07B">        jsr303ExceptionMessage</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">setRejectedValue</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">fieldError</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getRejectedValue</span><span style="color:#ABB2BF">());</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B">        Result</span><span style="color:#ABB2BF">&lt;</span><span style="color:#E5C07B">JSR303ExceptionMessage</span><span style="color:#ABB2BF">&gt; </span><span style="color:#E06C75">result</span><span style="color:#56B6C2"> =</span><span style="color:#C678DD"> new</span><span style="color:#E5C07B"> Result</span><span style="color:#ABB2BF">&lt;&gt;();</span></span>
<span class="line"><span style="color:#E5C07B">        result</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">setCode</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">ErrorCode</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">JSR303_VERIFICATION_FAILED</span><span style="color:#ABB2BF">).</span><span style="color:#61AFEF">setMsg</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">"æäº¤çš„æ•°æ®é”™è¯¯"</span><span style="color:#ABB2BF">).</span><span style="color:#61AFEF">setData</span><span style="color:#ABB2BF">(jsr303ExceptionMessage);</span></span>
<span class="line"><span style="color:#C678DD">        return</span><span style="color:#ABB2BF"> result;</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * ä¸šåŠ¡å±‚æŠ›å‡ºçš„å¼‚å¸¸ BusinessException</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     *</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * </span><span style="color:#C678DD;font-style:italic">@param</span><span style="color:#E06C75;font-style:italic"> e</span><span style="color:#7F848E;font-style:italic"> å¼‚å¸¸ç±»å‹</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * </span><span style="color:#C678DD;font-style:italic">@return</span><span style="color:#7F848E;font-style:italic"> é”™è¯¯ä¿¡æ¯</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     */</span></span>
<span class="line"><span style="color:#ABB2BF">    @</span><span style="color:#E5C07B">ExceptionHandler</span><span style="color:#E06C75">(</span><span style="color:#D19A66">value</span><span style="color:#56B6C2"> =</span><span style="color:#E5C07B"> BusinessException</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">class</span><span style="color:#E06C75">)</span></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#E5C07B"> Result</span><span style="color:#ABB2BF">&lt;</span><span style="color:#E5C07B">BusinessException</span><span style="color:#ABB2BF">&gt;</span><span style="color:#61AFEF"> businessExceptionHandler</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">BusinessException</span><span style="color:#E06C75;font-style:italic"> e</span><span style="color:#ABB2BF">)</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#C678DD">        return</span><span style="color:#E5C07B"> Result</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">error</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">e</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">code</span><span style="color:#ABB2BF">(), </span><span style="color:#E5C07B">e</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">message</span><span style="color:#ABB2BF">());</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * Excel è§£æå¼‚å¸¸</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * </span><span style="color:#C678DD;font-style:italic">@param</span><span style="color:#E06C75;font-style:italic"> e</span><span style="color:#7F848E;font-style:italic"> å¼‚å¸¸ç±»å‹</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * </span><span style="color:#C678DD;font-style:italic">@return</span><span style="color:#7F848E;font-style:italic"> é”™è¯¯ä¿¡æ¯</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     */</span></span>
<span class="line"><span style="color:#ABB2BF">    @</span><span style="color:#E5C07B">ExceptionHandler</span><span style="color:#E06C75">(</span><span style="color:#D19A66">value</span><span style="color:#56B6C2"> =</span><span style="color:#E5C07B"> ExcelAnalysisException</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">class</span><span style="color:#E06C75">)</span></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#E5C07B"> Result</span><span style="color:#ABB2BF">&lt;</span><span style="color:#E5C07B">ExcelAnalysisException</span><span style="color:#ABB2BF">&gt;</span><span style="color:#61AFEF"> excelAnalysisExceptionHandler</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">ExcelAnalysisException</span><span style="color:#E06C75;font-style:italic"> e</span><span style="color:#ABB2BF">)</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#C678DD">        return</span><span style="color:#E5C07B"> Result</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">error</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">ErrorCode</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">EXCEL_ANALYSIS_ERROR</span><span style="color:#ABB2BF">, </span><span style="color:#E5C07B">e</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getMessage</span><span style="color:#ABB2BF">());</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * ç»Ÿä¸€å¼‚å¸¸æ‹¦æˆªå‘ä¸ŠæŠ›å‡º AccessDeniedException å¼‚å¸¸ï¼Œç”±è‡ªå®šä¹‰ AccessDeniedHandler è¿›è¡Œå¤„ç†</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * </span><span style="color:#C678DD;font-style:italic">@param</span><span style="color:#E06C75;font-style:italic"> e</span><span style="color:#7F848E;font-style:italic"> å¼‚å¸¸ç±»å‹</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * </span><span style="color:#C678DD;font-style:italic">@throws</span><span style="color:#E5C07B;font-style:italic"> AccessDeniedException</span><span style="color:#7F848E;font-style:italic"> è®¿é—®æ‹’ç»å¼‚å¸¸</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     */</span></span>
<span class="line"><span style="color:#ABB2BF">    @</span><span style="color:#E5C07B">ExceptionHandler</span><span style="color:#E06C75">(</span><span style="color:#D19A66">value</span><span style="color:#56B6C2"> =</span><span style="color:#E5C07B"> AccessDeniedException</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">class</span><span style="color:#E06C75">)</span></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#C678DD"> void</span><span style="color:#61AFEF"> accessDeniedExceptionHandler</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">AccessDeniedException</span><span style="color:#E06C75;font-style:italic"> e</span><span style="color:#ABB2BF">)</span><span style="color:#C678DD"> throws</span><span style="color:#E5C07B"> AccessDeniedException</span><span style="color:#ABB2BF">{</span></span>
<span class="line"><span style="color:#C678DD">        throw</span><span style="color:#C678DD"> new</span><span style="color:#61AFEF"> AccessDeniedException</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">"æ²¡æœ‰è®¿é—®æƒé™"</span><span style="color:#ABB2BF">);</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * ä¸Šä¼ æ–‡ä»¶å°ºå¯¸è¿‡å¤§ï¼Œè¶…è¿‡é»˜è®¤ 10MB æˆ–ç»è¿‡é…ç½®çš„å¤§å°</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * </span><span style="color:#C678DD;font-style:italic">@param</span><span style="color:#E06C75;font-style:italic"> e</span><span style="color:#7F848E;font-style:italic"> å¼‚å¸¸ç±»å‹</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * </span><span style="color:#C678DD;font-style:italic">@return</span><span style="color:#7F848E;font-style:italic"> é”™è¯¯ä¿¡æ¯</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     */</span></span>
<span class="line"><span style="color:#ABB2BF">    @</span><span style="color:#E5C07B">ExceptionHandler</span><span style="color:#E06C75">(</span><span style="color:#D19A66">value</span><span style="color:#56B6C2"> =</span><span style="color:#E5C07B"> MaxUploadSizeExceededException</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">class</span><span style="color:#E06C75">)</span></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#E5C07B"> Result</span><span style="color:#ABB2BF">&lt;</span><span style="color:#E5C07B">MaxUploadSizeExceededException</span><span style="color:#ABB2BF">&gt;</span><span style="color:#61AFEF"> maxUploadSizeExceededException</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">MaxUploadSizeExceededException</span><span style="color:#E06C75;font-style:italic"> e</span><span style="color:#ABB2BF">)</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#C678DD">        return</span><span style="color:#E5C07B"> Result</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">error</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">ErrorCode</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">MAX_UPLOAD_SIZE_EXCEEDED</span><span style="color:#ABB2BF">, </span><span style="color:#98C379">"ä¸Šä¼ æ–‡ä»¶å°ºå¯¸è¿‡å¤§"</span><span style="color:#ABB2BF">);</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF">    @</span><span style="color:#E5C07B">ExceptionHandler</span><span style="color:#E06C75">(</span><span style="color:#D19A66">value</span><span style="color:#56B6C2"> =</span><span style="color:#E5C07B"> OSSException</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">class</span><span style="color:#E06C75">)</span></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#E5C07B"> Result</span><span style="color:#ABB2BF">&lt;</span><span style="color:#E5C07B">OSSException</span><span style="color:#ABB2BF">&gt;</span><span style="color:#61AFEF"> ossException</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">OSSException</span><span style="color:#E06C75;font-style:italic"> e</span><span style="color:#ABB2BF">)</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#C678DD">        return</span><span style="color:#E5C07B"> Result</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">error</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">ErrorCode</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">UPLOAD_FILE_TO_OSS_ERROR</span><span style="color:#ABB2BF">, </span><span style="color:#98C379">"ä¸Šä¼ è‡³å®¢æˆ·ç«¯å¤±è´¥"</span><span style="color:#ABB2BF">);</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF">    @</span><span style="color:#E5C07B">ExceptionHandler</span><span style="color:#E06C75">(</span><span style="color:#D19A66">value</span><span style="color:#56B6C2"> =</span><span style="color:#E5C07B"> ClientException</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">class</span><span style="color:#E06C75">)</span></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#E5C07B"> Result</span><span style="color:#ABB2BF">&lt;</span><span style="color:#E5C07B">ClientException</span><span style="color:#ABB2BF">&gt;</span><span style="color:#61AFEF"> clientException</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">ClientException</span><span style="color:#E06C75;font-style:italic"> e</span><span style="color:#ABB2BF">)</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#C678DD">        return</span><span style="color:#E5C07B"> Result</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">error</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">ErrorCode</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">ALI_OSS_CLIENT_ERROR</span><span style="color:#ABB2BF">, </span><span style="color:#98C379">"æ–‡ä»¶å®¢æˆ·ç«¯å¼‚å¸¸ï¼Œè¯·è”ç³»ç³»ç»Ÿç®¡ç†å‘˜å¤„ç†ï¼"</span><span style="color:#ABB2BF">);</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * å„ç§éå…·ä½“æŒ‡å®šå¼‚å¸¸çš„ç»Ÿä¸€å¤„ç†</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     *</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * </span><span style="color:#C678DD;font-style:italic">@param</span><span style="color:#E06C75;font-style:italic"> e</span><span style="color:#7F848E;font-style:italic"> å¼‚å¸¸ç±»å‹</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * </span><span style="color:#C678DD;font-style:italic">@return</span><span style="color:#7F848E;font-style:italic"> é”™è¯¯ä¿¡æ¯</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     */</span></span>
<span class="line"><span style="color:#ABB2BF">    @</span><span style="color:#E5C07B">ExceptionHandler</span><span style="color:#E06C75">(</span><span style="color:#D19A66">value</span><span style="color:#56B6C2"> =</span><span style="color:#E5C07B"> Exception</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">class</span><span style="color:#E06C75">)</span></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#E5C07B"> Result</span><span style="color:#ABB2BF">&lt;</span><span style="color:#E5C07B">Exception</span><span style="color:#ABB2BF">&gt;</span><span style="color:#61AFEF"> exceptionHandler</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">Exception</span><span style="color:#E06C75;font-style:italic"> e</span><span style="color:#ABB2BF">)</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#E5C07B">        log</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">error</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">e</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getMessage</span><span style="color:#ABB2BF">());</span></span>
<span class="line"><span style="color:#C678DD">        return</span><span style="color:#E5C07B"> Result</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">error</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">ErrorCode</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">UNKNOWN_ERROR</span><span style="color:#ABB2BF">, </span><span style="color:#98C379">"æœªçŸ¥çš„é”™è¯¯ï¼Œè¯·è”ç³»ç³»ç»Ÿç®¡ç†å‘˜å¤„ç†ï¼"</span><span style="color:#ABB2BF">);</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF">}</span></span></code></pre></td></tr></tbody></table>
      </figure>
<h2 id="2-2-JSR-303-æ ¡éªŒ"><a class="header-anchor" href="#2-2-JSR-303-æ ¡éªŒ"></a>2.2 JSR-303 æ ¡éªŒ</h2>
<p>å‰ç«¯ä¼ é€’æ•°æ®ä½œä¸ºåç«¯æ–¹æ³•çš„å…¥å‚æ—¶ï¼Œæˆ‘ä»¬éœ€è¦å¯¹è¿™äº›å‚æ•°è¿›è¡Œæ ¡éªŒï¼Œæ¯”æ–¹è¯´æ£€éªŒæ˜¯å¦éç©ºã€‚ä¸ºäº†ä½¿ä»£ç ç®€æ´è€Œä¸é‡‡å– <code>if - else</code> çš„æ–¹å¼è¿›è¡Œåˆ¤æ–­ï¼Œè€Œæ˜¯é‡‡ç”¨ JSR-303 æ£€éªŒã€‚</p>
<p>æ­¥éª¤ä¹Ÿå¾ˆç®€å•ï¼š</p>
<p>1ã€ä¸º Controller é‡Œæ–¹æ³•çš„å‚æ•°ä½¿ç”¨ <code>@Valid</code> æ³¨è§£ï¼›</p>
<p>2ã€åœ¨å‚æ•°å¯¹åº”çš„ç±»çš„å±æ€§ä¸Šä½¿ç”¨ JSR-303 æ³¨è§£ã€‚</p>
<p>æ¯”å¦‚ï¼š</p>
<figure class="highlight java line-numbers" data-language="JAVA">
        <table style="background-color: #282c34"><tbody><tr><td class="gutter" style="background-color: #282c34"><pre style="background-color: #282c34"><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code" style="background-color: #282c34"><pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF">@</span><span style="color:#E5C07B">PostMapping</span><span style="color:#E06C75">(</span><span style="color:#98C379">"submit"</span><span style="color:#E06C75">)</span></span>
<span class="line"><span style="color:#C678DD">public</span><span style="color:#E5C07B"> Result</span><span style="color:#56B6C2">&lt;</span><span style="color:#E06C75">Long</span><span style="color:#56B6C2">&gt;</span><span style="color:#61AFEF"> saveOrUpdate</span><span style="color:#E06C75">(</span><span style="color:#ABB2BF">@</span><span style="color:#E5C07B">Valid</span><span style="color:#ABB2BF"> @</span><span style="color:#E5C07B">RequestBody</span><span style="color:#E5C07B"> DeptDefinitionDto</span><span style="color:#E06C75"> dto) {</span></span>
<span class="line"><span style="color:#C678DD">    if</span><span style="color:#E06C75"> (</span><span style="color:#E5C07B">dto</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getId</span><span style="color:#ABB2BF">()</span><span style="color:#56B6C2"> ==</span><span style="color:#D19A66"> null</span><span style="color:#E06C75">) {</span></span>
<span class="line"><span style="color:#C678DD">        return</span><span style="color:#E5C07B"> deptService</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">createDept</span><span style="color:#ABB2BF">(dto);</span></span>
<span class="line"><span style="color:#E06C75">    } </span><span style="color:#C678DD">else</span><span style="color:#E06C75"> {</span></span>
<span class="line"><span style="color:#C678DD">        return</span><span style="color:#E5C07B"> deptService</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">updateDeptInfo</span><span style="color:#ABB2BF">(dto);</span></span>
<span class="line"><span style="color:#E06C75">    }</span></span>
<span class="line"><span style="color:#E06C75">}</span></span></code></pre></td></tr></tbody></table>
      </figure>
<p><code>DeptDefinitionDto</code> å¯¹åº”çš„éƒ¨åˆ†ä»£ç ï¼š</p>
<figure class="highlight java line-numbers" data-language="JAVA">
        <table style="background-color: #282c34"><tbody><tr><td class="gutter" style="background-color: #282c34"><pre style="background-color: #282c34"><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code" style="background-color: #282c34"><pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF">@</span><span style="color:#E5C07B">Getter</span></span>
<span class="line"><span style="color:#ABB2BF">@</span><span style="color:#E5C07B">Setter</span></span>
<span class="line"><span style="color:#C678DD">public</span><span style="color:#C678DD"> class</span><span style="color:#E5C07B"> DeptDefinitionDto</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#E06C75">    </span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * éƒ¨é—¨åç§°</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     */</span></span>
<span class="line"><span style="color:#ABB2BF">    @</span><span style="color:#E5C07B">NotNull</span><span style="color:#E06C75">(</span><span style="color:#D19A66">message</span><span style="color:#56B6C2"> =</span><span style="color:#98C379"> "éƒ¨é—¨åç§°ä¸èƒ½ä¸ºç©º"</span><span style="color:#E06C75">)</span></span>
<span class="line"><span style="color:#C678DD">    private</span><span style="color:#E5C07B"> String</span><span style="color:#E06C75"> deptName</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#E06C75">    </span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     // ...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * ä¼ çœŸç”µè¯</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     */</span></span>
<span class="line"><span style="color:#ABB2BF">    @</span><span style="color:#E5C07B">FaxNum</span><span style="color:#E06C75">(</span><span style="color:#D19A66">notNull</span><span style="color:#56B6C2"> =</span><span style="color:#D19A66"> false</span><span style="color:#E06C75">)</span></span>
<span class="line"><span style="color:#C678DD">    private</span><span style="color:#E5C07B"> String</span><span style="color:#E06C75"> fax</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#ABB2BF">}</span></span></code></pre></td></tr></tbody></table>
      </figure>
<h2 id="2-3-è‡ªå®šä¹‰æ ¡éªŒæ³¨è§£"><a class="header-anchor" href="#2-3-è‡ªå®šä¹‰æ ¡éªŒæ³¨è§£"></a>2.3 è‡ªå®šä¹‰æ ¡éªŒæ³¨è§£</h2>
<p>åœ¨ç‰¹å®šçš„åœºæ™¯ä¸‹ï¼Œä½¿ç”¨ JSR-303 æä¾›çš„æ³¨è§£æ— æ³•å®Œæˆæˆ‘ä»¬çš„æ ¡éªŒéœ€æ±‚ï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦è‡ªå®šä¹‰æ³¨è§£ï¼Œæ¯”æ–¹è¯´å‰æ–‡ä¸­ <code>DeptDefinitionDto</code> ç±»ä¸­çš„ <code>@FaxNum</code> æ³¨è§£ã€‚</p>
<p>è‡ªå®šä¹‰æ³¨è§£çš„æ­¥éª¤ä¹Ÿå¾ˆç®€å•ï¼š</p>
<p>1ã€åˆ›å»ºè‡ªå®šä¹‰æ³¨è§£ï¼Œæ³¨è§£ä¸­è¦æœ‰å±æ€§ <code>message</code>ã€<code>groups</code> å’Œ <code>payload</code>ï¼Œè¿˜è¦åœ¨è‡ªå®šä¹‰çš„æ³¨è§£ä¸Šä½¿ç”¨æ³¨è§£ <code>@Constraint</code>ï¼Œå¹¶æŒ‡å®šå…¶ <code>validatedBy</code> å±æ€§å€¼ä¸ºè‡ªå®šä¹‰çš„çº¦æŸéªŒè¯å™¨ï¼ˆç¬¬äºŒæ­¥åˆ›å»ºï¼‰ã€‚</p>
<p>2ã€åˆ›å»ºè‡ªå®šä¹‰çš„çº¦æŸéªŒè¯å™¨ï¼Œè¿™ä¸ªç±»å®ç° <code>ConstraintValidator</code> æ¥å£ï¼Œè¿™ä¸ªæ¥å£çš„æ³›å‹ä¸ºï¼šè‡ªå®šä¹‰çš„æ³¨è§£å’Œéœ€è¦è¢«æ ¡éªŒçš„å‚æ•°ç±»å‹ã€‚</p>
<p>æ¯”å¦‚ï¼š</p>
<figure class="highlight java line-numbers" data-language="JAVA">
        <table style="background-color: #282c34"><tbody><tr><td class="gutter" style="background-color: #282c34"><pre style="background-color: #282c34"><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code" style="background-color: #282c34"><pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF">@</span><span style="color:#E5C07B">Documented</span></span>
<span class="line"><span style="color:#ABB2BF">@</span><span style="color:#E5C07B">Constraint</span><span style="color:#E06C75">(</span><span style="color:#D19A66">validatedBy</span><span style="color:#56B6C2"> =</span><span style="color:#E5C07B"> FaxNumValidator</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">class</span><span style="color:#E06C75">)</span></span>
<span class="line"><span style="color:#ABB2BF">@</span><span style="color:#E5C07B">Target</span><span style="color:#E06C75">({</span><span style="color:#E5C07B">ElementType</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">PARAMETER</span><span style="color:#ABB2BF">,</span><span style="color:#E5C07B"> ElementType</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">FIELD</span><span style="color:#E06C75">})</span></span>
<span class="line"><span style="color:#ABB2BF">@</span><span style="color:#E5C07B">Retention</span><span style="color:#E06C75">(</span><span style="color:#E5C07B">RetentionPolicy</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">RUNTIME</span><span style="color:#E06C75">)</span></span>
<span class="line"><span style="color:#C678DD">public</span><span style="color:#ABB2BF"> @</span><span style="color:#C678DD">interface</span><span style="color:#E5C07B"> FaxNum</span><span style="color:#E06C75"> {</span></span>
<span class="line"><span style="color:#E5C07B">    String</span><span style="color:#61AFEF"> message</span><span style="color:#E06C75">() </span><span style="color:#C678DD">default</span><span style="color:#98C379"> "ä¼ çœŸç”µè¯å·ç æ ¼å¼é”™è¯¯"</span><span style="color:#ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B">    Class</span><span style="color:#E06C75">[] </span><span style="color:#61AFEF">groups</span><span style="color:#E06C75">() </span><span style="color:#C678DD">default</span><span style="color:#E06C75"> {}</span><span style="color:#ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B">    Class</span><span style="color:#E06C75">[] </span><span style="color:#61AFEF">payload</span><span style="color:#E06C75">() </span><span style="color:#C678DD">default</span><span style="color:#E06C75"> {}</span><span style="color:#ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * æ˜¯å¦è¿›è¡Œéç©ºéªŒè¯</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     */</span></span>
<span class="line"><span style="color:#C678DD">    boolean</span><span style="color:#61AFEF"> notNull</span><span style="color:#E06C75">() </span><span style="color:#C678DD">default</span><span style="color:#D19A66"> true</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#E06C75">}</span></span></code></pre></td></tr></tbody></table>
      </figure>
<p>è‡ªå®šä¹‰çº¦æŸéªŒè¯å™¨ <code>FaxNumValidator</code>ï¼š</p>
<figure class="highlight java line-numbers" data-language="JAVA">
        <table style="background-color: #282c34"><tbody><tr><td class="gutter" style="background-color: #282c34"><pre style="background-color: #282c34"><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code" style="background-color: #282c34"><pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD">public</span><span style="color:#C678DD"> class</span><span style="color:#E5C07B"> FaxNumValidator</span><span style="color:#C678DD"> implements</span><span style="color:#E5C07B"> ConstraintValidator</span><span style="color:#ABB2BF">&lt;</span><span style="color:#E5C07B">FaxNum</span><span style="color:#ABB2BF">,</span><span style="color:#E5C07B"> String</span><span style="color:#ABB2BF">&gt;</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">    private</span><span style="color:#C678DD"> static</span><span style="color:#C678DD"> final</span><span style="color:#E5C07B"> String</span><span style="color:#E06C75"> FAX_NUM_REG_EXP </span><span style="color:#56B6C2">=</span><span style="color:#98C379"> "</span><span style="color:#56B6C2">\\</span><span style="color:#98C379">d{3}-</span><span style="color:#56B6C2">\\</span><span style="color:#98C379">d{8}|</span><span style="color:#56B6C2">\\</span><span style="color:#98C379">d{4}-</span><span style="color:#56B6C2">\\</span><span style="color:#98C379">d{7}"</span><span style="color:#ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">    private</span><span style="color:#C678DD"> static</span><span style="color:#C678DD"> boolean</span><span style="color:#E06C75"> notNull </span><span style="color:#56B6C2">=</span><span style="color:#D19A66"> true</span><span style="color:#ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * æˆå‘˜å˜é‡åˆå§‹åŒ–</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     */</span></span>
<span class="line"><span style="color:#ABB2BF">    @</span><span style="color:#E5C07B">Override</span></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#C678DD"> void</span><span style="color:#61AFEF"> initialize</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">FaxNum</span><span style="color:#E06C75;font-style:italic"> constraintAnnotation</span><span style="color:#ABB2BF">)</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#ABB2BF">        notNull </span><span style="color:#56B6C2">=</span><span style="color:#E5C07B"> constraintAnnotation</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">notNull</span><span style="color:#ABB2BF">();</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * æ£€éªŒè§„åˆ™</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     */</span></span>
<span class="line"><span style="color:#ABB2BF">    @</span><span style="color:#E5C07B">Override</span></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#C678DD"> boolean</span><span style="color:#61AFEF"> isValid</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">String</span><span style="color:#E06C75;font-style:italic"> s</span><span style="color:#ABB2BF">, </span><span style="color:#E5C07B">ConstraintValidatorContext</span><span style="color:#E06C75;font-style:italic"> constraintValidatorContext</span><span style="color:#ABB2BF">)</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#C678DD">        if</span><span style="color:#ABB2BF"> (s </span><span style="color:#56B6C2">==</span><span style="color:#D19A66"> null</span><span style="color:#56B6C2"> ||</span><span style="color:#98C379"> ""</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">equals</span><span style="color:#ABB2BF">(s)) {</span></span>
<span class="line"><span style="color:#C678DD">            return</span><span style="color:#56B6C2"> !</span><span style="color:#ABB2BF">notNull;</span></span>
<span class="line"><span style="color:#ABB2BF">        }</span></span>
<span class="line"><span style="color:#C678DD">        return</span><span style="color:#E5C07B"> s</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">matches</span><span style="color:#ABB2BF">(FAX_NUM_REG_EXP);</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF">}</span></span></code></pre></td></tr></tbody></table>
      </figure>
<p>åœ¨ä¸Šè¿°ä»£ç ä¸­ä½¿ç”¨äº†æ­£åˆ™è¡¨è¾¾å¼è¿›è¡Œå†…å®¹éªŒè¯ï¼Œå¸¸ç”¨çš„æ­£åˆ™è¡¨è¾¾å¼å‚è€ƒï¼š<strong>æ­£åˆ™è¡¨è¾¾å¼åœ¨çº¿æµ‹è¯•</strong> <sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup></p>
<h2 id="2-4-æ–‡ä»¶ä¸Šä¼ é™åˆ¶"><a class="header-anchor" href="#2-4-æ–‡ä»¶ä¸Šä¼ é™åˆ¶"></a>2.4 æ–‡ä»¶ä¸Šä¼ é™åˆ¶</h2>
<p>åœ¨ä¸Šä¼ æ–‡ä»¶æ—¶ï¼ŒSpring é»˜è®¤å•ä¸ªæ–‡ä»¶æœ€å¤§ä¸º 1Mï¼Œå•æ¬¡è¯·æ±‚ä¸­æ–‡ä»¶å¤§å°åˆè®¡æœ€å¤§ä¸º 10Mï¼Œå¦‚æœæŸ¥è¿‡è¿™ä¸ªæ•°å€¼å°±ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚</p>
<p>å½“ç„¶è¿™äº›æ•°å€¼ä¹Ÿæ˜¯å¯ä»¥ä¿®æ”¹çš„ï¼Œåªéœ€è¦åœ¨é…ç½®æ–‡ä»¶è¿½åŠ ï¼š</p>
<figure class="highlight yaml line-numbers" data-language="YAML">
        <table style="background-color: #282c34"><tbody><tr><td class="gutter" style="background-color: #282c34"><pre style="background-color: #282c34"><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code" style="background-color: #282c34"><pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#E06C75">spring</span><span style="color:#ABB2BF">:</span></span>
<span class="line"><span style="color:#E06C75">  servlet</span><span style="color:#ABB2BF">:</span></span>
<span class="line"><span style="color:#E06C75">    multipart</span><span style="color:#ABB2BF">:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">      # å•ä¸ªæ–‡ä»¶æœ€å¤§å¤§å°</span></span>
<span class="line"><span style="color:#E06C75">      max-file-size</span><span style="color:#ABB2BF">: </span><span style="color:#98C379">20MB</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">      # è¯·æ±‚ä¸­æ–‡ä»¶å¤§å°åˆè®¡æœ€å¤§</span></span>
<span class="line"><span style="color:#E06C75">      max-request-size</span><span style="color:#ABB2BF">: </span><span style="color:#98C379">200MB</span></span>
<span class="line"><span style="color:#E06C75">server</span><span style="color:#ABB2BF">:</span></span>
<span class="line"><span style="color:#E06C75">  tomcat</span><span style="color:#ABB2BF">:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    # ä¸é™åˆ¶å†…åµŒ Tomcat æœ€å¤§ååé‡ï¼Œç”¨äºå…¨å±€å¼‚å¸¸å¤„ç†è¿›è¡Œæ•è·</span></span>
<span class="line"><span style="color:#E06C75">    max-swallow-size</span><span style="color:#ABB2BF">: </span><span style="color:#D19A66">-1</span></span></code></pre></td></tr></tbody></table>
      </figure>
<p>å¹¶åœ¨å…¨å±€å¼‚å¸¸æ‹¦æˆªä¸­è¿½åŠ ï¼š</p>
<figure class="highlight java line-numbers" data-language="JAVA">
        <table style="background-color: #282c34"><tbody><tr><td class="gutter" style="background-color: #282c34"><pre style="background-color: #282c34"><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code" style="background-color: #282c34"><pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic">/**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">* ä¸Šä¼ æ–‡ä»¶å°ºå¯¸è¿‡å¤§ï¼Œè¶…è¿‡é»˜è®¤ 10MB æˆ–ç»è¿‡é…ç½®çš„å¤§å°</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">*</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">* </span><span style="color:#C678DD;font-style:italic">@param</span><span style="color:#E06C75;font-style:italic"> e</span><span style="color:#7F848E;font-style:italic"> å¼‚å¸¸ç±»å‹</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">* </span><span style="color:#C678DD;font-style:italic">@return</span><span style="color:#7F848E;font-style:italic"> é”™è¯¯ä¿¡æ¯</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">*/</span></span>
<span class="line"><span style="color:#ABB2BF">@</span><span style="color:#E5C07B">ExceptionHandler</span><span style="color:#E06C75">(</span><span style="color:#D19A66">value</span><span style="color:#56B6C2"> =</span><span style="color:#E5C07B"> MaxUploadSizeExceededException</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">class</span><span style="color:#E06C75">)</span></span>
<span class="line"><span style="color:#C678DD">public</span><span style="color:#E5C07B"> Result</span><span style="color:#56B6C2">&lt;</span><span style="color:#E06C75">MaxUploadSizeExceededException</span><span style="color:#56B6C2">&gt;</span><span style="color:#61AFEF"> maxUploadSizeExceededException</span><span style="color:#E06C75">(</span><span style="color:#E5C07B">MaxUploadSizeExceededException</span><span style="color:#E06C75"> e) {</span></span>
<span class="line"><span style="color:#C678DD">    return</span><span style="color:#E5C07B"> Result</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">error</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">ErrorCode</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">MAX_UPLOAD_SIZE_EXCEEDED</span><span style="color:#ABB2BF">, </span><span style="color:#98C379">"ä¸Šä¼ æ–‡ä»¶å°ºå¯¸è¿‡å¤§"</span><span style="color:#ABB2BF">);</span></span>
<span class="line"><span style="color:#E06C75">}</span></span></code></pre></td></tr></tbody></table>
      </figure>
<h1 id="3-åç«¯-é˜¿é‡Œäº‘-OSS"><a class="header-anchor" href="#3-åç«¯-é˜¿é‡Œäº‘-OSS"></a>3. åç«¯ - é˜¿é‡Œäº‘ OSS</h1>
<p>åœ¨æœ¬æ¬¡çš„é¡¹ç›®ä¸­ä½¿ç”¨åˆ°äº†é˜¿é‡Œäº‘ OSSï¼Œç”¨äºå­˜å‚¨éœ€è¦ä¸Šä¼ çš„æ–‡ä»¶ã€‚åœ¨æ­¤ä»‹ç»ä¸€ä¸‹åç«¯æ•´åˆé˜¿é‡Œäº‘ OSS çš„æ–¹æ³•ï¼Œé»˜è®¤å·²æ³¨å†Œé˜¿é‡Œäº‘ï¼Œå¹¶æˆåŠŸé…ç½® OSSï¼ˆè·å–åˆ°å…¬é’¥å’Œç§é’¥ï¼‰ã€‚</p>
<p>é¦–å…ˆéœ€è¦å¯¼å…¥ä¾èµ–ï¼š</p>
<figure class="highlight xml line-numbers" data-language="XML">
        <table style="background-color: #282c34"><tbody><tr><td class="gutter" style="background-color: #282c34"><pre style="background-color: #282c34"><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code" style="background-color: #282c34"><pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF">&lt;</span><span style="color:#E06C75">dependency</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">    &lt;</span><span style="color:#E06C75">groupId</span><span style="color:#ABB2BF">&gt;com.aliyun.oss&lt;/</span><span style="color:#E06C75">groupId</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">    &lt;</span><span style="color:#E06C75">artifactId</span><span style="color:#ABB2BF">&gt;aliyun-sdk-oss&lt;/</span><span style="color:#E06C75">artifactId</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">    &lt;</span><span style="color:#E06C75">version</span><span style="color:#ABB2BF">&gt;3.10.2&lt;/</span><span style="color:#E06C75">version</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">&lt;/</span><span style="color:#E06C75">dependency</span><span style="color:#ABB2BF">&gt;</span></span></code></pre></td></tr></tbody></table>
      </figure>
<p>ç„¶ååœ¨é…ç½®æ–‡ä»¶ä¸­è¿½åŠ ä»¥ä¸‹é…ç½®ï¼š</p>
<figure class="highlight yaml line-numbers" data-language="YAML">
        <table style="background-color: #282c34"><tbody><tr><td class="gutter" style="background-color: #282c34"><pre style="background-color: #282c34"><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code" style="background-color: #282c34"><pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic"># é˜¿é‡Œossé…ç½®</span></span>
<span class="line"><span style="color:#E06C75">oss</span><span style="color:#ABB2BF">:</span></span>
<span class="line"><span style="color:#E06C75">  endpoint</span><span style="color:#ABB2BF">: </span><span style="color:#98C379">oss-cn-chengdu.aliyuncs.com</span><span style="color:#7F848E;font-style:italic">   # ossåœ°åŸŸå</span></span>
<span class="line"><span style="color:#E06C75">  accessKeyId</span><span style="color:#ABB2BF">: </span><span style="color:#98C379">xxxx</span><span style="color:#7F848E;font-style:italic">  # å…¬é’¥</span></span>
<span class="line"><span style="color:#E06C75">  accessKeySecret</span><span style="color:#ABB2BF">: </span><span style="color:#98C379">xxxx</span><span style="color:#7F848E;font-style:italic"> # ç§é’¥</span></span>
<span class="line"><span style="color:#E06C75">  bucketName</span><span style="color:#ABB2BF">: </span><span style="color:#98C379">gsams-files</span><span style="color:#7F848E;font-style:italic">  # bucketåç§°</span></span>
<span class="line"><span style="color:#E06C75">  dirName</span><span style="color:#ABB2BF">: </span><span style="color:#98C379">exam-outline/</span><span style="color:#7F848E;font-style:italic">  # æ–‡ä»¶ç›®å½•</span></span></code></pre></td></tr></tbody></table>
      </figure>
<p><mark>æ³¨æ„ï¼š</mark> å¯¼å…¥çš„ä¾èµ–å¹¶ä¸æ˜¯ SpringBoot çš„ starterï¼Œä»…ä»…æ˜¯ OSS çš„ SDKï¼Œè¿™é‡Œç¼–å†™çš„é…ç½®æ–‡ä»¶ä»…ä»…æ˜¯ä¸ºäº†æ–¹ä¾¿ç®¡ç†ï¼Œå¦‚æœä¸å†™åœ¨é…ç½®æ–‡ä»¶ä¸­ï¼Œä¹Ÿå¯ä»¥ç¡¬ç¼–ç åœ¨ Java ä»£ç ä¸­ã€‚</p>
<p>è¯»å–è¿½åŠ çš„ OSS é…ç½®ä¿¡æ¯ï¼š</p>
<figure class="highlight java line-numbers" data-language="JAVA">
        <table style="background-color: #282c34"><tbody><tr><td class="gutter" style="background-color: #282c34"><pre style="background-color: #282c34"><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code" style="background-color: #282c34"><pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic">/**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * </span><span style="color:#C678DD;font-style:italic">@author</span><span style="color:#7F848E;font-style:italic"> mofan</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * @date 2021/6/2 13:43</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> */</span></span>
<span class="line"><span style="color:#ABB2BF">@</span><span style="color:#E5C07B">Getter</span></span>
<span class="line"><span style="color:#ABB2BF">@</span><span style="color:#E5C07B">Setter</span></span>
<span class="line"><span style="color:#ABB2BF">@</span><span style="color:#E5C07B">Configuration</span></span>
<span class="line"><span style="color:#C678DD">public</span><span style="color:#C678DD"> class</span><span style="color:#E5C07B"> OssConstant</span><span style="color:#C678DD"> implements</span><span style="color:#E5C07B"> InitializingBean</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * æ–‡ä»¶æœ€å¤§ä¸Šä¼ å¤§å°</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     */</span></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#C678DD"> static</span><span style="color:#C678DD"> long</span><span style="color:#E06C75"> FILE_MAX_SIZE </span><span style="color:#56B6C2">=</span><span style="color:#D19A66"> 1024</span><span style="color:#56B6C2"> *</span><span style="color:#D19A66"> 1024</span><span style="color:#56B6C2"> *</span><span style="color:#D19A66"> 10L</span><span style="color:#ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * å›¾ç‰‡è¿‡æœŸæ—¶é—´ 100å¹´</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     */</span></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#C678DD"> static</span><span style="color:#C678DD"> long</span><span style="color:#E06C75"> FILE_EXPIRATION_TIME </span><span style="color:#56B6C2">=</span><span style="color:#D19A66"> 1000L</span><span style="color:#56B6C2"> *</span><span style="color:#D19A66"> 3600L</span><span style="color:#56B6C2"> *</span><span style="color:#D19A66"> 24L</span><span style="color:#56B6C2"> *</span><span style="color:#D19A66"> 365L</span><span style="color:#56B6C2"> *</span><span style="color:#D19A66"> 100L</span><span style="color:#ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#C678DD"> static</span><span style="color:#E5C07B"> String</span><span style="color:#E06C75"> END_POINT</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#C678DD"> static</span><span style="color:#E5C07B"> String</span><span style="color:#E06C75"> ACCESS_KEY_ID</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#C678DD"> static</span><span style="color:#E5C07B"> String</span><span style="color:#E06C75"> ACCESS_KEY_SECRET</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#C678DD"> static</span><span style="color:#E5C07B"> String</span><span style="color:#E06C75"> BUCKET_NAME</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#C678DD"> static</span><span style="color:#E5C07B"> String</span><span style="color:#E06C75"> DIR_NAME</span><span style="color:#ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * é˜¿é‡Œäº‘ oss ç«™ç‚¹</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     */</span></span>
<span class="line"><span style="color:#ABB2BF">    @</span><span style="color:#E5C07B">Value</span><span style="color:#E06C75">(</span><span style="color:#98C379">"${oss.endpoint}"</span><span style="color:#E06C75">)</span></span>
<span class="line"><span style="color:#C678DD">    private</span><span style="color:#E5C07B"> String</span><span style="color:#E06C75"> endpoint</span><span style="color:#ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * é˜¿é‡Œäº‘ oss å…¬é’¥</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     */</span></span>
<span class="line"><span style="color:#ABB2BF">    @</span><span style="color:#E5C07B">Value</span><span style="color:#E06C75">(</span><span style="color:#98C379">"${oss.accessKeyId}"</span><span style="color:#E06C75">)</span></span>
<span class="line"><span style="color:#C678DD">    private</span><span style="color:#E5C07B"> String</span><span style="color:#E06C75"> accessKeyId</span><span style="color:#ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * é˜¿é‡Œäº‘ oss ç§é’¥</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     */</span></span>
<span class="line"><span style="color:#ABB2BF">    @</span><span style="color:#E5C07B">Value</span><span style="color:#E06C75">(</span><span style="color:#98C379">"${oss.accessKeySecret}"</span><span style="color:#E06C75">)</span></span>
<span class="line"><span style="color:#C678DD">    private</span><span style="color:#E5C07B"> String</span><span style="color:#E06C75"> accessKeySecret</span><span style="color:#ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * é˜¿é‡Œäº‘ oss æ–‡ä»¶æ ¹ç›®å½•</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     */</span></span>
<span class="line"><span style="color:#ABB2BF">    @</span><span style="color:#E5C07B">Value</span><span style="color:#E06C75">(</span><span style="color:#98C379">"${oss.bucketName}"</span><span style="color:#E06C75">)</span></span>
<span class="line"><span style="color:#C678DD">    private</span><span style="color:#E5C07B"> String</span><span style="color:#E06C75"> bucketName</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * æ–‡ä»¶ç›®å½•</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     */</span></span>
<span class="line"><span style="color:#ABB2BF">    @</span><span style="color:#E5C07B">Value</span><span style="color:#E06C75">(</span><span style="color:#98C379">"${oss.dirName}"</span><span style="color:#E06C75">)</span></span>
<span class="line"><span style="color:#C678DD">    private</span><span style="color:#E5C07B"> String</span><span style="color:#E06C75"> dirName</span><span style="color:#ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF">    @</span><span style="color:#E5C07B">Override</span></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#C678DD"> void</span><span style="color:#61AFEF"> afterPropertiesSet</span><span style="color:#ABB2BF">()</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#ABB2BF">        END_POINT </span><span style="color:#56B6C2">=</span><span style="color:#ABB2BF"> endpoint;</span></span>
<span class="line"><span style="color:#ABB2BF">        ACCESS_KEY_ID </span><span style="color:#56B6C2">=</span><span style="color:#ABB2BF"> accessKeyId;</span></span>
<span class="line"><span style="color:#ABB2BF">        ACCESS_KEY_SECRET </span><span style="color:#56B6C2">=</span><span style="color:#ABB2BF"> accessKeySecret;</span></span>
<span class="line"><span style="color:#ABB2BF">        BUCKET_NAME </span><span style="color:#56B6C2">=</span><span style="color:#ABB2BF"> bucketName;</span></span>
<span class="line"><span style="color:#ABB2BF">        DIR_NAME </span><span style="color:#56B6C2">=</span><span style="color:#ABB2BF"> dirName;</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF">}</span></span></code></pre></td></tr></tbody></table>
      </figure>
<p>ç¼–å†™ OSS çš„é…ç½®ç±»ï¼Œå°†è¯»å–åˆ°çš„é…ç½®ä¿¡æ¯æ³¨å…¥åˆ° Spring ä¸­ï¼š</p>
<figure class="highlight java line-numbers" data-language="JAVA">
        <table style="background-color: #282c34"><tbody><tr><td class="gutter" style="background-color: #282c34"><pre style="background-color: #282c34"><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code" style="background-color: #282c34"><pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic">/**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * </span><span style="color:#C678DD;font-style:italic">@author</span><span style="color:#7F848E;font-style:italic"> mofan</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * @date 2021/6/2 13:46</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> */</span></span>
<span class="line"><span style="color:#ABB2BF">@</span><span style="color:#E5C07B">Configuration</span></span>
<span class="line"><span style="color:#C678DD">public</span><span style="color:#C678DD"> class</span><span style="color:#E5C07B"> OssConfig</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF">    @</span><span style="color:#E5C07B">Bean</span></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#E5C07B"> OSSClient</span><span style="color:#61AFEF"> ossClient</span><span style="color:#ABB2BF">()</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#C678DD">        return</span><span style="color:#C678DD"> new</span><span style="color:#61AFEF"> OSSClient</span><span style="color:#ABB2BF">(</span></span>
<span class="line"><span style="color:#E5C07B">                OssConstant</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">END_POINT</span><span style="color:#ABB2BF">,</span></span>
<span class="line"><span style="color:#C678DD">                new</span><span style="color:#61AFEF"> DefaultCredentialProvider</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">OssConstant</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">ACCESS_KEY_ID</span><span style="color:#ABB2BF">, </span><span style="color:#E5C07B">OssConstant</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">ACCESS_KEY_SECRET</span><span style="color:#ABB2BF">),</span></span>
<span class="line"><span style="color:#C678DD">                new</span><span style="color:#61AFEF"> ClientConfiguration</span><span style="color:#ABB2BF">());</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF">}</span></span></code></pre></td></tr></tbody></table>
      </figure>
<p>æœ€åç¼–å†™å…·ä½“ Service æœåŠ¡ï¼ˆä»…ä»¥æ–‡ä»¶ä¸Šä¼ ä¸ºä¾‹ï¼‰ï¼š</p>
<figure class="highlight java line-numbers" data-language="JAVA">
        <table style="background-color: #282c34"><tbody><tr><td class="gutter" style="background-color: #282c34"><pre style="background-color: #282c34"><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br></pre></td><td class="code" style="background-color: #282c34"><pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic">/**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * </span><span style="color:#C678DD;font-style:italic">@author</span><span style="color:#7F848E;font-style:italic"> mofan</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * @date 2021/6/2 13:48</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> */</span></span>
<span class="line"><span style="color:#ABB2BF">@</span><span style="color:#E5C07B">Slf4j</span></span>
<span class="line"><span style="color:#ABB2BF">@</span><span style="color:#E5C07B">Service</span></span>
<span class="line"><span style="color:#C678DD">public</span><span style="color:#C678DD"> class</span><span style="color:#E5C07B"> OssService</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF">    @</span><span style="color:#E5C07B">Autowired</span></span>
<span class="line"><span style="color:#C678DD">    private</span><span style="color:#E5C07B"> OSSClient</span><span style="color:#E06C75"> ossClient</span><span style="color:#ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * ä¸Šä¼  PDF æ–‡ä»¶è‡³é˜¿é‡Œäº‘ OSS</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * æ–‡ä»¶ä¸Šä¼ æˆåŠŸ,è¿”å›æ–‡ä»¶å®Œæ•´è®¿é—®è·¯å¾„</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     *</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * </span><span style="color:#C678DD;font-style:italic">@param</span><span style="color:#E06C75;font-style:italic"> file</span><span style="color:#7F848E;font-style:italic"> ä¸Šä¼ æ–‡ä»¶</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * </span><span style="color:#C678DD;font-style:italic">@return</span><span style="color:#7F848E;font-style:italic"> æ–‡ä»¶åœ°å€</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     */</span></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#E5C07B"> Result</span><span style="color:#ABB2BF">&lt;</span><span style="color:#E5C07B">String</span><span style="color:#ABB2BF">&gt;</span><span style="color:#61AFEF"> uploadPdf</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">MultipartFile</span><span style="color:#E06C75;font-style:italic"> file</span><span style="color:#ABB2BF">)</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#C678DD">        if</span><span style="color:#ABB2BF"> (</span><span style="color:#E5C07B">FileUtil</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">isNotPdfFile</span><span style="color:#ABB2BF">(file)) {</span></span>
<span class="line"><span style="color:#E5C07B">            log</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">error</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">"pdfæ–‡ä»¶ä¸Šä¼ å¤±è´¥"</span><span style="color:#ABB2BF">);</span></span>
<span class="line"><span style="color:#C678DD">            throw</span><span style="color:#C678DD"> new</span><span style="color:#61AFEF"> BusinessException</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">ErrorCode</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">FILE_TYPE_ERROR</span><span style="color:#ABB2BF">).</span><span style="color:#61AFEF">addError</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">"ä¸Šä¼ æ–‡ä»¶ç±»å‹é”™è¯¯"</span><span style="color:#ABB2BF">);</span></span>
<span class="line"><span style="color:#ABB2BF">        }</span></span>
<span class="line"><span style="color:#C678DD">        if</span><span style="color:#ABB2BF"> (</span><span style="color:#E5C07B">file</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getSize</span><span style="color:#ABB2BF">() </span><span style="color:#56B6C2">&lt;=</span><span style="color:#D19A66"> 0</span><span style="color:#56B6C2"> ||</span><span style="color:#E5C07B"> file</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getSize</span><span style="color:#ABB2BF">() </span><span style="color:#56B6C2">&gt;</span><span style="color:#E5C07B"> OssConstant</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">FILE_MAX_SIZE</span><span style="color:#ABB2BF">) {</span></span>
<span class="line"><span style="color:#C678DD">            throw</span><span style="color:#C678DD"> new</span><span style="color:#61AFEF"> BusinessException</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">ErrorCode</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">FILE_SIZE_TOO_LARGE</span><span style="color:#ABB2BF">).</span><span style="color:#61AFEF">addError</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">"å°ºå¯¸è¿‡å¤§"</span><span style="color:#ABB2BF">);</span></span>
<span class="line"><span style="color:#ABB2BF">        }</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">        // æ–‡ä»¶å…¨åç§°åŒ…æ‹¬åç¼€</span></span>
<span class="line"><span style="color:#E5C07B">        String</span><span style="color:#E06C75"> oldName</span><span style="color:#56B6C2"> =</span><span style="color:#E5C07B"> file</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getOriginalFilename</span><span style="color:#ABB2BF">();</span></span>
<span class="line"><span style="color:#E5C07B">        Assert</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">notNull</span><span style="color:#ABB2BF">(oldName, </span><span style="color:#98C379">"æ–‡ä»¶å…¨åç§°ä¸èƒ½ä¸ºç©º"</span><span style="color:#ABB2BF">);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">        // æ–‡ä»¶åç¼€</span></span>
<span class="line"><span style="color:#E5C07B">        String</span><span style="color:#E06C75"> suffix</span><span style="color:#56B6C2"> =</span><span style="color:#E5C07B"> oldName</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">substring</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">oldName</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">lastIndexOf</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">"."</span><span style="color:#ABB2BF">) </span><span style="color:#56B6C2">+</span><span style="color:#D19A66"> 1</span><span style="color:#ABB2BF">);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">        // æ–‡ä»¶åç§° ä¸åŒ…æ‹¬åç¼€</span></span>
<span class="line"><span style="color:#E5C07B">        String</span><span style="color:#E06C75"> prefix</span><span style="color:#56B6C2"> =</span><span style="color:#E5C07B"> oldName</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">substring</span><span style="color:#ABB2BF">(</span><span style="color:#D19A66">0</span><span style="color:#ABB2BF">, </span><span style="color:#E5C07B">oldName</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">lastIndexOf</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">"."</span><span style="color:#ABB2BF">));</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">        // æ–°æ–‡ä»¶åç§° æ–‡ä»¶ç›®å½•è·¯å¾„ + uuidï¼ˆä¸å¸¦ -ï¼‰ + æ—§æ–‡ä»¶å</span></span>
<span class="line"><span style="color:#E5C07B">        String</span><span style="color:#E06C75"> fileName</span><span style="color:#56B6C2"> =</span><span style="color:#E5C07B"> OssConstant</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">DIR_NAME</span><span style="color:#56B6C2"> +</span><span style="color:#E5C07B"> IdUtil</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">simpleUUID</span><span style="color:#ABB2BF">()</span></span>
<span class="line"><span style="color:#ABB2BF">                .</span><span style="color:#61AFEF">replace</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">"-"</span><span style="color:#ABB2BF">, </span><span style="color:#98C379">""</span><span style="color:#ABB2BF">) </span><span style="color:#56B6C2">+</span><span style="color:#98C379"> "_"</span><span style="color:#56B6C2"> +</span><span style="color:#ABB2BF"> oldName;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">        // è·å–æ–‡ä»¶ç±»å‹</span></span>
<span class="line"><span style="color:#E5C07B">        String</span><span style="color:#E06C75"> fileType</span><span style="color:#56B6C2"> =</span><span style="color:#61AFEF"> contentType</span><span style="color:#ABB2BF">(suffix);</span></span>
<span class="line"><span style="color:#C678DD">        try</span><span style="color:#ABB2BF"> (</span><span style="color:#E5C07B">InputStream</span><span style="color:#E06C75"> inputStream</span><span style="color:#56B6C2"> =</span><span style="color:#E5C07B"> file</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getInputStream</span><span style="color:#ABB2BF">()){</span></span>
<span class="line"><span style="color:#C678DD">            return</span><span style="color:#E5C07B"> Result</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">success</span><span style="color:#ABB2BF">(</span><span style="color:#61AFEF">putFile</span><span style="color:#ABB2BF">(inputStream, fileType, fileName));</span></span>
<span class="line"><span style="color:#ABB2BF">        } </span><span style="color:#C678DD">catch</span><span style="color:#ABB2BF"> (</span><span style="color:#E5C07B">IOException</span><span style="color:#E06C75;font-style:italic"> e</span><span style="color:#ABB2BF">) {</span></span>
<span class="line"><span style="color:#C678DD">            throw</span><span style="color:#C678DD"> new</span><span style="color:#61AFEF"> BusinessException</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">ErrorCode</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">FILE_IO_ERROR</span><span style="color:#ABB2BF">).</span><span style="color:#61AFEF">addError</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">"PDFä¸Šä¼ å¤±è´¥"</span><span style="color:#ABB2BF">);</span></span>
<span class="line"><span style="color:#ABB2BF">        }</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * ä¸Šä¼ æ–‡ä»¶</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     *</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * </span><span style="color:#C678DD;font-style:italic">@param</span><span style="color:#E06C75;font-style:italic"> input</span><span style="color:#7F848E;font-style:italic">    æ–‡ä»¶è¾“å…¥æµ</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * </span><span style="color:#C678DD;font-style:italic">@param</span><span style="color:#E06C75;font-style:italic"> fileType</span><span style="color:#7F848E;font-style:italic"> æ–‡ä»¶ç±»å‹</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * </span><span style="color:#C678DD;font-style:italic">@param</span><span style="color:#E06C75;font-style:italic"> fileName</span><span style="color:#7F848E;font-style:italic"> æ–‡ä»¶å</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * </span><span style="color:#C678DD;font-style:italic">@return</span><span style="color:#7F848E;font-style:italic"> æ–‡ä»¶åœ°å€</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     */</span></span>
<span class="line"><span style="color:#C678DD">    private</span><span style="color:#E5C07B"> String</span><span style="color:#61AFEF"> putFile</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">InputStream</span><span style="color:#E06C75;font-style:italic"> input</span><span style="color:#ABB2BF">, </span><span style="color:#E5C07B">String</span><span style="color:#E06C75;font-style:italic"> fileType</span><span style="color:#ABB2BF">, </span><span style="color:#E5C07B">String</span><span style="color:#E06C75;font-style:italic"> fileName</span><span style="color:#ABB2BF">)</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">        // åˆ›å»ºä¸Šä¼ Objectçš„Metadata</span></span>
<span class="line"><span style="color:#E5C07B">        ObjectMetadata</span><span style="color:#E06C75"> meta</span><span style="color:#56B6C2"> =</span><span style="color:#C678DD"> new</span><span style="color:#61AFEF"> ObjectMetadata</span><span style="color:#ABB2BF">();</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">        // è®¾ç½®ä¸Šä¼ å†…å®¹ç±»å‹</span></span>
<span class="line"><span style="color:#E5C07B">        meta</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">setContentType</span><span style="color:#ABB2BF">(fileType);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">        //è¢«ä¸‹è½½æ—¶ç½‘é¡µçš„ç¼“å­˜è¡Œä¸º</span></span>
<span class="line"><span style="color:#E5C07B">        meta</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">setCacheControl</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">"no-cache"</span><span style="color:#ABB2BF">);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">        //åˆ›å»ºä¸Šä¼ è¯·æ±‚</span></span>
<span class="line"><span style="color:#E5C07B">        PutObjectRequest</span><span style="color:#E06C75"> request</span><span style="color:#56B6C2"> =</span><span style="color:#C678DD"> new</span><span style="color:#61AFEF"> PutObjectRequest</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">OssConstant</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">BUCKET_NAME</span><span style="color:#ABB2BF">, fileName, input, meta);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">        //ä¸Šä¼ æ–‡ä»¶</span></span>
<span class="line"><span style="color:#E5C07B">        ossClient</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">putObject</span><span style="color:#ABB2BF">(request);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">        // è¿”å›æ–‡ä»¶åœ°å€</span></span>
<span class="line"><span style="color:#C678DD">        return</span><span style="color:#61AFEF"> getOssUrl</span><span style="color:#ABB2BF">(fileName);</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * æ ¹æ®æ–‡ä»¶åç”Ÿæˆæ–‡ä»¶çš„è®¿é—®åœ°å€</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     *</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * </span><span style="color:#C678DD;font-style:italic">@param</span><span style="color:#E06C75;font-style:italic"> fileName</span><span style="color:#7F848E;font-style:italic"> æ–‡ä»¶å</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * </span><span style="color:#C678DD;font-style:italic">@return</span><span style="color:#7F848E;font-style:italic"> æ–‡ä»¶æ‰€åœ¨ä½ç½®</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     */</span></span>
<span class="line"><span style="color:#C678DD">    private</span><span style="color:#E5C07B"> String</span><span style="color:#61AFEF"> getOssUrl</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">String</span><span style="color:#E06C75;font-style:italic"> fileName</span><span style="color:#ABB2BF">)</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#C678DD">        return</span><span style="color:#98C379"> "https://"</span><span style="color:#56B6C2"> +</span><span style="color:#E5C07B"> OssConstant</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">BUCKET_NAME</span><span style="color:#56B6C2"> +</span><span style="color:#98C379"> "."</span><span style="color:#56B6C2"> +</span><span style="color:#E5C07B"> OssConstant</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">END_POINT</span><span style="color:#56B6C2"> +</span><span style="color:#98C379"> "/"</span><span style="color:#56B6C2"> +</span><span style="color:#ABB2BF"> fileName;</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * æ ¹æ® url è·å– fileName</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     *</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * </span><span style="color:#C678DD;font-style:italic">@param</span><span style="color:#E06C75;font-style:italic"> fileUrl</span><span style="color:#7F848E;font-style:italic"> æ–‡ä»¶ url</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * </span><span style="color:#C678DD;font-style:italic">@return</span><span style="color:#7F848E;font-style:italic"> æ–‡ä»¶åç§°</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     */</span></span>
<span class="line"><span style="color:#C678DD">    private</span><span style="color:#E5C07B"> String</span><span style="color:#61AFEF"> getFileName</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">String</span><span style="color:#E06C75;font-style:italic"> fileUrl</span><span style="color:#ABB2BF">)</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#E5C07B">        String</span><span style="color:#E06C75"> str</span><span style="color:#56B6C2"> =</span><span style="color:#98C379"> "aliyuncs.com/"</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD">        int</span><span style="color:#E06C75"> beginIndex</span><span style="color:#56B6C2"> =</span><span style="color:#E5C07B"> fileUrl</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">indexOf</span><span style="color:#ABB2BF">(str);</span></span>
<span class="line"><span style="color:#C678DD">        if</span><span style="color:#ABB2BF"> (beginIndex </span><span style="color:#56B6C2">==</span><span style="color:#56B6C2"> -</span><span style="color:#D19A66">1</span><span style="color:#ABB2BF">) {</span></span>
<span class="line"><span style="color:#C678DD">            return</span><span style="color:#D19A66"> null</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#ABB2BF">        }</span></span>
<span class="line"><span style="color:#C678DD">        return</span><span style="color:#E5C07B"> fileUrl</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">substring</span><span style="color:#ABB2BF">(beginIndex </span><span style="color:#56B6C2">+</span><span style="color:#E5C07B"> str</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">length</span><span style="color:#ABB2BF">());</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * </span><span style="color:#C678DD;font-style:italic">@param</span><span style="color:#E06C75;font-style:italic"> fileUrls</span><span style="color:#7F848E;font-style:italic"> æ–‡ä»¶ url</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * </span><span style="color:#C678DD;font-style:italic">@return</span><span style="color:#7F848E;font-style:italic"> {@literal List&lt;String&gt;}  fileName é›†åˆ</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     */</span></span>
<span class="line"><span style="color:#C678DD">    private</span><span style="color:#E5C07B"> List</span><span style="color:#ABB2BF">&lt;</span><span style="color:#E5C07B">String</span><span style="color:#ABB2BF">&gt;</span><span style="color:#61AFEF"> getFileName</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">List</span><span style="color:#ABB2BF">&lt;</span><span style="color:#E5C07B">String</span><span style="color:#ABB2BF">&gt; </span><span style="color:#E06C75;font-style:italic">fileUrls</span><span style="color:#ABB2BF">)</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#E5C07B">        List</span><span style="color:#ABB2BF">&lt;</span><span style="color:#E5C07B">String</span><span style="color:#ABB2BF">&gt; </span><span style="color:#E06C75">names</span><span style="color:#56B6C2"> =</span><span style="color:#C678DD"> new</span><span style="color:#E5C07B"> ArrayList</span><span style="color:#ABB2BF">&lt;&gt;();</span></span>
<span class="line"><span style="color:#C678DD">        for</span><span style="color:#ABB2BF"> (</span><span style="color:#E5C07B">String</span><span style="color:#E06C75"> url</span><span style="color:#C678DD"> :</span><span style="color:#ABB2BF"> fileUrls) {</span></span>
<span class="line"><span style="color:#E5C07B">            names</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">add</span><span style="color:#ABB2BF">(</span><span style="color:#61AFEF">getFileName</span><span style="color:#ABB2BF">(url));</span></span>
<span class="line"><span style="color:#ABB2BF">        }</span></span>
<span class="line"><span style="color:#C678DD">        return</span><span style="color:#ABB2BF"> names;</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * </span><span style="color:#C678DD;font-style:italic">@param</span><span style="color:#E06C75;font-style:italic"> fileType</span><span style="color:#7F848E;font-style:italic"> æ–‡ä»¶ç±»å‹</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * </span><span style="color:#C678DD;font-style:italic">@return</span><span style="color:#7F848E;font-style:italic"> æ–‡ä»¶çš„ contentType</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     */</span></span>
<span class="line"><span style="color:#C678DD">    private</span><span style="color:#E5C07B"> String</span><span style="color:#61AFEF"> contentType</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">String</span><span style="color:#E06C75;font-style:italic"> fileType</span><span style="color:#ABB2BF">)</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#ABB2BF">        fileType </span><span style="color:#56B6C2">=</span><span style="color:#E5C07B"> fileType</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">toLowerCase</span><span style="color:#ABB2BF">();</span></span>
<span class="line"><span style="color:#E5C07B">        String</span><span style="color:#E06C75"> contentType</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD">        switch</span><span style="color:#ABB2BF"> (fileType) {</span></span>
<span class="line"><span style="color:#C678DD">            case</span><span style="color:#98C379"> "bmp"</span><span style="color:#C678DD">:</span></span>
<span class="line"><span style="color:#ABB2BF">                contentType </span><span style="color:#56B6C2">=</span><span style="color:#98C379"> "image/bmp"</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD">                break</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD">            case</span><span style="color:#98C379"> "gif"</span><span style="color:#C678DD">:</span></span>
<span class="line"><span style="color:#ABB2BF">                contentType </span><span style="color:#56B6C2">=</span><span style="color:#98C379"> "image/gif"</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD">                break</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD">            case</span><span style="color:#98C379"> "png"</span><span style="color:#C678DD">:</span></span>
<span class="line"><span style="color:#C678DD">            case</span><span style="color:#98C379"> "jpeg"</span><span style="color:#C678DD">:</span></span>
<span class="line"><span style="color:#C678DD">            case</span><span style="color:#98C379"> "jpg"</span><span style="color:#C678DD">:</span></span>
<span class="line"><span style="color:#ABB2BF">                contentType </span><span style="color:#56B6C2">=</span><span style="color:#98C379"> "image/jpeg"</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD">                break</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD">            case</span><span style="color:#98C379"> "html"</span><span style="color:#C678DD">:</span></span>
<span class="line"><span style="color:#ABB2BF">                contentType </span><span style="color:#56B6C2">=</span><span style="color:#98C379"> "text/html"</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD">                break</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD">            case</span><span style="color:#98C379"> "txt"</span><span style="color:#C678DD">:</span></span>
<span class="line"><span style="color:#ABB2BF">                contentType </span><span style="color:#56B6C2">=</span><span style="color:#98C379"> "text/plain"</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD">                break</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD">            case</span><span style="color:#98C379"> "vsd"</span><span style="color:#C678DD">:</span></span>
<span class="line"><span style="color:#ABB2BF">                contentType </span><span style="color:#56B6C2">=</span><span style="color:#98C379"> "application/vnd.visio"</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD">                break</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD">            case</span><span style="color:#98C379"> "pdf"</span><span style="color:#C678DD">:</span></span>
<span class="line"><span style="color:#ABB2BF">                contentType </span><span style="color:#56B6C2">=</span><span style="color:#98C379"> "application/pdf"</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD">                break</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD">            case</span><span style="color:#98C379"> "ppt"</span><span style="color:#C678DD">:</span></span>
<span class="line"><span style="color:#C678DD">            case</span><span style="color:#98C379"> "pptx"</span><span style="color:#C678DD">:</span></span>
<span class="line"><span style="color:#ABB2BF">                contentType </span><span style="color:#56B6C2">=</span><span style="color:#98C379"> "application/vnd.ms-powerpoint"</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD">                break</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD">            case</span><span style="color:#98C379"> "doc"</span><span style="color:#C678DD">:</span></span>
<span class="line"><span style="color:#C678DD">            case</span><span style="color:#98C379"> "docx"</span><span style="color:#C678DD">:</span></span>
<span class="line"><span style="color:#ABB2BF">                contentType </span><span style="color:#56B6C2">=</span><span style="color:#98C379"> "application/msword"</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD">                break</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD">            case</span><span style="color:#98C379"> "xml"</span><span style="color:#C678DD">:</span></span>
<span class="line"><span style="color:#ABB2BF">                contentType </span><span style="color:#56B6C2">=</span><span style="color:#98C379"> "text/xml"</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD">                break</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD">            case</span><span style="color:#98C379"> "mp4"</span><span style="color:#C678DD">:</span></span>
<span class="line"><span style="color:#ABB2BF">                contentType </span><span style="color:#56B6C2">=</span><span style="color:#98C379"> "video/mp4"</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD">                break</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD">            default:</span></span>
<span class="line"><span style="color:#ABB2BF">                contentType </span><span style="color:#56B6C2">=</span><span style="color:#98C379"> "application/octet-stream"</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD">                break</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#ABB2BF">        }</span></span>
<span class="line"><span style="color:#C678DD">        return</span><span style="color:#ABB2BF"> contentType;</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF">}</span></span></code></pre></td></tr></tbody></table>
      </figure>
<p>å¦‚æœéœ€è¦ä½¿ç”¨ï¼Œæ¥æ”¶å‰ç«¯ä¼ é€’çš„ <code>MultipartFile</code> å³å¯ã€‚æ¯”å¦‚ï¼Œåœ¨ä¸Šä¼  PDFï¼š</p>
<figure class="highlight java line-numbers" data-language="JAVA">
        <table style="background-color: #282c34"><tbody><tr><td class="gutter" style="background-color: #282c34"><pre style="background-color: #282c34"><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code" style="background-color: #282c34"><pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF">@</span><span style="color:#E5C07B">PostMapping</span><span style="color:#E06C75">(</span><span style="color:#98C379">"upload/pdf"</span><span style="color:#E06C75">)</span></span>
<span class="line"><span style="color:#C678DD">public</span><span style="color:#E5C07B"> Result</span><span style="color:#56B6C2">&lt;</span><span style="color:#E06C75">String</span><span style="color:#56B6C2">&gt;</span><span style="color:#61AFEF"> uploadPdf</span><span style="color:#E06C75">(</span><span style="color:#ABB2BF">@</span><span style="color:#E5C07B">RequestParam</span><span style="color:#E06C75">(</span><span style="color:#98C379">"file"</span><span style="color:#E06C75">) </span><span style="color:#E5C07B">MultipartFile</span><span style="color:#E06C75"> file) {</span></span>
<span class="line"><span style="color:#C678DD">    return</span><span style="color:#E5C07B"> ossService</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">uploadPdf</span><span style="color:#ABB2BF">(file);</span></span>
<span class="line"><span style="color:#E06C75">}</span></span></code></pre></td></tr></tbody></table>
      </figure>
<h1 id="4-åç«¯-logback"><a class="header-anchor" href="#4-åç«¯-logback"></a>4.åç«¯ - logback</h1>
<p>åœ¨é¡¹ç›®ä¸­ï¼Œæœ‰æ—¶éœ€è¦æ‰“å°æ—¥å¿—ä¿¡æ¯å¹¶ä¿å­˜åˆ°æ—¥å¿—æ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ logback æ¥å®ç°è¿™ä¸ªåŠŸèƒ½ã€‚</p>
<p>ä¸ºäº†åœ¨ä¸åŒç¯å¢ƒä¸‹æ‰“å°ä¸åŒçš„æ—¥å¿—ä¿¡æ¯ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨å¤šç¯å¢ƒé…ç½®æ–‡ä»¶ã€‚</p>
<p>æ·»åŠ é…ç½®æ–‡ä»¶ï¼š<code>application-dev.yml</code>ï¼Œè¿™ä¸ªé…ç½®æ–‡ä»¶åœ¨å¼€å‘ç¯å¢ƒä¸‹ä½¿ç”¨ï¼Œå°†ç°é˜¶æ®µæ‰€æœ‰é…ç½®ä¿¡æ¯éƒ½ç§»åˆ°è¿™ä¸ªé…ç½®æ–‡ä»¶ä¸­ã€‚ä¿®æ”¹ <code>application.yml</code> ä¸ºï¼š</p>
<figure class="highlight yaml line-numbers" data-language="YAML">
        <table style="background-color: #282c34"><tbody><tr><td class="gutter" style="background-color: #282c34"><pre style="background-color: #282c34"><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code" style="background-color: #282c34"><pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#E06C75">spring</span><span style="color:#ABB2BF">:</span></span>
<span class="line"><span style="color:#E06C75">  profiles</span><span style="color:#ABB2BF">:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    # å¯ç”¨ dev é…ç½®æ–‡ä»¶</span></span>
<span class="line"><span style="color:#E06C75">    active</span><span style="color:#ABB2BF">: </span><span style="color:#98C379">dev</span></span></code></pre></td></tr></tbody></table>
      </figure>
<p>ç„¶ååœ¨é¡¹ç›®çš„ <mark>resources</mark> ç›®å½•ä¸‹åˆ›å»º logback-spring.xml æ–‡ä»¶ï¼ˆåç§°ä¸èƒ½å˜ï¼Œå¿…é¡»æ˜¯è¿™ä¸ªï¼Œä¸”ä»…åœ¨ Spring ç¯å¢ƒä¸‹ç”Ÿæ•ˆï¼‰ï¼Œå¹¶æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š</p>
<figure class="highlight xml line-numbers" data-language="XML">
        <table style="background-color: #282c34"><tbody><tr><td class="gutter" style="background-color: #282c34"><pre style="background-color: #282c34"><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br></pre></td><td class="code" style="background-color: #282c34"><pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF">&lt;?</span><span style="color:#E06C75">xml</span><span style="color:#D19A66"> version</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"1.0"</span><span style="color:#D19A66"> encoding</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"UTF-8"</span><span style="color:#ABB2BF">?&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">&lt;</span><span style="color:#E06C75">configuration</span><span style="color:#D19A66">  scan</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"true"</span><span style="color:#D19A66"> scanPeriod</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"10 seconds"</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    &lt;!-- æ—¥å¿—çº§åˆ«ä»ä½åˆ°é«˜åˆ†ä¸ºTRACE &lt; DEBUG &lt; INFO &lt; WARN &lt; ERROR &lt; FATALï¼Œå¦‚æœè®¾ç½®ä¸ºWARNï¼Œåˆ™ä½äºWARNçš„ä¿¡æ¯éƒ½ä¸ä¼šè¾“å‡º --&gt;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    &lt;!-- scan:å½“æ­¤å±æ€§è®¾ç½®ä¸ºtrueæ—¶ï¼Œé…ç½®æ–‡ä»¶å¦‚æœå‘ç”Ÿæ”¹å˜ï¼Œå°†ä¼šè¢«é‡æ–°åŠ è½½ï¼Œé»˜è®¤å€¼ä¸ºtrue --&gt;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    &lt;!-- scanPeriod:è®¾ç½®ç›‘æµ‹é…ç½®æ–‡ä»¶æ˜¯å¦æœ‰ä¿®æ”¹çš„æ—¶é—´é—´éš”ï¼Œå¦‚æœæ²¡æœ‰ç»™å‡ºæ—¶é—´å•ä½ï¼Œé»˜è®¤å•ä½æ˜¯æ¯«ç§’ã€‚å½“scanä¸ºtrueæ—¶ï¼Œæ­¤å±æ€§ç”Ÿæ•ˆã€‚é»˜è®¤çš„æ—¶é—´é—´éš”ä¸º1åˆ†é’Ÿã€‚ --&gt;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    &lt;!-- debug:å½“æ­¤å±æ€§è®¾ç½®ä¸ºtrueæ—¶ï¼Œå°†æ‰“å°å‡ºlogbackå†…éƒ¨æ—¥å¿—ä¿¡æ¯ï¼Œå®æ—¶æŸ¥çœ‹logbackè¿è¡ŒçŠ¶æ€ã€‚é»˜è®¤å€¼ä¸ºfalseã€‚ --&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF">    &lt;</span><span style="color:#E06C75">contextName</span><span style="color:#ABB2BF">&gt;logback&lt;/</span><span style="color:#E06C75">contextName</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    &lt;!-- nameçš„å€¼æ˜¯å˜é‡çš„åç§°ï¼Œvalueçš„å€¼æ—¶å˜é‡å®šä¹‰çš„å€¼ã€‚é€šè¿‡å®šä¹‰çš„å€¼ä¼šè¢«æ’å…¥åˆ°loggerä¸Šä¸‹æ–‡ä¸­ã€‚å®šä¹‰å˜é‡åï¼Œå¯ä»¥ä½¿â€œ${}â€æ¥ä½¿ç”¨å˜é‡ã€‚ --&gt;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    &lt;!--æ—¥å¿—æ–‡ä»¶å­˜æ”¾ä½ç½®ï¼Œé¡¹ç›®åŒçº§ç›®å½•çš„logsç›®å½•ä¸‹å­˜æ”¾æ—¥å¿—æ–‡ä»¶--&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">    &lt;</span><span style="color:#E06C75">property</span><span style="color:#D19A66"> name</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"log.path"</span><span style="color:#D19A66"> value</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"../logs"</span><span style="color:#ABB2BF"> /&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    &lt;!-- å½©è‰²æ—¥å¿— --&gt;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    &lt;!-- é…ç½®æ ¼å¼å˜é‡ï¼šCONSOLE_LOG_PATTERN å½©è‰²æ—¥å¿—æ ¼å¼ --&gt;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    &lt;!-- magenta:æ´‹çº¢ --&gt;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    &lt;!-- boldMagenta:ç²—çº¢--&gt;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    &lt;!-- cyan:é’è‰² --&gt;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    &lt;!-- white:ç™½è‰² --&gt;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    &lt;!-- magenta:æ´‹çº¢ --&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">    &lt;</span><span style="color:#E06C75">property</span><span style="color:#D19A66"> name</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"CONSOLE_LOG_PATTERN"</span></span>
<span class="line"><span style="color:#D19A66">              value</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"%yellow(%date{yyyy-MM-dd HH:mm:ss}) |%highlight(%-5level) |%blue(%thread) |%blue(%file:%line) |%green(%logger) |%cyan(%msg%n)"</span><span style="color:#ABB2BF">/&gt;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    &lt;!--è¾“å‡ºåˆ°æ§åˆ¶å°--&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">    &lt;</span><span style="color:#E06C75">appender</span><span style="color:#D19A66"> name</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"CONSOLE"</span><span style="color:#D19A66"> class</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"ch.qos.logback.core.ConsoleAppender"</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">        &lt;!--æ­¤æ—¥å¿—appenderæ˜¯ä¸ºå¼€å‘ä½¿ç”¨ï¼Œåªé…ç½®æœ€åº•çº§åˆ«ï¼Œæ§åˆ¶å°è¾“å‡ºçš„æ—¥å¿—çº§åˆ«æ˜¯å¤§äºæˆ–ç­‰äºæ­¤çº§åˆ«çš„æ—¥å¿—ä¿¡æ¯--&gt;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">        &lt;!-- ä¾‹å¦‚ï¼šå¦‚æœæ­¤å¤„é…ç½®äº†INFOçº§åˆ«ï¼Œåˆ™åé¢å…¶ä»–ä½ç½®å³ä½¿é…ç½®äº†DEBUGçº§åˆ«çš„æ—¥å¿—ï¼Œä¹Ÿä¸ä¼šè¢«è¾“å‡º --&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">        &lt;</span><span style="color:#E06C75">filter</span><span style="color:#D19A66"> class</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"ch.qos.logback.classic.filter.ThresholdFilter"</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">            &lt;</span><span style="color:#E06C75">level</span><span style="color:#ABB2BF">&gt;INFO&lt;/</span><span style="color:#E06C75">level</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">        &lt;/</span><span style="color:#E06C75">filter</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">        &lt;</span><span style="color:#E06C75">encoder</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">            &lt;</span><span style="color:#E06C75">Pattern</span><span style="color:#ABB2BF">&gt;${CONSOLE_LOG_PATTERN}&lt;/</span><span style="color:#E06C75">Pattern</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">            &lt;!-- è®¾ç½®å­—ç¬¦é›† --&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">            &lt;</span><span style="color:#E06C75">charset</span><span style="color:#ABB2BF">&gt;UTF-8&lt;/</span><span style="color:#E06C75">charset</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">        &lt;/</span><span style="color:#E06C75">encoder</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">    &lt;/</span><span style="color:#E06C75">appender</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    &lt;!--è¾“å‡ºåˆ°æ–‡ä»¶--&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    &lt;!-- æ—¶é—´æ»šåŠ¨è¾“å‡º levelä¸º INFO æ—¥å¿— --&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">    &lt;</span><span style="color:#E06C75">appender</span><span style="color:#D19A66"> name</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"INFO_FILE"</span><span style="color:#D19A66"> class</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"ch.qos.logback.core.rolling.RollingFileAppender"</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">        &lt;!-- æ­£åœ¨è®°å½•çš„æ—¥å¿—æ–‡ä»¶çš„è·¯å¾„åŠæ–‡ä»¶å --&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">        &lt;</span><span style="color:#E06C75">file</span><span style="color:#ABB2BF">&gt;${log.path}/log_info.log&lt;/</span><span style="color:#E06C75">file</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">        &lt;!--æ—¥å¿—æ–‡ä»¶è¾“å‡ºæ ¼å¼--&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">        &lt;</span><span style="color:#E06C75">encoder</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">            &lt;</span><span style="color:#E06C75">pattern</span><span style="color:#ABB2BF">&gt;%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{50} - %msg%n&lt;/</span><span style="color:#E06C75">pattern</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">            &lt;</span><span style="color:#E06C75">charset</span><span style="color:#ABB2BF">&gt;UTF-8&lt;/</span><span style="color:#E06C75">charset</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">        &lt;/</span><span style="color:#E06C75">encoder</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">        &lt;!-- æ—¥å¿—è®°å½•å™¨çš„æ»šåŠ¨ç­–ç•¥ï¼ŒæŒ‰æ—¥æœŸï¼ŒæŒ‰å¤§å°è®°å½• --&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">        &lt;</span><span style="color:#E06C75">rollingPolicy</span><span style="color:#D19A66"> class</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"ch.qos.logback.core.rolling.TimeBasedRollingPolicy"</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">            &lt;!-- æ¯å¤©æ—¥å¿—å½’æ¡£è·¯å¾„ä»¥åŠæ ¼å¼ --&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">            &lt;</span><span style="color:#E06C75">fileNamePattern</span><span style="color:#ABB2BF">&gt;${log.path}/info/log-info-%d{yyyy-MM-dd}.%i.log&lt;/</span><span style="color:#E06C75">fileNamePattern</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">            &lt;</span><span style="color:#E06C75">timeBasedFileNamingAndTriggeringPolicy</span><span style="color:#D19A66"> class</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP"</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">                &lt;</span><span style="color:#E06C75">maxFileSize</span><span style="color:#ABB2BF">&gt;100MB&lt;/</span><span style="color:#E06C75">maxFileSize</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">            &lt;/</span><span style="color:#E06C75">timeBasedFileNamingAndTriggeringPolicy</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">            &lt;!--æ—¥å¿—æ–‡ä»¶ä¿ç•™å¤©æ•°--&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">            &lt;</span><span style="color:#E06C75">maxHistory</span><span style="color:#ABB2BF">&gt;15&lt;/</span><span style="color:#E06C75">maxHistory</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">        &lt;/</span><span style="color:#E06C75">rollingPolicy</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">        &lt;!-- æ­¤æ—¥å¿—æ–‡ä»¶åªè®°å½•infoçº§åˆ«çš„ --&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">        &lt;</span><span style="color:#E06C75">filter</span><span style="color:#D19A66"> class</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"ch.qos.logback.classic.filter.LevelFilter"</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">            &lt;</span><span style="color:#E06C75">level</span><span style="color:#ABB2BF">&gt;INFO&lt;/</span><span style="color:#E06C75">level</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">            &lt;</span><span style="color:#E06C75">onMatch</span><span style="color:#ABB2BF">&gt;ACCEPT&lt;/</span><span style="color:#E06C75">onMatch</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">            &lt;</span><span style="color:#E06C75">onMismatch</span><span style="color:#ABB2BF">&gt;DENY&lt;/</span><span style="color:#E06C75">onMismatch</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">        &lt;/</span><span style="color:#E06C75">filter</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">    &lt;/</span><span style="color:#E06C75">appender</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    &lt;!-- æ—¶é—´æ»šåŠ¨è¾“å‡º levelä¸º WARN æ—¥å¿— --&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">    &lt;</span><span style="color:#E06C75">appender</span><span style="color:#D19A66"> name</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"WARN_FILE"</span><span style="color:#D19A66"> class</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"ch.qos.logback.core.rolling.RollingFileAppender"</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">        &lt;!-- æ­£åœ¨è®°å½•çš„æ—¥å¿—æ–‡ä»¶çš„è·¯å¾„åŠæ–‡ä»¶å --&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">        &lt;</span><span style="color:#E06C75">file</span><span style="color:#ABB2BF">&gt;${log.path}/log_warn.log&lt;/</span><span style="color:#E06C75">file</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">        &lt;!--æ—¥å¿—æ–‡ä»¶è¾“å‡ºæ ¼å¼--&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">        &lt;</span><span style="color:#E06C75">encoder</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">            &lt;</span><span style="color:#E06C75">pattern</span><span style="color:#ABB2BF">&gt;%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{50} - %msg%n&lt;/</span><span style="color:#E06C75">pattern</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">            &lt;</span><span style="color:#E06C75">charset</span><span style="color:#ABB2BF">&gt;UTF-8&lt;/</span><span style="color:#E06C75">charset</span><span style="color:#ABB2BF">&gt; </span><span style="color:#7F848E;font-style:italic">&lt;!-- æ­¤å¤„è®¾ç½®å­—ç¬¦é›† --&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">        &lt;/</span><span style="color:#E06C75">encoder</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">        &lt;!-- æ—¥å¿—è®°å½•å™¨çš„æ»šåŠ¨ç­–ç•¥ï¼ŒæŒ‰æ—¥æœŸï¼ŒæŒ‰å¤§å°è®°å½• --&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">        &lt;</span><span style="color:#E06C75">rollingPolicy</span><span style="color:#D19A66"> class</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"ch.qos.logback.core.rolling.TimeBasedRollingPolicy"</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">            &lt;</span><span style="color:#E06C75">fileNamePattern</span><span style="color:#ABB2BF">&gt;${log.path}/warn/log-warn-%d{yyyy-MM-dd}.%i.log&lt;/</span><span style="color:#E06C75">fileNamePattern</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">            &lt;</span><span style="color:#E06C75">timeBasedFileNamingAndTriggeringPolicy</span><span style="color:#D19A66"> class</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP"</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">                &lt;</span><span style="color:#E06C75">maxFileSize</span><span style="color:#ABB2BF">&gt;100MB&lt;/</span><span style="color:#E06C75">maxFileSize</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">            &lt;/</span><span style="color:#E06C75">timeBasedFileNamingAndTriggeringPolicy</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">            &lt;!--æ—¥å¿—æ–‡ä»¶ä¿ç•™å¤©æ•°--&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">            &lt;</span><span style="color:#E06C75">maxHistory</span><span style="color:#ABB2BF">&gt;15&lt;/</span><span style="color:#E06C75">maxHistory</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">        &lt;/</span><span style="color:#E06C75">rollingPolicy</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">        &lt;!-- æ­¤æ—¥å¿—æ–‡ä»¶åªè®°å½•warnçº§åˆ«çš„ --&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">        &lt;</span><span style="color:#E06C75">filter</span><span style="color:#D19A66"> class</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"ch.qos.logback.classic.filter.LevelFilter"</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">            &lt;</span><span style="color:#E06C75">level</span><span style="color:#ABB2BF">&gt;warn&lt;/</span><span style="color:#E06C75">level</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">            &lt;</span><span style="color:#E06C75">onMatch</span><span style="color:#ABB2BF">&gt;ACCEPT&lt;/</span><span style="color:#E06C75">onMatch</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">            &lt;</span><span style="color:#E06C75">onMismatch</span><span style="color:#ABB2BF">&gt;DENY&lt;/</span><span style="color:#E06C75">onMismatch</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">        &lt;/</span><span style="color:#E06C75">filter</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">    &lt;/</span><span style="color:#E06C75">appender</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    &lt;!-- æ—¶é—´æ»šåŠ¨è¾“å‡º levelä¸º ERROR æ—¥å¿— --&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">    &lt;</span><span style="color:#E06C75">appender</span><span style="color:#D19A66"> name</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"ERROR_FILE"</span><span style="color:#D19A66"> class</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"ch.qos.logback.core.rolling.RollingFileAppender"</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">        &lt;!-- æ­£åœ¨è®°å½•çš„æ—¥å¿—æ–‡ä»¶çš„è·¯å¾„åŠæ–‡ä»¶å --&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">        &lt;</span><span style="color:#E06C75">file</span><span style="color:#ABB2BF">&gt;${log.path}/log_error.log&lt;/</span><span style="color:#E06C75">file</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">        &lt;!--æ—¥å¿—æ–‡ä»¶è¾“å‡ºæ ¼å¼--&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">        &lt;</span><span style="color:#E06C75">encoder</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">            &lt;</span><span style="color:#E06C75">pattern</span><span style="color:#ABB2BF">&gt;%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{50} - %msg%n&lt;/</span><span style="color:#E06C75">pattern</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">            &lt;</span><span style="color:#E06C75">charset</span><span style="color:#ABB2BF">&gt;UTF-8&lt;/</span><span style="color:#E06C75">charset</span><span style="color:#ABB2BF">&gt; </span><span style="color:#7F848E;font-style:italic">&lt;!-- æ­¤å¤„è®¾ç½®å­—ç¬¦é›† --&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">        &lt;/</span><span style="color:#E06C75">encoder</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">        &lt;!-- æ—¥å¿—è®°å½•å™¨çš„æ»šåŠ¨ç­–ç•¥ï¼ŒæŒ‰æ—¥æœŸï¼ŒæŒ‰å¤§å°è®°å½• --&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">        &lt;</span><span style="color:#E06C75">rollingPolicy</span><span style="color:#D19A66"> class</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"ch.qos.logback.core.rolling.TimeBasedRollingPolicy"</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">            &lt;</span><span style="color:#E06C75">fileNamePattern</span><span style="color:#ABB2BF">&gt;${log.path}/error/log-error-%d{yyyy-MM-dd}.%i.log&lt;/</span><span style="color:#E06C75">fileNamePattern</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">            &lt;</span><span style="color:#E06C75">timeBasedFileNamingAndTriggeringPolicy</span><span style="color:#D19A66"> class</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP"</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">                &lt;</span><span style="color:#E06C75">maxFileSize</span><span style="color:#ABB2BF">&gt;100MB&lt;/</span><span style="color:#E06C75">maxFileSize</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">            &lt;/</span><span style="color:#E06C75">timeBasedFileNamingAndTriggeringPolicy</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">            &lt;!--æ—¥å¿—æ–‡ä»¶ä¿ç•™å¤©æ•°--&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">            &lt;</span><span style="color:#E06C75">maxHistory</span><span style="color:#ABB2BF">&gt;15&lt;/</span><span style="color:#E06C75">maxHistory</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">        &lt;/</span><span style="color:#E06C75">rollingPolicy</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">        &lt;!-- æ­¤æ—¥å¿—æ–‡ä»¶åªè®°å½•ERRORçº§åˆ«çš„ --&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">        &lt;</span><span style="color:#E06C75">filter</span><span style="color:#D19A66"> class</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"ch.qos.logback.classic.filter.LevelFilter"</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">            &lt;</span><span style="color:#E06C75">level</span><span style="color:#ABB2BF">&gt;ERROR&lt;/</span><span style="color:#E06C75">level</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">            &lt;</span><span style="color:#E06C75">onMatch</span><span style="color:#ABB2BF">&gt;ACCEPT&lt;/</span><span style="color:#E06C75">onMatch</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">            &lt;</span><span style="color:#E06C75">onMismatch</span><span style="color:#ABB2BF">&gt;DENY&lt;/</span><span style="color:#E06C75">onMismatch</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">        &lt;/</span><span style="color:#E06C75">filter</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">    &lt;/</span><span style="color:#E06C75">appender</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    &lt;!--</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">        &lt;logger&gt;ç”¨æ¥è®¾ç½®æŸä¸€ä¸ªåŒ…æˆ–è€…å…·ä½“çš„æŸä¸€ä¸ªç±»çš„æ—¥å¿—æ‰“å°çº§åˆ«ã€ä»¥åŠæŒ‡å®š&lt;appender&gt;ã€‚</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">        å®ƒå°†ä¼šè¦†ç›–rootçš„è¾“å‡ºçº§åˆ«ã€‚</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">        &lt;logger&gt;ä»…æœ‰ä¸€ä¸ªnameå±æ€§ï¼Œ</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">        ä¸€ä¸ªå¯é€‰çš„levelå’Œä¸€ä¸ªå¯é€‰çš„addtivityå±æ€§ã€‚</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">        name:ç”¨æ¥æŒ‡å®šå—æ­¤loggerçº¦æŸçš„æŸä¸€ä¸ªåŒ…æˆ–è€…å…·ä½“çš„æŸä¸€ä¸ªç±»ã€‚</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">        level:ç”¨æ¥è®¾ç½®æ‰“å°çº§åˆ«ï¼Œå¤§å°å†™æ— å…³ï¼šTRACE, DEBUG, INFO, WARN, ERROR, ALL å’Œ OFFï¼Œ</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">              å¦‚æœæœªè®¾ç½®æ­¤å±æ€§ï¼Œé‚£ä¹ˆå½“å‰loggerå°†ä¼šç»§æ‰¿ä¸Šçº§çš„çº§åˆ«ã€‚</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    --&gt;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    &lt;!--</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">        ä½¿ç”¨mybatisçš„æ—¶å€™ï¼Œsqlè¯­å¥æ˜¯debugä¸‹æ‰ä¼šæ‰“å°ï¼Œè€Œè¿™é‡Œæˆ‘ä»¬åªé…ç½®äº†infoï¼Œæ‰€ä»¥æƒ³è¦æŸ¥çœ‹sqlè¯­å¥çš„è¯ï¼Œæœ‰ä»¥ä¸‹ä¸¤ç§æ“ä½œï¼š</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">        ç¬¬ä¸€ç§æŠŠ&lt;root level="INFO"&gt;æ”¹æˆ&lt;root level="DEBUG"&gt;è¿™æ ·å°±ä¼šæ‰“å°sqlï¼Œä¸è¿‡è¿™æ ·æ—¥å¿—é‚£è¾¹ä¼šå‡ºç°å¾ˆå¤šå…¶ä»–æ¶ˆæ¯</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">        ç¬¬äºŒç§å°±æ˜¯å•ç‹¬ç»™mapperä¸‹ç›®å½•é…ç½®DEBUGæ¨¡å¼ï¼Œä»£ç å¦‚ä¸‹ï¼Œè¿™æ ·é…ç½®sqlè¯­å¥ä¼šæ‰“å°ï¼Œå…¶ä»–è¿˜æ˜¯æ­£å¸¸DEBUGçº§åˆ«ï¼š</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     --&gt;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    &lt;!--å¼€å‘ç¯å¢ƒ:æ‰“å°æ§åˆ¶å°--&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">    &lt;</span><span style="color:#E06C75">springProfile</span><span style="color:#D19A66"> name</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"dev"</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">        &lt;!--å¯ä»¥è¾“å‡ºé¡¹ç›®ä¸­çš„debugæ—¥å¿—ï¼ŒåŒ…æ‹¬mybatisçš„sqlæ—¥å¿—--&gt;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">        &lt;!--æŒ‡å®š indi.mofan åŒ…ä¸‹çš„æ—¥å¿—è¾“å‡ºçº§åˆ«ä¸º info--&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">        &lt;</span><span style="color:#E06C75">logger</span><span style="color:#D19A66"> name</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"indi.mofan"</span><span style="color:#D19A66"> level</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"INFO"</span><span style="color:#ABB2BF"> /&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">        &lt;!--</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">            rootèŠ‚ç‚¹æ˜¯å¿…é€‰èŠ‚ç‚¹ï¼Œç”¨æ¥æŒ‡å®šæœ€åŸºç¡€çš„æ—¥å¿—è¾“å‡ºçº§åˆ«ï¼Œåªæœ‰ä¸€ä¸ªlevelå±æ€§</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">            level:ç”¨æ¥è®¾ç½®æ‰“å°çº§åˆ«ï¼Œå¤§å°å†™æ— å…³ï¼šTRACE, DEBUG, INFO, WARN, ERROR, ALL å’Œ OFFï¼Œé»˜è®¤æ˜¯DEBUG</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">            å¯ä»¥åŒ…å«é›¶ä¸ªæˆ–å¤šä¸ªappenderå…ƒç´ ã€‚</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">        --&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">        &lt;</span><span style="color:#E06C75">root</span><span style="color:#D19A66"> level</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"INFO"</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">            &lt;</span><span style="color:#E06C75">appender-ref</span><span style="color:#D19A66"> ref</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"CONSOLE"</span><span style="color:#ABB2BF"> /&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">            &lt;</span><span style="color:#E06C75">appender-ref</span><span style="color:#D19A66"> ref</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"INFO_FILE"</span><span style="color:#ABB2BF"> /&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">            &lt;</span><span style="color:#E06C75">appender-ref</span><span style="color:#D19A66"> ref</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"WARN_FILE"</span><span style="color:#ABB2BF"> /&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">            &lt;</span><span style="color:#E06C75">appender-ref</span><span style="color:#D19A66"> ref</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"ERROR_FILE"</span><span style="color:#ABB2BF"> /&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">        &lt;/</span><span style="color:#E06C75">root</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">    &lt;/</span><span style="color:#E06C75">springProfile</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    &lt;!--ç”Ÿäº§ç¯å¢ƒ:è¾“å‡ºåˆ°æ–‡ä»¶--&gt;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">&lt;!--    &lt;springProfile name="pro"&gt;--&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">&lt;!--        &amp;lt;!&amp;ndash;å¯ä»¥è¾“å‡ºé¡¹ç›®ä¸­çš„debugæ—¥å¿—ï¼ŒåŒ…æ‹¬mybatisçš„sqlæ—¥å¿—&amp;ndash;&amp;gt;--&gt;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">&lt;!--        &lt;logger name="indi.mofan" level="WARN" /&gt;--&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">&lt;!--        &lt;root level="INFO"&gt;--&gt;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">&lt;!--            &lt;appender-ref ref="ERROR_FILE" /&gt;--&gt;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">&lt;!--            &lt;appender-ref ref="WARN_FILE" /&gt;--&gt;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">&lt;!--        &lt;/root&gt;--&gt;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">&lt;!--    &lt;/springProfile&gt;--&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">&lt;/</span><span style="color:#E06C75">configuration</span><span style="color:#ABB2BF">&gt;</span></span></code></pre></td></tr></tbody></table>
      </figure>
<p>å¦‚æœéœ€è¦ä½¿ç”¨ä¸Šè¿°æ—¥å¿—é…ç½®ï¼Œéœ€è¦ä¿®æ”¹çš„åœ°æ–¹æœ‰ï¼š</p>
<p>1ã€æ—¥å¿—çš„å­˜æ”¾åœ°å€ï¼š</p>
<figure class="highlight xml line-numbers" data-language="XML">
        <table style="background-color: #282c34"><tbody><tr><td class="gutter" style="background-color: #282c34"><pre style="background-color: #282c34"><span class="line">1</span><br></pre></td><td class="code" style="background-color: #282c34"><pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF">&lt;</span><span style="color:#E06C75">property</span><span style="color:#D19A66"> name</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"log.path"</span><span style="color:#D19A66"> value</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"../logs"</span><span style="color:#ABB2BF"> /&gt;</span></span></code></pre></td></tr></tbody></table>
      </figure>
<p>2ã€æŒ‡å®šè‡ªå·±é¡¹ç›®çš„åŒ…è·¯å¾„ï¼š</p>
<figure class="highlight xml line-numbers" data-language="XML">
        <table style="background-color: #282c34"><tbody><tr><td class="gutter" style="background-color: #282c34"><pre style="background-color: #282c34"><span class="line">1</span><br></pre></td><td class="code" style="background-color: #282c34"><pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF">&lt;</span><span style="color:#E06C75">logger</span><span style="color:#D19A66"> name</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"indi.mofan"</span><span style="color:#D19A66"> level</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"INFO"</span><span style="color:#ABB2BF"> /&gt;</span></span></code></pre></td></tr></tbody></table>
      </figure>
<p>å®Œæˆä»¥ä¸Šæ­¥éª¤åï¼Œæˆ‘ä»¬å°±å¯ä»¥æ„‰å¿«åœ°ä½¿ç”¨ Lombok æä¾›çš„ <code>@Slf4j</code> æ³¨è§£è¾“å‡ºæ—¥å¿—äº†ã€‚ ğŸ‰</p>
<h1 id="5-åç«¯-åˆ‡é¢"><a class="header-anchor" href="#5-åç«¯-åˆ‡é¢"></a>5. åç«¯ - åˆ‡é¢</h1>
<p>æ—¥å¿—é™¤äº†è¾“å‡ºåˆ°æ—¥å¿—æ–‡ä»¶ä¸­ä¹‹å¤–ï¼Œä¹Ÿå¯ä»¥ä¿å­˜åˆ°æ•°æ®åº“ã€‚</p>
<p>é’ˆå¯¹å°†æ—¥å¿—ä¿å­˜åˆ°æ•°æ®åº“è¿™ä¸ªéœ€æ±‚ï¼Œå¯ä»¥ä½¿ç”¨ <strong>åˆ‡é¢</strong> æ¥è§£å†³ã€‚</p>
<p>å¯¼å…¥ä¾èµ–ï¼š</p>
<figure class="highlight xml line-numbers" data-language="XML">
        <table style="background-color: #282c34"><tbody><tr><td class="gutter" style="background-color: #282c34"><pre style="background-color: #282c34"><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code" style="background-color: #282c34"><pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic">&lt;!--    åˆ‡é¢ æ—¥å¿—ä½¿ç”¨    --&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">&lt;</span><span style="color:#E06C75">dependency</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">    &lt;</span><span style="color:#E06C75">groupId</span><span style="color:#ABB2BF">&gt;org.aspectj&lt;/</span><span style="color:#E06C75">groupId</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">    &lt;</span><span style="color:#E06C75">artifactId</span><span style="color:#ABB2BF">&gt;aspectjweaver&lt;/</span><span style="color:#E06C75">artifactId</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">    &lt;</span><span style="color:#E06C75">version</span><span style="color:#ABB2BF">&gt;1.9.6&lt;/</span><span style="color:#E06C75">version</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">&lt;/</span><span style="color:#E06C75">dependency</span><span style="color:#ABB2BF">&gt;</span></span></code></pre></td></tr></tbody></table>
      </figure>
<p>ç¼–å†™æ—¥å¿—åˆ‡é¢æœåŠ¡ï¼š</p>
<figure class="highlight java line-numbers" data-language="JAVA">
        <table style="background-color: #282c34"><tbody><tr><td class="gutter" style="background-color: #282c34"><pre style="background-color: #282c34"><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code" style="background-color: #282c34"><pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF">@</span><span style="color:#E5C07B">Aspect</span></span>
<span class="line"><span style="color:#ABB2BF">@</span><span style="color:#E5C07B">Slf4j</span></span>
<span class="line"><span style="color:#ABB2BF">@</span><span style="color:#E5C07B">Component</span></span>
<span class="line"><span style="color:#C678DD">public</span><span style="color:#C678DD"> class</span><span style="color:#E5C07B"> LogAspect</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF">    @</span><span style="color:#E5C07B">Autowired</span></span>
<span class="line"><span style="color:#C678DD">    private</span><span style="color:#E5C07B"> LogService</span><span style="color:#E06C75"> logService</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#ABB2BF">    @</span><span style="color:#E5C07B">Autowired</span></span>
<span class="line"><span style="color:#C678DD">    private</span><span style="color:#E5C07B"> CurrentUser</span><span style="color:#E06C75"> currentUser</span><span style="color:#ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * é…ç½®åˆ‡å…¥ç‚¹</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * ..è¡¨ç¤ºåŒ…åŠå­åŒ… è¯¥æ–¹æ³•ä»£è¡¨ controller å±‚çš„æ‰€æœ‰æ–¹æ³•</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     */</span></span>
<span class="line"><span style="color:#ABB2BF">    @</span><span style="color:#E5C07B">Pointcut</span><span style="color:#E06C75">(</span><span style="color:#98C379">"execution(public * indi.mofan.controller..*.*(..))"</span><span style="color:#E06C75">)</span></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#C678DD"> void</span><span style="color:#61AFEF"> controllerMethod</span><span style="color:#ABB2BF">()</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * æ–¹æ³•æ‰§è¡Œå</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     *</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * </span><span style="color:#C678DD;font-style:italic">@param</span><span style="color:#E06C75;font-style:italic"> object</span><span style="color:#7F848E;font-style:italic"> æ–¹æ³•è¿”å›ç»“æœé›†</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     */</span></span>
<span class="line"><span style="color:#ABB2BF">    @</span><span style="color:#E5C07B">SuppressWarnings</span><span style="color:#E06C75">(</span><span style="color:#98C379">"unchecked"</span><span style="color:#E06C75">)</span></span>
<span class="line"><span style="color:#ABB2BF">    @</span><span style="color:#E5C07B">AfterReturning</span><span style="color:#E06C75">(</span><span style="color:#D19A66">returning</span><span style="color:#56B6C2"> =</span><span style="color:#98C379"> "object"</span><span style="color:#ABB2BF">,</span><span style="color:#D19A66"> pointcut</span><span style="color:#56B6C2"> =</span><span style="color:#98C379"> "controllerMethod()"</span><span style="color:#E06C75">)</span></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#C678DD"> void</span><span style="color:#61AFEF"> logResultInfo</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">Object</span><span style="color:#E06C75;font-style:italic"> object</span><span style="color:#ABB2BF">)</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#E5C07B">        Result</span><span style="color:#ABB2BF">&lt;</span><span style="color:#E5C07B">Object</span><span style="color:#ABB2BF">&gt; </span><span style="color:#E06C75">result</span><span style="color:#56B6C2"> =</span><span style="color:#ABB2BF"> (</span><span style="color:#E5C07B">Result</span><span style="color:#56B6C2">&lt;</span><span style="color:#ABB2BF">Object</span><span style="color:#56B6C2">&gt;</span><span style="color:#ABB2BF">) object;</span></span>
<span class="line"><span style="color:#C678DD">        if</span><span style="color:#ABB2BF"> (</span><span style="color:#E5C07B">result</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">isLog</span><span style="color:#ABB2BF">() </span><span style="color:#56B6C2">&amp;&amp;</span><span style="color:#E5C07B"> Result</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">SUCCESS_CODE</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">equals</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">result</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getCode</span><span style="color:#ABB2BF">())) {</span></span>
<span class="line"><span style="color:#E5C07B">            UserInfo</span><span style="color:#E06C75"> currentUser</span><span style="color:#56B6C2"> =</span><span style="color:#E5C07B"> this</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">currentUser</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getCurrentUser</span><span style="color:#ABB2BF">();</span></span>
<span class="line"><span style="color:#E5C07B">            LogInfoDefinitionDto</span><span style="color:#E06C75"> dto</span><span style="color:#56B6C2"> =</span><span style="color:#C678DD"> new</span><span style="color:#61AFEF"> LogInfoDefinitionDto</span><span style="color:#ABB2BF">();</span></span>
<span class="line"><span style="color:#E5C07B">            dto</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">setUserAccount</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">currentUser</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getUserAccount</span><span style="color:#ABB2BF">());</span></span>
<span class="line"><span style="color:#E5C07B">            dto</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">setUserType</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">currentUser</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getUserType</span><span style="color:#ABB2BF">().</span><span style="color:#61AFEF">code</span><span style="color:#ABB2BF">());</span></span>
<span class="line"><span style="color:#E5C07B">            dto</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">setAction</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">result</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getMsg</span><span style="color:#ABB2BF">());</span></span>
<span class="line"><span style="color:#E5C07B">            logService</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">createOneLog</span><span style="color:#ABB2BF">(dto);</span></span>
<span class="line"><span style="color:#E5C07B">            log</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">info</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">"ç”¨æˆ·ç±»å‹ï¼š{} - æ‰§è¡Œè´¦å·ï¼š{} - æ‰€åšæ“ä½œï¼š{}"</span><span style="color:#ABB2BF">, </span><span style="color:#E5C07B">dto</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getUserType</span><span style="color:#ABB2BF">(), </span><span style="color:#E5C07B">dto</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getUserAccount</span><span style="color:#ABB2BF">(), </span><span style="color:#E5C07B">dto</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getAction</span><span style="color:#ABB2BF">());</span></span>
<span class="line"><span style="color:#ABB2BF">        }</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF">}</span></span></code></pre></td></tr></tbody></table>
      </figure>
<p>é€šè¿‡ä¸Šè¿°ä»£ç å¯ä»¥çœ‹åˆ°ï¼Œåœ¨æ–¹æ³•æ‰§è¡Œåæ‰æ‰§è¡Œé…ç½®çš„åˆ‡é¢ï¼Œç”±äºç»Ÿä¸€äº†è¿”å›å€¼ï¼ˆå‚çœ‹ ã€1.3 ç»Ÿä¸€è¿”å›å€¼ã€‘ï¼‰ï¼Œé…ç½®èµ·æ¥ä¹Ÿå˜å¾—ç®€å•ã€‚</p>
<h1 id="6-åç«¯-é…ç½®æ–‡ä»¶åŠ å¯†"><a class="header-anchor" href="#6-åç«¯-é…ç½®æ–‡ä»¶åŠ å¯†"></a>6. åç«¯ - é…ç½®æ–‡ä»¶åŠ å¯†</h1>
<p>åœ¨åç«¯çš„é…ç½®æ–‡ä»¶ä¸­å¾€å¾€æœ‰å¾ˆå¤šæ•æ„Ÿä¿¡æ¯ï¼Œæ¯”å¦‚å„ç§æ•°æ®åº“å¯†ç ã€å„ç§å¯†é’¥ç­‰ï¼Œå¦‚æœå°†è¿™äº›ä¿¡æ¯è¿›è¡Œæ˜æ–‡æ˜¾ç¤ºï¼Œå°±æœ‰å¯èƒ½è®©ä¸æ³•åˆ†å­æœ‰å¯ä¹˜ä¹‹æœºã€‚</p>
<p>å› æ­¤ï¼Œæœ€å¥½èƒ½å¯¹è¿™äº›ä¿¡æ¯è¿›è¡ŒåŠ å¯†ã€‚</p>
<p>å¯¼å…¥ä¾èµ–ï¼š</p>
<figure class="highlight xml line-numbers" data-language="XML">
        <table style="background-color: #282c34"><tbody><tr><td class="gutter" style="background-color: #282c34"><pre style="background-color: #282c34"><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code" style="background-color: #282c34"><pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF">&lt;</span><span style="color:#E06C75">dependency</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">    &lt;</span><span style="color:#E06C75">groupId</span><span style="color:#ABB2BF">&gt;com.github.ulisesbocchio&lt;/</span><span style="color:#E06C75">groupId</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">    &lt;</span><span style="color:#E06C75">artifactId</span><span style="color:#ABB2BF">&gt;jasypt-spring-boot-starter&lt;/</span><span style="color:#E06C75">artifactId</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">    &lt;</span><span style="color:#E06C75">version</span><span style="color:#ABB2BF">&gt;3.0.3&lt;/</span><span style="color:#E06C75">version</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">&lt;/</span><span style="color:#E06C75">dependency</span><span style="color:#ABB2BF">&gt;</span></span></code></pre></td></tr></tbody></table>
      </figure>
<p>é…ç½®æ–‡ä»¶ä¸­å¢åŠ é…ç½®ï¼š</p>
<figure class="highlight yaml line-numbers" data-language="YAML">
        <table style="background-color: #282c34"><tbody><tr><td class="gutter" style="background-color: #282c34"><pre style="background-color: #282c34"><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code" style="background-color: #282c34"><pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#E06C75">jasypt</span><span style="color:#ABB2BF">:</span></span>
<span class="line"><span style="color:#E06C75">  encryptor</span><span style="color:#ABB2BF">:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">      # privateKey</span></span>
<span class="line"><span style="color:#E06C75">    password</span><span style="color:#ABB2BF">: </span><span style="color:#D19A66">12345</span></span></code></pre></td></tr></tbody></table>
      </figure>
<p>ç„¶åç¼–å†™ä¸€ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼š</p>
<figure class="highlight java line-numbers" data-language="JAVA">
        <table style="background-color: #282c34"><tbody><tr><td class="gutter" style="background-color: #282c34"><pre style="background-color: #282c34"><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code" style="background-color: #282c34"><pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic">/**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * </span><span style="color:#C678DD;font-style:italic">@author</span><span style="color:#7F848E;font-style:italic"> mofan</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * @date 2021/4/23 15:40</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> */</span></span>
<span class="line"><span style="color:#ABB2BF">@</span><span style="color:#E5C07B">SpringBootTest</span></span>
<span class="line"><span style="color:#C678DD">public</span><span style="color:#C678DD"> class</span><span style="color:#E5C07B"> JasyptEncryptorTest</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#ABB2BF">    @</span><span style="color:#E5C07B">Autowired</span></span>
<span class="line"><span style="color:#C678DD">    private</span><span style="color:#E5C07B"> StringEncryptor</span><span style="color:#E06C75"> encryptor</span><span style="color:#ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF">    @</span><span style="color:#E5C07B">Test</span></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#C678DD"> void</span><span style="color:#61AFEF"> testEncrypt</span><span style="color:#ABB2BF">()</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#C678DD">        final</span><span style="color:#E5C07B"> String</span><span style="color:#E06C75"> originPwd</span><span style="color:#56B6C2"> =</span><span style="color:#98C379"> "123456"</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#E5C07B">        String</span><span style="color:#E06C75"> encryptedPwd</span><span style="color:#56B6C2"> =</span><span style="color:#E5C07B"> encryptor</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">encrypt</span><span style="color:#ABB2BF">(originPwd);</span></span>
<span class="line"><span style="color:#E5C07B">        Assertions</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">assertEquals</span><span style="color:#ABB2BF">(originPwd, </span><span style="color:#E5C07B">encryptor</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">decrypt</span><span style="color:#ABB2BF">(encryptedPwd));</span></span>
<span class="line"><span style="color:#E5C07B">        System</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">out</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">println</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">"æœªåŠ å¯†æ•°æ®ï¼š"</span><span style="color:#56B6C2"> +</span><span style="color:#ABB2BF"> originPwd);</span></span>
<span class="line"><span style="color:#E5C07B">        System</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">out</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">println</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">"åŠ å¯†åçš„æ•°æ®ï¼š"</span><span style="color:#56B6C2"> +</span><span style="color:#ABB2BF"> encryptedPwd);</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF">}</span></span></code></pre></td></tr></tbody></table>
      </figure>
<p>è¿è¡Œåï¼Œæµ‹è¯•é€šè¿‡ï¼Œæ§åˆ¶å°æ‰“å°å‡ºï¼š</p>
<pre>æœªåŠ å¯†æ•°æ®ï¼š123456
åŠ å¯†åçš„æ•°æ®ï¼šecqo2ZfOXI3OMMYqNHTePr/uyZHhCyKNFUU4xXjXkoUPpcNDeuZAdX7jhYIQQYWd
</pre>
<p>ä¸Šè¿°ä»£ç æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿ</p>
<p>å°±æ˜¯ä½¿ç”¨å¯†é’¥ 12345ï¼ˆprivateKeyï¼‰å¯¹åŸå§‹å¯†ç  123456ï¼ˆoriginPwdï¼‰è¿›è¡ŒåŠ å¯†ï¼Œæœ€ç»ˆæ‰“å°å‡ºåŠ å¯†å‰å’ŒåŠ å¯†åçš„æ•°æ®ï¼Œå› æ­¤å¯†é’¥æ˜¯ç»ä¸èƒ½æš´éœ²çš„ï¼Œ<mark>åœ¨å®é™…ä½¿ç”¨æ—¶ï¼Œä¸èƒ½ç›´æ¥å°†æ˜æ–‡å¯†é’¥å¡«å†™åœ¨é…ç½®æ–‡ä»¶ä¸­</mark>ã€‚</p>
<p>é‚£ä¹ˆé—®é¢˜åˆæ¥äº†ï¼Œæ€ä¹ˆä½¿ç”¨åŠ å¯†åçš„æ•°æ®å‘¢ï¼Ÿ</p>
<p>åªéœ€è¦å°†é…ç½®æ–‡ä»¶ä¸­éœ€è¦è¿›è¡ŒåŠ å¯†çš„æ•°æ®æ›¿æ¢åå³å¯ï¼Œä½†æ˜¯éœ€è¦åŠ ä¸Š <strong>åŠ å¯†å‰åç¼€</strong>ã€‚</p>
<p>æ¯”å¦‚ï¼š</p>
<figure class="highlight yaml line-numbers" data-language="YAML">
        <table style="background-color: #282c34"><tbody><tr><td class="gutter" style="background-color: #282c34"><pre style="background-color: #282c34"><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code" style="background-color: #282c34"><pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#E06C75">datasource</span><span style="color:#ABB2BF">:</span></span>
<span class="line"><span style="color:#E06C75">  username</span><span style="color:#ABB2BF">: </span><span style="color:#98C379">root</span></span>
<span class="line"><span style="color:#E06C75">  password</span><span style="color:#ABB2BF">: </span><span style="color:#98C379">ENC(ecqo2ZfOXI3OMMYqNHTePr/uyZHhCyKNFUU4xXjXkoUPpcNDeuZAdX7jhYIQQYWd)</span></span></code></pre></td></tr></tbody></table>
      </figure>
<p>æ›¿æ¢å¹¶ç§»é™¤é…ç½®æ–‡ä»¶ä¸­çš„æ˜æ–‡å¯†é’¥åè‚¯å®šæ˜¯æ— æ³•å¯åŠ¨é¡¹ç›®çš„ï¼Œå› ä¸ºå¹¶æ²¡æœ‰å‘ŠçŸ¥ç¨‹åºæ‰€ä½¿ç”¨çš„å¯†é’¥ã€‚é‚£æ€ä¹ˆæï¼Ÿ</p>
<p>æ–¹å¼æœ‰ä¸‰ï¼š</p>
<p>1ã€å°†å¯†é’¥ç›´æ¥ä½œä¸ºç¨‹åºå¯åŠ¨æ—¶çš„ <strong>å‘½ä»¤è¡Œå‚æ•°</strong>ï¼š</p>
<pre>java -jar yourprojectname.jar --jasypt.encryptor.password=12345
</pre>
<p>2ã€å°†å¯†é’¥ä½œä¸ºç¨‹åºå¯åŠ¨æ—¶çš„ <strong>åº”ç”¨ç¯å¢ƒå˜é‡</strong>ï¼š</p>
<pre>java -Djasypt.encryptor.password=12345 -jar yourprojectname.jar
</pre>
<p>3ã€å°†å¯†é’¥é…ç½®ä¸º <strong>ç³»ç»Ÿçš„ç¯å¢ƒå˜é‡</strong>ï¼š</p>
<p>æ¯”å¦‚æˆ‘ä»¬æå‰è®¾ç½®ç³»ç»Ÿç¯å¢ƒå˜é‡ï¼šJASYPT_ENCRYPTOR_PASSWORD = 12345ï¼Œé‚£ä¹ˆåœ¨ SpringBoot çš„é…ç½®æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹é…ç½®å³å¯ï¼š</p>
<figure class="highlight yaml line-numbers" data-language="YAML">
        <table style="background-color: #282c34"><tbody><tr><td class="gutter" style="background-color: #282c34"><pre style="background-color: #282c34"><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code" style="background-color: #282c34"><pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#E06C75">jasypt</span><span style="color:#ABB2BF">:</span></span>
<span class="line"><span style="color:#E06C75">  encryptor</span><span style="color:#ABB2BF">:</span></span>
<span class="line"><span style="color:#E06C75">    password</span><span style="color:#ABB2BF">: </span><span style="color:#98C379">${JASYPT_ENCRYPTOR_PASSWORD:}</span></span></code></pre></td></tr></tbody></table>
      </figure>
<p>å¦‚æœä½¿ç”¨ IDEA ä½œä¸ºåç«¯å¼€å‘å·¥å…·ï¼Œåªéœ€è¦åœ¨è™šæ‹Ÿæœºå¯åŠ¨å‚æ•°è¿½åŠ ä»¥ä¸‹å†…å®¹å³å¯ï¼š</p>
<pre>-Djasypt.encryptor.password=12345
</pre>
<p>å¦‚ï¼š</p>
<p><img src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/loading.gif" data-lazy-src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/SummaryImages/%E6%B7%BB%E5%8A%A0%E5%AF%86%E9%92%A5%E5%88%B0%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%90%AF%E5%8A%A8%E5%8F%82%E6%95%B0.png" alt="æ·»åŠ å¯†é’¥åˆ°è™šæ‹Ÿæœºå¯åŠ¨å‚æ•°"></p>
<h2 id="6-1-è‡ªå®šä¹‰åŠ å¯†å‰åç¼€"><a class="header-anchor" href="#6-1-è‡ªå®šä¹‰åŠ å¯†å‰åç¼€"></a>6.1 è‡ªå®šä¹‰åŠ å¯†å‰åç¼€</h2>
<p>jasypt é»˜è®¤çš„åŠ å¯†å‰åç¼€æ˜¯ <code>ENC()</code>ï¼Œé‚£ä¹ˆæœ‰æ²¡æœ‰ä»€ä¹ˆåŠæ³•å¯ä»¥è‡ªå®šä¹‰å‘¢ï¼Ÿæ¯”å¦‚æ”¹æˆ <code>MOFAN()</code>ã€‚</p>
<p>åªéœ€è¦åœ¨é…ç½®æ–‡ä»¶è¿½åŠ ä»¥ä¸‹å†…å®¹å³å¯ï¼š</p>
<figure class="highlight yaml line-numbers" data-language="YAML">
        <table style="background-color: #282c34"><tbody><tr><td class="gutter" style="background-color: #282c34"><pre style="background-color: #282c34"><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code" style="background-color: #282c34"><pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#E06C75">jasypt</span><span style="color:#ABB2BF">:</span></span>
<span class="line"><span style="color:#E06C75">  encryptor</span><span style="color:#ABB2BF">:</span></span>
<span class="line"><span style="color:#E06C75">    property</span><span style="color:#ABB2BF">:</span></span>
<span class="line"><span style="color:#E06C75">      prefix</span><span style="color:#ABB2BF">: </span><span style="color:#98C379">MOFAN(</span></span>
<span class="line"><span style="color:#E06C75">      suffix</span><span style="color:#ABB2BF">: </span><span style="color:#98C379">)</span></span></code></pre></td></tr></tbody></table>
      </figure>
<h2 id="6-2-æ›´å¤šè‡ªå®šä¹‰"><a class="header-anchor" href="#6-2-æ›´å¤šè‡ªå®šä¹‰"></a>6.2 æ›´å¤šè‡ªå®šä¹‰</h2>
<p>é»˜è®¤æƒ…å†µä¸‹ jasypt é‡‡ç”¨çš„åŠ å¯†ç®—æ³•ä¸º <code>PBEWITHHMACSHA512ANDAES_256</code>ï¼Œè¿™äº›é»˜è®¤ä¿¡æ¯éƒ½åœ¨ <code>JasyptEncryptorConfigurationProperties </code> ç±»ä¸­ï¼Œæˆ‘ä»¬å‰å¾€è¿™ä¸ªç±»æŸ¥çœ‹ï¼š</p>
<img src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/loading.gif" data-lazy-src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/SummaryImages/JasyptEncryptorConfigurationProperties.png" alt="JasyptEncryptorConfigurationProperties" style="zoom:33%;">
<p>å› æ­¤ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦è‡ªå®šä¹‰æ›´å¤šçš„å†…å®¹ï¼Œåªéœ€è¦åœ¨é…ç½®æ–‡ä»¶ä¸­è¿›è¡Œä¿®æ”¹å³å¯ã€‚</p>
<h1 id="7-åç«¯-å·¥å…·ç±»"><a class="header-anchor" href="#7-åç«¯-å·¥å…·ç±»"></a>7. åç«¯ - å·¥å…·ç±»</h1>
<h2 id="7-1-Hutool"><a class="header-anchor" href="#7-1-Hutool"></a>7.1 Hutool</h2>
<p>åœ¨è¯´å·¥å…·ç±»ä¹‹å‰ï¼Œå°±ä¸å¾—ä¸ä»‹ç»ä¸€ä¸ªéå¸¸å¥½ç”¨çš„ Java å·¥å…·åŒ…ç±»åº“ â€”â€” Hutoolï¼Œè¿™ä¸ªç±»åº“æ˜¯ç”±å›½äººå¼€å‘çš„ï¼Œå› æ­¤å‚è€ƒæ–‡æ¡£å’Œ API æ–‡æ¡£éƒ½æ˜¯ä¸­æ–‡çš„ï¼Œååˆ†å‹å¥½ã€‚</p>
<p>ä½ å°±åœ¨æ­¤åœ°ä¸è¦èµ°åŠ¨ï¼Œæˆ‘æŠŠå‚è€ƒæ–‡æ¡£<sup class="footnote-ref"><a href="#fn2" id="fnref2">[2]</a></sup>å’Œ API æ–‡æ¡£<sup class="footnote-ref"><a href="#fn3" id="fnref3">[3]</a></sup>çš„é“¾æ¥éƒ½æ”¾åœ¨è¿™é‡Œã€‚</p>
<p>ä½¿ç”¨ Hutool ä¹Ÿå¾ˆç®€å•ï¼Œåªéœ€è¦å¯¼å…¥ä¾èµ–å°±å¯ä»¥äº†ï¼š</p>
<figure class="highlight xml line-numbers" data-language="XML">
        <table style="background-color: #282c34"><tbody><tr><td class="gutter" style="background-color: #282c34"><pre style="background-color: #282c34"><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code" style="background-color: #282c34"><pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#ABB2BF">&lt;</span><span style="color:#E06C75">dependency</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">    &lt;</span><span style="color:#E06C75">groupId</span><span style="color:#ABB2BF">&gt;cn.hutool&lt;/</span><span style="color:#E06C75">groupId</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">    &lt;</span><span style="color:#E06C75">artifactId</span><span style="color:#ABB2BF">&gt;hutool-all&lt;/</span><span style="color:#E06C75">artifactId</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">    &lt;</span><span style="color:#E06C75">version</span><span style="color:#ABB2BF">&gt;Latest Version&lt;/</span><span style="color:#E06C75">version</span><span style="color:#ABB2BF">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF">&lt;/</span><span style="color:#E06C75">dependency</span><span style="color:#ABB2BF">&gt;</span></span></code></pre></td></tr></tbody></table>
      </figure>
<p>Hutool æ˜¯å¤šæ¨¡å—å¼€å‘çš„ï¼Œå½“ç„¶é™¤äº†ä¸Šè¿°è¿™ç§æ–¹å¼å¤–ï¼Œä¹Ÿå¯ä»¥æŒ‰éœ€å¯¼å…¥è‡ªå·±éœ€è¦çš„æ¨¡å—ã€‚</p>
<p>è‡³äº Hutool çš„ä½¿ç”¨æ–¹å¼å°±æŸ¥é˜…å‚è€ƒæ–‡æ¡£å’Œ API æ–‡æ¡£å§ï¼Œååˆ†è¯¦ç»†ã€‚</p>
<h2 id="7-2-ä½¿ç”¨çš„å·¥å…·ç±»"><a class="header-anchor" href="#7-2-ä½¿ç”¨çš„å·¥å…·ç±»"></a>7.2 ä½¿ç”¨çš„å·¥å…·ç±»</h2>
<blockquote>
<p>ObjectUtil</p>
</blockquote>
<p>ObjectUtilï¼šå¯¹è±¡åˆ¤ç©ºã€Map éç©ºè¿‡æ»¤ã€Map key å€¼è½¬æ¢ã€Map value æ•´åˆã€‚</p>
<p>ä¸è¦åæ§½è¿™ä¸ªå‘½åï¼Œæˆ‘è‡ªå·±éƒ½æƒ³åæ§½ï¼Œæˆ–è®¸å« MapUtil æˆ–è€… CollectionUtil ä¼šå¥½ç‚¹ï¼ŸğŸ¤”</p>
<figure class="highlight java line-numbers" data-language="JAVA">
        <table style="background-color: #282c34"><tbody><tr><td class="gutter" style="background-color: #282c34"><pre style="background-color: #282c34"><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code" style="background-color: #282c34"><pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic">/**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * </span><span style="color:#C678DD;font-style:italic">@author</span><span style="color:#7F848E;font-style:italic"> mofan</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * @date 2021/3/12 11:04</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> */</span></span>
<span class="line"><span style="color:#C678DD">public</span><span style="color:#C678DD"> class</span><span style="color:#E5C07B"> ObjectUtil</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * æ£€æŸ¥å¯¹è±¡éç©º, æ£€æŸ¥å­—ç¬¦ä¸²æ˜¯å¦ä¸ºéç©ºå­—ç¬¦ä¸²</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * </span><span style="color:#C678DD;font-style:italic">@param</span><span style="color:#E06C75;font-style:italic"> object</span><span style="color:#7F848E;font-style:italic"> è¢«æ£€æµ‹çš„å¯¹è±¡</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * </span><span style="color:#C678DD;font-style:italic">@return</span><span style="color:#7F848E;font-style:italic"> Boolean</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     */</span></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#C678DD"> static</span><span style="color:#C678DD"> boolean</span><span style="color:#61AFEF"> checkValue</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">Object</span><span style="color:#E06C75;font-style:italic"> object</span><span style="color:#ABB2BF">)</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#C678DD">        if</span><span style="color:#ABB2BF"> (object </span><span style="color:#C678DD">instanceof</span><span style="color:#ABB2BF"> String </span><span style="color:#56B6C2">&amp;&amp;</span><span style="color:#98C379"> ""</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">equals</span><span style="color:#ABB2BF">((((String) object).</span><span style="color:#61AFEF">trim</span><span style="color:#ABB2BF">()))) {</span></span>
<span class="line"><span style="color:#C678DD">            return</span><span style="color:#D19A66"> false</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#ABB2BF">        }</span></span>
<span class="line"><span style="color:#C678DD">        return</span><span style="color:#D19A66"> null</span><span style="color:#56B6C2"> !=</span><span style="color:#ABB2BF"> object;</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * è¿‡æ»¤ Map ä¸­ Value ä¸º null æˆ–ç©ºå­—ç¬¦ä¸²çš„æ•°æ®</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * </span><span style="color:#C678DD;font-style:italic">@param</span><span style="color:#E06C75;font-style:italic"> data</span><span style="color:#7F848E;font-style:italic"> Map é›†åˆ</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * </span><span style="color:#C678DD;font-style:italic">@return</span><span style="color:#7F848E;font-style:italic"> è¿‡æ»¤å¾—åˆ°çš„ Map é›†åˆ</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     */</span></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#C678DD"> static</span><span style="color:#E5C07B"> Map</span><span style="color:#ABB2BF">&lt;</span><span style="color:#E5C07B">String</span><span style="color:#ABB2BF">,</span><span style="color:#E5C07B"> Object</span><span style="color:#ABB2BF">&gt;</span><span style="color:#61AFEF"> filterEmptyStringValue</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">Map</span><span style="color:#ABB2BF">&lt;</span><span style="color:#E5C07B">String</span><span style="color:#ABB2BF">, </span><span style="color:#E5C07B">Object</span><span style="color:#ABB2BF">&gt; </span><span style="color:#E06C75;font-style:italic">data</span><span style="color:#ABB2BF">)</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#C678DD">        return</span><span style="color:#E5C07B"> data</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">entrySet</span><span style="color:#ABB2BF">().</span><span style="color:#61AFEF">stream</span><span style="color:#ABB2BF">()</span></span>
<span class="line"><span style="color:#ABB2BF">                .</span><span style="color:#61AFEF">filter</span><span style="color:#ABB2BF">(entry </span><span style="color:#C678DD">-&gt;</span><span style="color:#61AFEF"> checkValue</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">entry</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getValue</span><span style="color:#ABB2BF">()))</span></span>
<span class="line"><span style="color:#ABB2BF">                .</span><span style="color:#61AFEF">collect</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">Collectors</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">toMap</span><span style="color:#ABB2BF">(</span></span>
<span class="line"><span style="color:#ABB2BF">                        (e) </span><span style="color:#C678DD">-&gt;</span><span style="color:#ABB2BF"> (String) </span><span style="color:#E5C07B">e</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getKey</span><span style="color:#ABB2BF">(),</span></span>
<span class="line"><span style="color:#E5C07B">                        Map</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">Entry</span><span style="color:#C678DD">::</span><span style="color:#ABB2BF">getValue</span></span>
<span class="line"><span style="color:#ABB2BF">                ));</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * å°† Map ä¸­é©¼å³°å‘½åçš„ Key è½¬æ¢ä¸ºä¸‹åˆ’çº¿å‘½å</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * </span><span style="color:#C678DD;font-style:italic">@param</span><span style="color:#E06C75;font-style:italic"> data</span><span style="color:#7F848E;font-style:italic"> Map é›†åˆ</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * </span><span style="color:#C678DD;font-style:italic">@return</span><span style="color:#7F848E;font-style:italic"> è½¬æ¢åå¾—åˆ°çš„ Map é›†åˆ</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     */</span></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#C678DD"> static</span><span style="color:#E5C07B"> Map</span><span style="color:#ABB2BF">&lt;</span><span style="color:#E5C07B">String</span><span style="color:#ABB2BF">,</span><span style="color:#E5C07B"> Object</span><span style="color:#ABB2BF">&gt;</span><span style="color:#61AFEF"> toUnderLineCaseKey</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">Map</span><span style="color:#ABB2BF">&lt;</span><span style="color:#E5C07B">String</span><span style="color:#ABB2BF">, </span><span style="color:#E5C07B">Object</span><span style="color:#ABB2BF">&gt; </span><span style="color:#E06C75;font-style:italic">data</span><span style="color:#ABB2BF">)</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#C678DD">        return</span><span style="color:#E5C07B"> data</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">entrySet</span><span style="color:#ABB2BF">().</span><span style="color:#61AFEF">stream</span><span style="color:#ABB2BF">()</span></span>
<span class="line"><span style="color:#ABB2BF">                .</span><span style="color:#61AFEF">collect</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">Collectors</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">toMap</span><span style="color:#ABB2BF">((e) </span><span style="color:#C678DD">-&gt;</span><span style="color:#E5C07B"> StrUtil</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">toUnderlineCase</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">e</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getKey</span><span style="color:#ABB2BF">()), </span><span style="color:#E5C07B">Map</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">Entry</span><span style="color:#C678DD">::</span><span style="color:#ABB2BF">getValue));</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * å°† Map ä¸­é©¼å³°å‘½åçš„ Key è½¬æ¢ä¸ºä¸‹åˆ’çº¿å‘½åï¼Œå¹¶è¿‡æ»¤ Value</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * </span><span style="color:#C678DD;font-style:italic">@param</span><span style="color:#E06C75;font-style:italic"> data</span><span style="color:#7F848E;font-style:italic"> Map é›†åˆ</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * </span><span style="color:#C678DD;font-style:italic">@return</span><span style="color:#7F848E;font-style:italic"> è½¬æ¢åå¾—åˆ°çš„ Map é›†åˆ</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     */</span></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#C678DD"> static</span><span style="color:#E5C07B"> Map</span><span style="color:#ABB2BF">&lt;</span><span style="color:#E5C07B">String</span><span style="color:#ABB2BF">,</span><span style="color:#E5C07B"> Object</span><span style="color:#ABB2BF">&gt;</span><span style="color:#61AFEF"> toUnderLineCaseKeyAndFilterValue</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">Map</span><span style="color:#ABB2BF">&lt;</span><span style="color:#E5C07B">String</span><span style="color:#ABB2BF">, </span><span style="color:#E5C07B">Object</span><span style="color:#ABB2BF">&gt; </span><span style="color:#E06C75;font-style:italic">data</span><span style="color:#ABB2BF">)</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#C678DD">        return</span><span style="color:#61AFEF"> toUnderLineCaseKey</span><span style="color:#ABB2BF">(</span><span style="color:#61AFEF">filterEmptyStringValue</span><span style="color:#ABB2BF">(data));</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * å°† Map çš„ value å­˜å…¥ List ä¸­å¹¶è¿”å›</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * </span><span style="color:#C678DD;font-style:italic">@param</span><span style="color:#E06C75;font-style:italic"> map</span><span style="color:#7F848E;font-style:italic"> åŸ Map é›†åˆ</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * </span><span style="color:#C678DD;font-style:italic">@return</span><span style="color:#7F848E;font-style:italic"> å¾—åˆ°çš„ List é›†åˆ</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     */</span></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#C678DD"> static</span><span style="color:#ABB2BF"> &lt;</span><span style="color:#E5C07B">K</span><span style="color:#ABB2BF">,</span><span style="color:#E5C07B"> V</span><span style="color:#ABB2BF">&gt;</span><span style="color:#E5C07B"> List</span><span style="color:#ABB2BF">&lt;</span><span style="color:#E5C07B">V</span><span style="color:#ABB2BF">&gt;</span><span style="color:#61AFEF"> getMapValueList</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">Map</span><span style="color:#ABB2BF">&lt;</span><span style="color:#E5C07B">K</span><span style="color:#ABB2BF">, </span><span style="color:#E5C07B">V</span><span style="color:#ABB2BF">&gt; </span><span style="color:#E06C75;font-style:italic">map</span><span style="color:#ABB2BF">)</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#E5C07B">        Collection</span><span style="color:#ABB2BF">&lt;</span><span style="color:#E5C07B">V</span><span style="color:#ABB2BF">&gt; </span><span style="color:#E06C75">values</span><span style="color:#56B6C2"> =</span><span style="color:#E5C07B"> map</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">values</span><span style="color:#ABB2BF">();</span></span>
<span class="line"><span style="color:#C678DD">        return</span><span style="color:#C678DD"> new</span><span style="color:#E5C07B"> ArrayList</span><span style="color:#ABB2BF">&lt;&gt;(values);</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF">}</span></span></code></pre></td></tr></tbody></table>
      </figure>
<blockquote>
<p>NumberUtil</p>
</blockquote>
<p>NumberUtilï¼šdouble è½¬ intã€‚</p>
<figure class="highlight java line-numbers" data-language="JAVA">
        <table style="background-color: #282c34"><tbody><tr><td class="gutter" style="background-color: #282c34"><pre style="background-color: #282c34"><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code" style="background-color: #282c34"><pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic">/**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * </span><span style="color:#C678DD;font-style:italic">@author</span><span style="color:#7F848E;font-style:italic"> mofan</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * @date 2021/5/27 16:52</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> */</span></span>
<span class="line"><span style="color:#C678DD">public</span><span style="color:#C678DD"> class</span><span style="color:#E5C07B"> NumberUtil</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * double è½¬ int</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * </span><span style="color:#C678DD;font-style:italic">@param</span><span style="color:#E06C75;font-style:italic"> d</span><span style="color:#7F848E;font-style:italic"> double ç±»å‹çš„æ•°å€¼</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * </span><span style="color:#C678DD;font-style:italic">@return</span><span style="color:#7F848E;font-style:italic"> è½¬æ¢åå¾—åˆ°çš„ int ç±»å‹æ•°å€¼</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     */</span></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#C678DD"> static</span><span style="color:#C678DD"> int</span><span style="color:#61AFEF"> doubleToInt</span><span style="color:#ABB2BF">(</span><span style="color:#C678DD">double</span><span style="color:#E06C75;font-style:italic"> d</span><span style="color:#ABB2BF">)</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#C678DD">        return</span><span style="color:#E5C07B"> Integer</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">parseInt</span><span style="color:#ABB2BF">(</span><span style="color:#C678DD">new</span><span style="color:#61AFEF"> DecimalFormat</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">"0"</span><span style="color:#ABB2BF">).</span><span style="color:#61AFEF">format</span><span style="color:#ABB2BF">(d));</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF">}</span></span></code></pre></td></tr></tbody></table>
      </figure>
<blockquote>
<p>FileUtil</p>
</blockquote>
<p>FileUtilï¼šåˆ¤æ–­ MultipartFile æ˜¯å¦ä¸º Excelã€åˆ¤æ–­ MultipartFile æ˜¯å¦ä¸º PDFã€‚</p>
<figure class="highlight java line-numbers" data-language="JAVA">
        <table style="background-color: #282c34"><tbody><tr><td class="gutter" style="background-color: #282c34"><pre style="background-color: #282c34"><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code" style="background-color: #282c34"><pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic">/**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * </span><span style="color:#C678DD;font-style:italic">@author</span><span style="color:#7F848E;font-style:italic"> mofan</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * @date 2021/3/15 20:49</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> */</span></span>
<span class="line"><span style="color:#ABB2BF">@</span><span style="color:#E5C07B">Slf4j</span></span>
<span class="line"><span style="color:#C678DD">public</span><span style="color:#C678DD"> class</span><span style="color:#E5C07B"> FileUtil</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#C678DD">    private</span><span style="color:#C678DD"> static</span><span style="color:#C678DD"> final</span><span style="color:#E5C07B"> String</span><span style="color:#E06C75"> FILE_ZIP </span><span style="color:#56B6C2">=</span><span style="color:#98C379"> "zip"</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD">    private</span><span style="color:#C678DD"> static</span><span style="color:#C678DD"> final</span><span style="color:#E5C07B"> String</span><span style="color:#E06C75"> FILE_XLS </span><span style="color:#56B6C2">=</span><span style="color:#98C379"> ".xls"</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD">    private</span><span style="color:#C678DD"> static</span><span style="color:#C678DD"> final</span><span style="color:#E5C07B"> String</span><span style="color:#E06C75"> FILE_XLSX </span><span style="color:#56B6C2">=</span><span style="color:#98C379"> ".xlsx"</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD">    private</span><span style="color:#C678DD"> static</span><span style="color:#C678DD"> final</span><span style="color:#E5C07B"> String</span><span style="color:#E06C75"> FILE_PDF </span><span style="color:#56B6C2">=</span><span style="color:#98C379"> ".pdf"</span><span style="color:#ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * åˆ¤æ–­ä¸Šä¼ çš„æ–‡ä»¶æ˜¯å¦æ˜¯ Excel ç±»å‹çš„</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     *</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * </span><span style="color:#C678DD;font-style:italic">@param</span><span style="color:#E06C75;font-style:italic"> file</span><span style="color:#7F848E;font-style:italic"> MultipartFile å®ä¾‹</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * </span><span style="color:#C678DD;font-style:italic">@return</span><span style="color:#7F848E;font-style:italic"> åˆ¤æ–­ç»“æœ</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     */</span></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#C678DD"> static</span><span style="color:#C678DD"> boolean</span><span style="color:#61AFEF"> isNotExcelFile</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">MultipartFile</span><span style="color:#E06C75;font-style:italic"> file</span><span style="color:#ABB2BF">)</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#C678DD">        if</span><span style="color:#ABB2BF"> (file </span><span style="color:#56B6C2">==</span><span style="color:#D19A66"> null</span><span style="color:#ABB2BF">) {</span></span>
<span class="line"><span style="color:#C678DD">            return</span><span style="color:#D19A66"> true</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#ABB2BF">        }</span></span>
<span class="line"><span style="color:#E5C07B">        String</span><span style="color:#E06C75"> filename</span><span style="color:#56B6C2"> =</span><span style="color:#E5C07B"> file</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getOriginalFilename</span><span style="color:#ABB2BF">();</span></span>
<span class="line"><span style="color:#E5C07B">        String</span><span style="color:#E06C75"> fileType</span><span style="color:#56B6C2"> =</span><span style="color:#D19A66"> null</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD">        if</span><span style="color:#ABB2BF"> (filename </span><span style="color:#56B6C2">!=</span><span style="color:#D19A66"> null</span><span style="color:#ABB2BF">) {</span></span>
<span class="line"><span style="color:#ABB2BF">            fileType </span><span style="color:#56B6C2">=</span><span style="color:#E5C07B"> filename</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">substring</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">filename</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">lastIndexOf</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">"."</span><span style="color:#ABB2BF">));</span></span>
<span class="line"><span style="color:#ABB2BF">        }</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">        // å…ˆåˆ¤æ–­åç¼€å</span></span>
<span class="line"><span style="color:#C678DD">        if</span><span style="color:#ABB2BF"> (</span><span style="color:#E5C07B">FILE_XLS</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">equalsIgnoreCase</span><span style="color:#ABB2BF">(fileType) </span><span style="color:#56B6C2">||</span><span style="color:#E5C07B"> FILE_XLSX</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">equalsIgnoreCase</span><span style="color:#ABB2BF">(fileType)) {</span></span>
<span class="line"><span style="color:#E5C07B">            String</span><span style="color:#E06C75"> type</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD">            try</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#ABB2BF">                type </span><span style="color:#56B6C2">=</span><span style="color:#E5C07B"> FileTypeUtil</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getType</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">file</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getInputStream</span><span style="color:#ABB2BF">());</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">                // æ ¹æ®é¦–éƒ¨å­—èŠ‚åˆ¤æ–­æ–‡ä»¶ç±»å‹</span></span>
<span class="line"><span style="color:#C678DD">                if</span><span style="color:#ABB2BF"> (</span><span style="color:#E5C07B">FILE_ZIP</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">contains</span><span style="color:#ABB2BF">(type) </span><span style="color:#56B6C2">||</span><span style="color:#E5C07B"> FILE_XLS</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">contains</span><span style="color:#ABB2BF">(type)) {</span></span>
<span class="line"><span style="color:#C678DD">                    return</span><span style="color:#D19A66"> false</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#ABB2BF">                }</span></span>
<span class="line"><span style="color:#ABB2BF">            } </span><span style="color:#C678DD">catch</span><span style="color:#ABB2BF"> (</span><span style="color:#E5C07B">Exception</span><span style="color:#E06C75;font-style:italic"> e</span><span style="color:#ABB2BF">) {</span></span>
<span class="line"><span style="color:#C678DD">                return</span><span style="color:#D19A66"> true</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#ABB2BF">            }</span></span>
<span class="line"><span style="color:#ABB2BF">        }</span></span>
<span class="line"><span style="color:#C678DD">        return</span><span style="color:#D19A66"> true</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * åˆ¤æ–­ä¸Šä¼ çš„æ–‡ä»¶æ˜¯å¦æ˜¯ PDF ç±»å‹çš„</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     *</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * </span><span style="color:#C678DD;font-style:italic">@param</span><span style="color:#E06C75;font-style:italic"> file</span><span style="color:#7F848E;font-style:italic"> MultipartFile å®ä¾‹</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * </span><span style="color:#C678DD;font-style:italic">@return</span><span style="color:#7F848E;font-style:italic"> åˆ¤æ–­ç»“æœ</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     */</span></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#C678DD"> static</span><span style="color:#C678DD"> boolean</span><span style="color:#61AFEF"> isNotPdfFile</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">MultipartFile</span><span style="color:#E06C75;font-style:italic"> file</span><span style="color:#ABB2BF">)</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#C678DD">        if</span><span style="color:#ABB2BF"> (file </span><span style="color:#56B6C2">==</span><span style="color:#D19A66"> null</span><span style="color:#ABB2BF">) {</span></span>
<span class="line"><span style="color:#C678DD">            return</span><span style="color:#D19A66"> true</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#ABB2BF">        }</span></span>
<span class="line"><span style="color:#E5C07B">        String</span><span style="color:#E06C75"> filename</span><span style="color:#56B6C2"> =</span><span style="color:#E5C07B"> file</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getOriginalFilename</span><span style="color:#ABB2BF">();</span></span>
<span class="line"><span style="color:#E5C07B">        String</span><span style="color:#E06C75"> fileType</span><span style="color:#56B6C2"> =</span><span style="color:#D19A66"> null</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD">        if</span><span style="color:#ABB2BF"> (filename </span><span style="color:#56B6C2">!=</span><span style="color:#D19A66"> null</span><span style="color:#ABB2BF">) {</span></span>
<span class="line"><span style="color:#ABB2BF">            fileType </span><span style="color:#56B6C2">=</span><span style="color:#E5C07B"> filename</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">substring</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">filename</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">lastIndexOf</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">"."</span><span style="color:#ABB2BF">));</span></span>
<span class="line"><span style="color:#ABB2BF">        }</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">        // å…ˆåˆ¤æ–­åç¼€å</span></span>
<span class="line"><span style="color:#C678DD">        if</span><span style="color:#ABB2BF"> (</span><span style="color:#E5C07B">FILE_PDF</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">equalsIgnoreCase</span><span style="color:#ABB2BF">(fileType)) {</span></span>
<span class="line"><span style="color:#E5C07B">            String</span><span style="color:#E06C75"> type</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD">            try</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#C678DD">                return</span><span style="color:#D19A66"> false</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#ABB2BF">            } </span><span style="color:#C678DD">catch</span><span style="color:#ABB2BF"> (</span><span style="color:#E5C07B">Exception</span><span style="color:#E06C75;font-style:italic"> e</span><span style="color:#ABB2BF">) {</span></span>
<span class="line"><span style="color:#C678DD">                return</span><span style="color:#D19A66"> true</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#ABB2BF">            }</span></span>
<span class="line"><span style="color:#ABB2BF">        }</span></span>
<span class="line"><span style="color:#C678DD">        return</span><span style="color:#D19A66"> true</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF">}</span></span></code></pre></td></tr></tbody></table>
      </figure>
<blockquote>
<p>DateUtil</p>
</blockquote>
<p>DateUtilï¼šä» <code>yyyy-MM-dd HH:mm:ss</code> å­—ç¬¦ä¸²ä¸­è·å–ä¿¡æ¯ã€è·å–å½“å‰å¹´ä»½ã€‚</p>
<figure class="highlight java line-numbers" data-language="JAVA">
        <table style="background-color: #282c34"><tbody><tr><td class="gutter" style="background-color: #282c34"><pre style="background-color: #282c34"><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code" style="background-color: #282c34"><pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic">/**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * </span><span style="color:#C678DD;font-style:italic">@author</span><span style="color:#7F848E;font-style:italic"> mofan</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * @date 2021/4/30 22:16</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> */</span></span>
<span class="line"><span style="color:#C678DD">public</span><span style="color:#C678DD"> class</span><span style="color:#E5C07B"> DateUtil</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * å°† yyyy-MM-dd HH:mm:ss å­—ç¬¦ä¸²æ ¼å¼çš„æ—¶é—´è½¬æ¢ä¸º yyyy-MM-dd HH:mm å­—ç¬¦ä¸²æ ¼å¼</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * </span><span style="color:#C678DD;font-style:italic">@param</span><span style="color:#E06C75;font-style:italic"> date</span><span style="color:#7F848E;font-style:italic"> åŸæ—¶é—´å­—ç¬¦ä¸²</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * </span><span style="color:#C678DD;font-style:italic">@return</span><span style="color:#7F848E;font-style:italic"> yyyy-MM-dd HH:mm å­—ç¬¦ä¸²æ ¼å¼</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     */</span></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#C678DD"> static</span><span style="color:#E5C07B"> String</span><span style="color:#61AFEF"> getHmDateStr</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">String</span><span style="color:#E06C75;font-style:italic"> date</span><span style="color:#ABB2BF">)</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#C678DD">        if</span><span style="color:#ABB2BF"> (date </span><span style="color:#56B6C2">==</span><span style="color:#D19A66"> null</span><span style="color:#56B6C2"> ||</span><span style="color:#98C379"> ""</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">equals</span><span style="color:#ABB2BF">(date)) {</span></span>
<span class="line"><span style="color:#C678DD">            return</span><span style="color:#D19A66"> null</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#ABB2BF">        } </span><span style="color:#C678DD">else</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#C678DD">            int</span><span style="color:#E06C75"> i</span><span style="color:#56B6C2"> =</span><span style="color:#E5C07B"> date</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">lastIndexOf</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">":"</span><span style="color:#ABB2BF">);</span></span>
<span class="line"><span style="color:#C678DD">            return</span><span style="color:#E5C07B"> date</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">substring</span><span style="color:#ABB2BF">(</span><span style="color:#D19A66">0</span><span style="color:#ABB2BF">, i);</span></span>
<span class="line"><span style="color:#ABB2BF">        }</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * è·å– yyyy-MM-dd HH:mm:ss å­—ç¬¦ä¸²æ ¼å¼çš„æ—¶é—´ä¸­çš„å¹´ä»½ä¿¡æ¯</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * </span><span style="color:#C678DD;font-style:italic">@param</span><span style="color:#E06C75;font-style:italic"> date</span><span style="color:#7F848E;font-style:italic"> åŸæ—¶é—´å­—ç¬¦ä¸²</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * </span><span style="color:#C678DD;font-style:italic">@return</span><span style="color:#7F848E;font-style:italic"> å¹´ä»½ä¿¡æ¯</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     */</span></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#C678DD"> static</span><span style="color:#E5C07B"> String</span><span style="color:#61AFEF"> getYear</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">String</span><span style="color:#E06C75;font-style:italic"> date</span><span style="color:#ABB2BF">)</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#C678DD">        if</span><span style="color:#ABB2BF"> (date </span><span style="color:#56B6C2">==</span><span style="color:#D19A66"> null</span><span style="color:#56B6C2"> ||</span><span style="color:#98C379"> ""</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">equals</span><span style="color:#ABB2BF">(date)) {</span></span>
<span class="line"><span style="color:#C678DD">            return</span><span style="color:#D19A66"> null</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#ABB2BF">        } </span><span style="color:#C678DD">else</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#C678DD">            int</span><span style="color:#E06C75"> i</span><span style="color:#56B6C2"> =</span><span style="color:#E5C07B"> date</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">indexOf</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">"-"</span><span style="color:#ABB2BF">);</span></span>
<span class="line"><span style="color:#C678DD">            return</span><span style="color:#E5C07B"> date</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">substring</span><span style="color:#ABB2BF">(</span><span style="color:#D19A66">0</span><span style="color:#ABB2BF">, i);</span></span>
<span class="line"><span style="color:#ABB2BF">        }</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * è·å–å½“å‰å­—ç¬¦ä¸²ç±»å‹çš„å¹´ä»½</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * </span><span style="color:#C678DD;font-style:italic">@return</span><span style="color:#7F848E;font-style:italic"> å­—ç¬¦ä¸²ç±»å‹çš„å¹´ä»½ä¿¡æ¯</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     */</span></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#C678DD"> static</span><span style="color:#E5C07B"> String</span><span style="color:#61AFEF"> getThisYear</span><span style="color:#ABB2BF">()</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#C678DD">        return</span><span style="color:#E5C07B"> String</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">valueOf</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">LocalDate</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">now</span><span style="color:#ABB2BF">().</span><span style="color:#61AFEF">getYear</span><span style="color:#ABB2BF">());</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF">}</span></span></code></pre></td></tr></tbody></table>
      </figure>
<blockquote>
<p>AssertUtil</p>
</blockquote>
<figure class="highlight java line-numbers" data-language="JAVA">
        <table style="background-color: #282c34"><tbody><tr><td class="gutter" style="background-color: #282c34"><pre style="background-color: #282c34"><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code" style="background-color: #282c34"><pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic">/**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * </span><span style="color:#C678DD;font-style:italic">@author</span><span style="color:#7F848E;font-style:italic"> mofan</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * @date 2021/5/6 14:01</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> */</span></span>
<span class="line"><span style="color:#C678DD">public</span><span style="color:#C678DD"> class</span><span style="color:#E5C07B"> AssertUtil</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * æ–­è¨€æŸä¸ªå¯¹è±¡ä¸ä¸º &lt;code&gt;null&lt;/code&gt;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * </span><span style="color:#C678DD;font-style:italic">@param</span><span style="color:#E06C75;font-style:italic"> o</span><span style="color:#7F848E;font-style:italic"> å¯¹è±¡</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * </span><span style="color:#C678DD;font-style:italic">@param</span><span style="color:#E06C75;font-style:italic"> message</span><span style="color:#7F848E;font-style:italic"> é”™è¯¯ä¿¡æ¯</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     */</span></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#C678DD"> static</span><span style="color:#C678DD"> void</span><span style="color:#61AFEF"> dataNotNull</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">Object</span><span style="color:#E06C75;font-style:italic"> o</span><span style="color:#ABB2BF">, </span><span style="color:#E5C07B">String</span><span style="color:#E06C75;font-style:italic"> message</span><span style="color:#ABB2BF">)</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#C678DD">        if</span><span style="color:#ABB2BF"> (o </span><span style="color:#56B6C2">==</span><span style="color:#D19A66"> null</span><span style="color:#ABB2BF">) {</span></span>
<span class="line"><span style="color:#C678DD">            throw</span><span style="color:#C678DD"> new</span><span style="color:#61AFEF"> BusinessException</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">ErrorCode</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">DATA_IS_NULL</span><span style="color:#ABB2BF">).</span><span style="color:#61AFEF">addError</span><span style="color:#ABB2BF">(message);</span></span>
<span class="line"><span style="color:#ABB2BF">        }</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * æ–­è¨€æŠ›å‡ºäº† BusinessException å¼‚å¸¸</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * </span><span style="color:#C678DD;font-style:italic">@param</span><span style="color:#E06C75;font-style:italic"> condition</span><span style="color:#7F848E;font-style:italic"> æ¡ä»¶ä¿¡æ¯</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * </span><span style="color:#C678DD;font-style:italic">@param</span><span style="color:#E06C75;font-style:italic"> code</span><span style="color:#7F848E;font-style:italic"> ErrorCode ä¿¡æ¯</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * </span><span style="color:#C678DD;font-style:italic">@param</span><span style="color:#E06C75;font-style:italic"> msg</span><span style="color:#7F848E;font-style:italic"> é”™è¯¯ä¿¡æ¯</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     */</span></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#C678DD"> static</span><span style="color:#C678DD"> void</span><span style="color:#61AFEF"> throwBusinessException</span><span style="color:#ABB2BF">(</span><span style="color:#C678DD">boolean</span><span style="color:#E06C75;font-style:italic"> condition</span><span style="color:#ABB2BF">, </span><span style="color:#E5C07B">String</span><span style="color:#E06C75;font-style:italic"> code</span><span style="color:#ABB2BF">, </span><span style="color:#E5C07B">String</span><span style="color:#E06C75;font-style:italic"> msg</span><span style="color:#ABB2BF">)</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#C678DD">        if</span><span style="color:#ABB2BF"> (condition) {</span></span>
<span class="line"><span style="color:#C678DD">            throw</span><span style="color:#C678DD"> new</span><span style="color:#61AFEF"> BusinessException</span><span style="color:#ABB2BF">(code).</span><span style="color:#61AFEF">addError</span><span style="color:#ABB2BF">(msg);</span></span>
<span class="line"><span style="color:#ABB2BF">        }</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF">}</span></span></code></pre></td></tr></tbody></table>
      </figure>
<h1 id="8-åç«¯-å…¶ä»–"><a class="header-anchor" href="#8-åç«¯-å…¶ä»–"></a>8. åç«¯ - å…¶ä»–</h1>
<h2 id="8-1-DateTimeFormat-ä¸-JsonFormat-çš„åŒºåˆ«"><a class="header-anchor" href="#8-1-DateTimeFormat-ä¸-JsonFormat-çš„åŒºåˆ«"></a>8.1 <code>@DateTimeFormat</code> ä¸ <code>@JsonFormat</code> çš„åŒºåˆ«</h2>
<p>ä¸€èˆ¬éƒ½æ˜¯ä½¿ç”¨ <code>@DateTimeFormat</code> æŠŠä¼ ç»™åå°çš„æ—¶é—´å­—ç¬¦ä¸²è½¬æˆ <code>Date</code>ï¼Œä½¿ç”¨ <code>@JsonFormat</code> æŠŠåå°ä¼ å‡ºçš„ <code>Date</code> è½¬æˆæ—¶é—´å­—ç¬¦ä¸²ã€‚</p>
<p>ä½†æ˜¯ <code>@DateTimeFormat</code> åªä¼šåœ¨ç±»ä¼¼ <code>@RequestParam</code> çš„è¯·æ±‚å‚æ•°ï¼ˆurlæ‹¼æ¥çš„å‚æ•°æ‰ç”Ÿæ•ˆï¼Œå¦‚æœæ˜¯æ”¾åˆ°RequestBodyä¸­çš„form-dataæ˜¯æ— æ•ˆçš„ï¼‰ä¸Šç”Ÿæ•ˆï¼Œå³ï¼š<code>@DateTimeFormat</code> æ”¾åˆ° <code>@RequestBody</code> ä¸‹æ˜¯æ— æ•ˆçš„ã€‚</p>
<p>åœ¨ <code>@RequestBody</code> ä¸­åˆ™å¯ä»¥ä½¿ç”¨ <code>@JsonFormat</code> æŠŠä¼ ç»™åå°çš„æ—¶é—´å­—ç¬¦ä¸²è½¬æˆDateï¼Œä¹Ÿå°±æ˜¯è¯´ <code>@JsonFormat</code> å…¶å®æ—¢å¯ä»¥æŠŠä¼ ç»™åå°çš„æ—¶é—´å­—ç¬¦ä¸²è½¬æˆDateä¹Ÿå¯ä»¥æŠŠåå°ä¼ å‡ºçš„ <code>Date</code> è½¬æˆæ—¶é—´å­—ç¬¦ä¸²ã€‚</p>
<h2 id="8-2-Excel-çš„å¯¼å‡º"><a class="header-anchor" href="#8-2-Excel-çš„å¯¼å‡º"></a>8.2 Excel çš„å¯¼å‡º</h2>
<p>åœ¨æ­¤ä»¥è”ç³»æ–¹å¼çš„å¯¼å‡ºä¸ºä¾‹ï¼š</p>
<figure class="highlight java line-numbers" data-language="JAVA">
        <table style="background-color: #282c34"><tbody><tr><td class="gutter" style="background-color: #282c34"><pre style="background-color: #282c34"><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code" style="background-color: #282c34"><pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD">public</span><span style="color:#E5C07B"> Result</span><span style="color:#56B6C2">&lt;</span><span style="color:#E06C75">Void</span><span style="color:#56B6C2">&gt;</span><span style="color:#61AFEF"> exportContact</span><span style="color:#E06C75">(</span><span style="color:#E5C07B">HttpServletResponse</span><span style="color:#E06C75"> response) throws IOException {</span></span>
<span class="line"><span style="color:#C678DD">    try</span><span style="color:#E06C75"> {</span></span>
<span class="line"><span style="color:#E5C07B">        response</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">setContentType</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"</span><span style="color:#ABB2BF">);</span></span>
<span class="line"><span style="color:#E5C07B">        response</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">setCharacterEncoding</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">"utf-8"</span><span style="color:#ABB2BF">);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">        // è¿™é‡Œ URLEncoder.encode å¯ä»¥é˜²æ­¢ä¸­æ–‡ä¹±ç </span></span>
<span class="line"><span style="color:#E5C07B">        String</span><span style="color:#E06C75"> fileName </span><span style="color:#56B6C2">=</span><span style="color:#E5C07B"> java</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">net</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">URLEncoder</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">encode</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">"è”ç³»æ–¹å¼"</span><span style="color:#ABB2BF">, </span><span style="color:#98C379">"UTF-8"</span><span style="color:#ABB2BF">)</span></span>
<span class="line"><span style="color:#ABB2BF">                .</span><span style="color:#61AFEF">replaceAll</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">"</span><span style="color:#56B6C2">\\</span><span style="color:#98C379">+"</span><span style="color:#ABB2BF">, </span><span style="color:#98C379">"%20"</span><span style="color:#ABB2BF">);</span></span>
<span class="line"><span style="color:#E5C07B">        response</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">setHeader</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">"Content-Disposition"</span><span style="color:#ABB2BF">, </span><span style="color:#98C379">"attachment;filename*=utf-8''"</span><span style="color:#56B6C2"> +</span><span style="color:#ABB2BF"> fileName </span><span style="color:#56B6C2">+</span><span style="color:#98C379"> ".xlsx"</span><span style="color:#ABB2BF">);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">        // è·å–éœ€è¦å¯¼å‡ºè”ç³»æ–¹å¼ä¿¡æ¯</span></span>
<span class="line"><span style="color:#E5C07B">        List</span><span style="color:#ABB2BF">&lt;</span><span style="color:#E5C07B">ContactExportDto</span><span style="color:#ABB2BF">&gt;</span><span style="color:#E06C75"> list </span><span style="color:#56B6C2">=</span><span style="color:#E5C07B"> this</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getContactExportDtoList</span><span style="color:#ABB2BF">();</span></span>
<span class="line"><span style="color:#E5C07B">        AssertUtil</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">throwBusinessException</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">list</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">size</span><span style="color:#ABB2BF">() </span><span style="color:#56B6C2">==</span><span style="color:#D19A66"> 0</span><span style="color:#ABB2BF">, </span><span style="color:#E5C07B">ErrorCode</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">EMPTY_CONTACT_INFO</span><span style="color:#ABB2BF">, </span><span style="color:#98C379">"æš‚æ— å¯å¯¼å‡ºçš„è”ç³»æ–¹å¼ä¿¡æ¯"</span><span style="color:#ABB2BF">);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">        // è¿™é‡Œéœ€è¦è®¾ç½®ä¸å…³é—­æµ</span></span>
<span class="line"><span style="color:#E5C07B">        EasyExcel</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">write</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">response</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getOutputStream</span><span style="color:#ABB2BF">(), </span><span style="color:#E5C07B">ContactExportDto</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">class</span><span style="color:#ABB2BF">).</span><span style="color:#61AFEF">autoCloseStream</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">Boolean</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">FALSE</span><span style="color:#ABB2BF">).</span><span style="color:#61AFEF">sheet</span><span style="color:#ABB2BF">()</span></span>
<span class="line"><span style="color:#ABB2BF">                .</span><span style="color:#61AFEF">doWrite</span><span style="color:#ABB2BF">(list);</span></span>
<span class="line"><span style="color:#E06C75">    } </span><span style="color:#C678DD">catch</span><span style="color:#E06C75"> (</span><span style="color:#E5C07B">Exception</span><span style="color:#E06C75;font-style:italic"> e</span><span style="color:#E06C75">) {</span></span>
<span class="line"><span style="color:#E5C07B">        ExcelExportResponse</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">exportFailedResponse</span><span style="color:#ABB2BF">(response, e);</span></span>
<span class="line"><span style="color:#E06C75">    }</span></span>
<span class="line"><span style="color:#C678DD">    return</span><span style="color:#E5C07B"> Result</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">success</span><span style="color:#ABB2BF">();</span></span>
<span class="line"><span style="color:#E06C75">}</span></span></code></pre></td></tr></tbody></table>
      </figure>
<p>Excel å¯¼å‡ºå¤±è´¥çš„å“åº”ä¿¡æ¯ï¼š</p>
<figure class="highlight java line-numbers" data-language="JAVA">
        <table style="background-color: #282c34"><tbody><tr><td class="gutter" style="background-color: #282c34"><pre style="background-color: #282c34"><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code" style="background-color: #282c34"><pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic">/**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * </span><span style="color:#C678DD;font-style:italic">@author</span><span style="color:#7F848E;font-style:italic"> mofan</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * @date 2021/5/29 18:10</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> */</span></span>
<span class="line"><span style="color:#ABB2BF">@</span><span style="color:#E5C07B">Slf4j</span></span>
<span class="line"><span style="color:#C678DD">public</span><span style="color:#C678DD"> class</span><span style="color:#E5C07B"> ExcelExportResponse</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * Excel å¯¼å‡ºå¤±è´¥å“åº”</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * </span><span style="color:#C678DD;font-style:italic">@param</span><span style="color:#E06C75;font-style:italic"> response</span><span style="color:#7F848E;font-style:italic"> å“åº”ä¿¡æ¯</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * </span><span style="color:#C678DD;font-style:italic">@param</span><span style="color:#E06C75;font-style:italic"> e</span><span style="color:#7F848E;font-style:italic"> æŠ›å‡ºçš„å¼‚å¸¸</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     * </span><span style="color:#C678DD;font-style:italic">@throws</span><span style="color:#E5C07B;font-style:italic"> IOException</span><span style="color:#7F848E;font-style:italic"> IO å¼‚å¸¸</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">     */</span></span>
<span class="line"><span style="color:#C678DD">    public</span><span style="color:#C678DD"> static</span><span style="color:#C678DD"> void</span><span style="color:#61AFEF"> exportFailedResponse</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">HttpServletResponse</span><span style="color:#E06C75;font-style:italic"> response</span><span style="color:#ABB2BF">, </span><span style="color:#E5C07B">Exception</span><span style="color:#E06C75;font-style:italic"> e</span><span style="color:#ABB2BF">)</span><span style="color:#C678DD"> throws</span><span style="color:#E5C07B"> IOException</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">        // é‡ç½®response</span></span>
<span class="line"><span style="color:#E5C07B">        response</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">reset</span><span style="color:#ABB2BF">();</span></span>
<span class="line"><span style="color:#E5C07B">        response</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">setContentType</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">"application/json"</span><span style="color:#ABB2BF">);</span></span>
<span class="line"><span style="color:#E5C07B">        response</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">setCharacterEncoding</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">"utf-8"</span><span style="color:#ABB2BF">);</span></span>
<span class="line"><span style="color:#E5C07B">        Result</span><span style="color:#ABB2BF">&lt;</span><span style="color:#E5C07B">Object</span><span style="color:#ABB2BF">&gt; </span><span style="color:#E06C75">result</span><span style="color:#56B6C2"> =</span><span style="color:#D19A66"> null</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD">        if</span><span style="color:#ABB2BF"> (e </span><span style="color:#C678DD">instanceof</span><span style="color:#ABB2BF"> BusinessException) {</span></span>
<span class="line"><span style="color:#E5C07B">            log</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">error</span><span style="color:#ABB2BF">(((BusinessException) e).</span><span style="color:#61AFEF">code</span><span style="color:#ABB2BF">() </span><span style="color:#56B6C2">+</span><span style="color:#98C379"> " : "</span><span style="color:#56B6C2"> +</span><span style="color:#E5C07B"> e</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getMessage</span><span style="color:#ABB2BF">());</span></span>
<span class="line"><span style="color:#ABB2BF">            result </span><span style="color:#56B6C2">=</span><span style="color:#C678DD"> new</span><span style="color:#E5C07B"> Result</span><span style="color:#ABB2BF">&lt;&gt;(((BusinessException) e).</span><span style="color:#61AFEF">code</span><span style="color:#ABB2BF">(), </span><span style="color:#E5C07B">e</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getMessage</span><span style="color:#ABB2BF">());</span></span>
<span class="line"><span style="color:#ABB2BF">        } </span><span style="color:#C678DD">else</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#E5C07B">            String</span><span style="color:#E06C75"> defaultMessage</span><span style="color:#56B6C2"> =</span><span style="color:#98C379"> "Excelå¯¼å‡ºå¤±è´¥"</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#E5C07B">            log</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">error</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">ErrorCode</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">EXCEL_EXPORT_ERROR</span><span style="color:#56B6C2"> +</span><span style="color:#98C379"> " : "</span><span style="color:#56B6C2"> +</span><span style="color:#ABB2BF"> defaultMessage);</span></span>
<span class="line"><span style="color:#ABB2BF">            result </span><span style="color:#56B6C2">=</span><span style="color:#C678DD"> new</span><span style="color:#E5C07B"> Result</span><span style="color:#ABB2BF">&lt;&gt;(</span><span style="color:#E5C07B">ErrorCode</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">EXCEL_EXPORT_ERROR</span><span style="color:#ABB2BF">, defaultMessage);</span></span>
<span class="line"><span style="color:#ABB2BF">        }</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">        // å†æ¬¡è®¾ç½®è·¨åŸŸï¼Œå¦åˆ™å‰ç«¯å‡ºç°è·¨åŸŸ</span></span>
<span class="line"><span style="color:#E5C07B">        response</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">setHeader</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">"Access-Control-Allow-Origin"</span><span style="color:#ABB2BF">, </span><span style="color:#98C379">"*"</span><span style="color:#ABB2BF">);</span></span>
<span class="line"><span style="color:#E5C07B">        response</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getWriter</span><span style="color:#ABB2BF">().</span><span style="color:#61AFEF">print</span><span style="color:#ABB2BF">(</span><span style="color:#C678DD">new</span><span style="color:#61AFEF"> ObjectMapper</span><span style="color:#ABB2BF">().</span><span style="color:#61AFEF">writeValueAsString</span><span style="color:#ABB2BF">(result));</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF">}</span></span></code></pre></td></tr></tbody></table>
      </figure>
<h1 id="9-å‰ç«¯-JS-çš„å°è£…"><a class="header-anchor" href="#9-å‰ç«¯-JS-çš„å°è£…"></a>9. å‰ç«¯ - JS çš„å°è£…</h1>
<h2 id="9-1-http-js"><a class="header-anchor" href="#9-1-http-js"></a>9.1 http.js</h2>
<p>ç”±äºåç«¯ä½¿ç”¨äº† JWT å’Œ SpringSecurityï¼Œè¦æ±‚å‰ç«¯å‘é€çš„è¯·æ±‚éƒ½è¦åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ ä¸Š Tokenï¼Œå› æ­¤éœ€è¦å¯¹å‰ç«¯ä½¿ç”¨çš„ Axios è¿›è¡Œé…ç½®ï¼Œæ¯”å¦‚æ·»åŠ æ‹¦æˆªå™¨ã€‚</p>
<figure class="highlight js line-numbers" data-language="JS">
        <table style="background-color: #282c34"><tbody><tr><td class="gutter" style="background-color: #282c34"><pre style="background-color: #282c34"><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code" style="background-color: #282c34"><pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD">import</span><span style="color:#E06C75"> axios</span><span style="color:#C678DD"> from</span><span style="color:#98C379"> 'axios'</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD">import</span><span style="color:#E06C75"> router</span><span style="color:#C678DD"> from</span><span style="color:#98C379"> '../router'</span></span>
<span class="line"><span style="color:#C678DD">import</span><span style="color:#E06C75"> Vue</span><span style="color:#C678DD"> from</span><span style="color:#98C379"> '../main'</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">// Axios ç›¸å…³é…ç½®</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">/**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * æ–°å¼€ä¸€ä¸ªæ–‡ä»¶è¿›è¡Œé…ç½®</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * é˜²æ­¢åœ¨åˆ·æ–°é¡µé¢åï¼ŒAxios æ‹¦æˆªå™¨ä¸ç”Ÿæ•ˆ</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> */</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">// é…ç½® axios è¯·æ±‚åŸºç¡€ URL</span></span>
<span class="line"><span style="color:#E5C07B">axios</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">defaults</span><span style="color:#ABB2BF">.</span><span style="color:#E06C75">baseURL</span><span style="color:#56B6C2"> =</span><span style="color:#98C379"> 'http://127.0.0.1:9090'</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">// axios æ‹¦æˆªå™¨ï¼Œä¸ºæ¯æ¬¡è¯·æ±‚æ·»åŠ  Token</span></span>
<span class="line"><span style="color:#E5C07B">axios</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">interceptors</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">request</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">use</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75;font-style:italic">config</span><span style="color:#C678DD"> =&gt;</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#C678DD">  if</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">config</span><span style="color:#ABB2BF">.</span><span style="color:#E06C75">url</span><span style="color:#56B6C2"> ===</span><span style="color:#98C379"> '/auth/login'</span><span style="color:#ABB2BF">) {</span></span>
<span class="line"><span style="color:#C678DD">    return</span><span style="color:#E06C75"> config</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">  // è¿™é‡Œçš„configåŒ…å«æ¯æ¬¡è¯·æ±‚çš„å†…å®¹</span></span>
<span class="line"><span style="color:#C678DD">  const</span><span style="color:#E5C07B"> token</span><span style="color:#56B6C2"> =</span><span style="color:#E5C07B"> window</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">localStorage</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getItem</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">"token"</span><span style="color:#ABB2BF">);</span></span>
<span class="line"><span style="color:#C678DD">  if</span><span style="color:#ABB2BF"> (</span><span style="color:#E06C75">token</span><span style="color:#56B6C2"> !=</span><span style="color:#D19A66"> null</span><span style="color:#56B6C2"> &amp;&amp;</span><span style="color:#E06C75"> token</span><span style="color:#56B6C2"> !=</span><span style="color:#98C379"> ''</span><span style="color:#ABB2BF">) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    // æ·»åŠ headers</span></span>
<span class="line"><span style="color:#E5C07B">    config</span><span style="color:#ABB2BF">.</span><span style="color:#E06C75">headers</span><span style="color:#ABB2BF">[</span><span style="color:#98C379">'Authorization'</span><span style="color:#ABB2BF">] </span><span style="color:#56B6C2">=</span><span style="color:#E06C75"> token</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#ABB2BF">  } </span><span style="color:#C678DD">else</span><span style="color:#ABB2BF"> { }</span></span>
<span class="line"><span style="color:#C678DD">  return</span><span style="color:#E06C75"> config</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#ABB2BF">}, </span><span style="color:#E06C75;font-style:italic">err</span><span style="color:#C678DD"> =&gt;</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#C678DD">  return</span><span style="color:#E5C07B"> Promise</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">reject</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75">err</span><span style="color:#ABB2BF">);</span></span>
<span class="line"><span style="color:#ABB2BF">})</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">// å¼‚æ­¥è¯·æ±‚åï¼Œåˆ¤æ–­tokenæ˜¯å¦è¿‡æœŸ</span></span>
<span class="line"><span style="color:#E5C07B">axios</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">interceptors</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">response</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">use</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75;font-style:italic">res</span><span style="color:#C678DD"> =&gt;</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">  // åˆ¤æ–­å½“å‰ç”¨æˆ·ç™»å½•çŠ¶æ€</span></span>
<span class="line"><span style="color:#61AFEF">  verifyUserLoginStatus</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75">res</span><span style="color:#ABB2BF">);</span></span>
<span class="line"><span style="color:#C678DD">  return</span><span style="color:#E06C75"> res</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#ABB2BF">}, </span><span style="color:#E06C75;font-style:italic">err</span><span style="color:#C678DD"> =&gt;</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#C678DD">  return</span><span style="color:#E5C07B"> Promise</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">reject</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75">err</span><span style="color:#ABB2BF">);</span></span>
<span class="line"><span style="color:#ABB2BF">})</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">export</span><span style="color:#C678DD"> default</span><span style="color:#E06C75"> axios</span><span style="color:#ABB2BF">;</span></span></code></pre></td></tr></tbody></table>
      </figure>
<h2 id="9-2-tools-js"><a class="header-anchor" href="#9-2-tools-js"></a>9.2 tools.js</h2>
<p>ä¸ºäº†æ›´å¥½åœ°ä½¿ç”¨ Element-UI ä¸­çš„ Messageï¼ˆæ¶ˆæ¯æç¤ºï¼‰ç»„ä»¶ï¼Œåœ¨è¿™é‡Œå¯¹è¿™ä¸ªç»„ä»¶çš„ä½¿ç”¨è¿›è¡Œç®€å•çš„å°è£…ã€‚</p>
<figure class="highlight js line-numbers" data-language="JS">
        <table style="background-color: #282c34"><tbody><tr><td class="gutter" style="background-color: #282c34"><pre style="background-color: #282c34"><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code" style="background-color: #282c34"><pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic">/**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * Element æ¶ˆæ¯æç¤ºç»„ä»¶</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * type å¯ä¾›çš„å–å€¼: success/warning/info/error</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> */</span></span>
<span class="line"><span style="color:#C678DD">function</span><span style="color:#61AFEF"> showMsg</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75;font-style:italic">_this</span><span style="color:#ABB2BF">, </span><span style="color:#E06C75;font-style:italic">msg</span><span style="color:#ABB2BF">, </span><span style="color:#E06C75;font-style:italic">type</span><span style="color:#ABB2BF">, </span><span style="color:#E06C75;font-style:italic">duration</span><span style="color:#ABB2BF">) {</span></span>
<span class="line"><span style="color:#C678DD">  if</span><span style="color:#ABB2BF"> (</span><span style="color:#E06C75">duration</span><span style="color:#56B6C2"> ==</span><span style="color:#D19A66"> null</span><span style="color:#ABB2BF">) {</span></span>
<span class="line"><span style="color:#E06C75">    duration</span><span style="color:#56B6C2"> =</span><span style="color:#D19A66"> 1500</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#C678DD">  if</span><span style="color:#ABB2BF"> (</span><span style="color:#E06C75">msg</span><span style="color:#56B6C2"> ==</span><span style="color:#D19A66"> null</span><span style="color:#ABB2BF">) </span><span style="color:#C678DD">return</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#E5C07B">  _this</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">$message</span><span style="color:#ABB2BF">({</span></span>
<span class="line"><span style="color:#E06C75">    message</span><span style="color:#ABB2BF">: </span><span style="color:#E06C75">msg</span><span style="color:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75">    type</span><span style="color:#ABB2BF">: </span><span style="color:#E06C75">type</span><span style="color:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75">    duration</span><span style="color:#ABB2BF">: </span><span style="color:#E06C75">duration</span></span>
<span class="line"><span style="color:#ABB2BF">  })</span></span>
<span class="line"><span style="color:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">const</span><span style="color:#E5C07B"> Tools</span><span style="color:#56B6C2"> =</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#E06C75">  showMsg</span></span>
<span class="line"><span style="color:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">export</span><span style="color:#C678DD"> default</span><span style="color:#E06C75"> Tools</span><span style="color:#ABB2BF">;</span></span></code></pre></td></tr></tbody></table>
      </figure>
<h2 id="9-3-file-js"><a class="header-anchor" href="#9-3-file-js"></a>9.3 file.js</h2>
<p>å¯¹äºæ–‡ä»¶çš„ä¸Šä¼ æ¥è¯´ï¼Œé™¤äº†åœ¨åç«¯è¿›è¡Œç±»å‹æ ¡éªŒå¤–ï¼Œè¿˜éœ€è¦åœ¨å‰ç«¯å¯¹æ–‡ä»¶ç±»å‹è¿›è¡Œæ ¡éªŒã€‚è¿™é‡Œåªå¯¹ Excelã€PDF ç±»å‹çš„æ–‡ä»¶è¿›è¡Œäº†ç±»å‹æ ¡éªŒï¼š</p>
<figure class="highlight js line-numbers" data-language="JS">
        <table style="background-color: #282c34"><tbody><tr><td class="gutter" style="background-color: #282c34"><pre style="background-color: #282c34"><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code" style="background-color: #282c34"><pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD">import</span><span style="color:#E06C75"> Tools</span><span style="color:#C678DD"> from</span><span style="color:#98C379"> './tools'</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">/**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * æ ¡éªŒå½“å‰æ–‡ä»¶æ˜¯å¦æ˜¯ Excel æ–‡ä»¶</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> */</span></span>
<span class="line"><span style="color:#C678DD">export</span><span style="color:#C678DD"> function</span><span style="color:#61AFEF"> verifyExcelTypeAndSize</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75;font-style:italic">_this</span><span style="color:#ABB2BF">, </span><span style="color:#E06C75;font-style:italic">file</span><span style="color:#ABB2BF">) {</span></span>
<span class="line"><span style="color:#C678DD">  let</span><span style="color:#E06C75"> fileType</span><span style="color:#56B6C2"> =</span><span style="color:#61AFEF"> getFileType</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75">file</span><span style="color:#ABB2BF">);</span></span>
<span class="line"><span style="color:#C678DD">  let</span><span style="color:#E06C75"> isExcel</span><span style="color:#56B6C2"> =</span><span style="color:#ABB2BF"> (</span><span style="color:#E06C75">fileType</span><span style="color:#56B6C2"> ===</span><span style="color:#98C379"> "xls"</span><span style="color:#ABB2BF">) </span><span style="color:#56B6C2">||</span><span style="color:#ABB2BF"> (</span><span style="color:#E06C75">fileType</span><span style="color:#56B6C2"> ===</span><span style="color:#98C379"> "xlsx"</span><span style="color:#ABB2BF">);</span></span>
<span class="line"><span style="color:#C678DD">  let</span><span style="color:#E06C75"> isLt5M</span><span style="color:#56B6C2"> =</span><span style="color:#E5C07B"> file</span><span style="color:#ABB2BF">.</span><span style="color:#E06C75">size</span><span style="color:#56B6C2"> /</span><span style="color:#D19A66"> 1024</span><span style="color:#56B6C2"> /</span><span style="color:#D19A66"> 1024</span><span style="color:#56B6C2"> &lt;</span><span style="color:#D19A66"> 5</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD">  if</span><span style="color:#ABB2BF"> (</span><span style="color:#56B6C2">!</span><span style="color:#E06C75">isExcel</span><span style="color:#ABB2BF">) {</span></span>
<span class="line"><span style="color:#E5C07B">    Tools</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">showMsg</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75">_this</span><span style="color:#ABB2BF">, </span><span style="color:#98C379">"ä¸Šä¼ æ–‡ä»¶åªèƒ½æ˜¯Excelæ–‡ä»¶æ ¼å¼"</span><span style="color:#ABB2BF">, </span><span style="color:#98C379">"error"</span><span style="color:#ABB2BF">, </span><span style="color:#D19A66">4000</span><span style="color:#ABB2BF">);</span></span>
<span class="line"><span style="color:#C678DD">    return</span><span style="color:#D19A66"> false</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#C678DD">  if</span><span style="color:#ABB2BF"> (</span><span style="color:#56B6C2">!</span><span style="color:#E06C75">isLt5M</span><span style="color:#ABB2BF">) {</span></span>
<span class="line"><span style="color:#E5C07B">    Tools</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">showMsg</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75">_this</span><span style="color:#ABB2BF">, </span><span style="color:#98C379">"ä¸Šä¼ æ–‡ä»¶å¤§å°ä¸è¶…è¿‡5M"</span><span style="color:#ABB2BF">, </span><span style="color:#98C379">"error"</span><span style="color:#ABB2BF">, </span><span style="color:#D19A66">4000</span><span style="color:#ABB2BF">);</span></span>
<span class="line"><span style="color:#C678DD">    return</span><span style="color:#D19A66"> false</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#C678DD">  return</span><span style="color:#D19A66"> true</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">/**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * æ ¡éªŒå½“å‰æ–‡ä»¶æ˜¯å¦æ˜¯ pdf æ–‡ä»¶</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> */</span></span>
<span class="line"><span style="color:#C678DD"> export</span><span style="color:#C678DD"> function</span><span style="color:#61AFEF"> verifyPdfTypeAndSize</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75;font-style:italic">_this</span><span style="color:#ABB2BF">, </span><span style="color:#E06C75;font-style:italic">file</span><span style="color:#ABB2BF">) {</span></span>
<span class="line"><span style="color:#C678DD">  let</span><span style="color:#E06C75"> fileType</span><span style="color:#56B6C2"> =</span><span style="color:#61AFEF"> getFileType</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75">file</span><span style="color:#ABB2BF">);</span></span>
<span class="line"><span style="color:#C678DD">  let</span><span style="color:#E06C75"> isExcel</span><span style="color:#56B6C2"> =</span><span style="color:#ABB2BF"> (</span><span style="color:#E06C75">fileType</span><span style="color:#56B6C2"> ===</span><span style="color:#98C379"> "pdf"</span><span style="color:#ABB2BF">);</span></span>
<span class="line"><span style="color:#C678DD">  let</span><span style="color:#E06C75"> isLt10M</span><span style="color:#56B6C2"> =</span><span style="color:#E5C07B"> file</span><span style="color:#ABB2BF">.</span><span style="color:#E06C75">size</span><span style="color:#56B6C2"> /</span><span style="color:#D19A66"> 1024</span><span style="color:#56B6C2"> /</span><span style="color:#D19A66"> 1024</span><span style="color:#56B6C2"> &lt;</span><span style="color:#D19A66"> 10</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD">  if</span><span style="color:#ABB2BF"> (</span><span style="color:#56B6C2">!</span><span style="color:#E06C75">isExcel</span><span style="color:#ABB2BF">) {</span></span>
<span class="line"><span style="color:#E5C07B">    Tools</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">showMsg</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75">_this</span><span style="color:#ABB2BF">, </span><span style="color:#98C379">"ä¸Šä¼ æ–‡ä»¶åªèƒ½æ˜¯PDFæ–‡ä»¶æ ¼å¼"</span><span style="color:#ABB2BF">, </span><span style="color:#98C379">"error"</span><span style="color:#ABB2BF">, </span><span style="color:#D19A66">4000</span><span style="color:#ABB2BF">);</span></span>
<span class="line"><span style="color:#C678DD">    return</span><span style="color:#D19A66"> false</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#C678DD">  if</span><span style="color:#ABB2BF"> (</span><span style="color:#56B6C2">!</span><span style="color:#E06C75">isLt10M</span><span style="color:#ABB2BF">) {</span></span>
<span class="line"><span style="color:#E5C07B">    Tools</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">showMsg</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75">_this</span><span style="color:#ABB2BF">, </span><span style="color:#98C379">"ä¸Šä¼ æ–‡ä»¶å¤§å°ä¸è¶…è¿‡10M"</span><span style="color:#ABB2BF">, </span><span style="color:#98C379">"error"</span><span style="color:#ABB2BF">, </span><span style="color:#D19A66">4000</span><span style="color:#ABB2BF">);</span></span>
<span class="line"><span style="color:#C678DD">    return</span><span style="color:#D19A66"> false</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#C678DD">  return</span><span style="color:#D19A66"> true</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">/**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * æ ¹æ® File ç±»è·å–æ–‡ä»¶ç±»å‹</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> *</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * </span><span style="color:#C678DD;font-style:italic">@param</span><span style="color:#E5C07B;font-style:italic"> {*}</span><span style="color:#E06C75;font-style:italic"> file</span><span style="color:#7F848E;font-style:italic">  File ç±»</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * </span><span style="color:#C678DD;font-style:italic">@return</span><span style="color:#E5C07B;font-style:italic"> {*}</span><span style="color:#7F848E;font-style:italic"> æ–‡ä»¶ç±»å‹</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> */</span></span>
<span class="line"><span style="color:#C678DD">function</span><span style="color:#61AFEF"> getFileType</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75;font-style:italic">file</span><span style="color:#ABB2BF">) {</span></span>
<span class="line"><span style="color:#C678DD">  let</span><span style="color:#E06C75"> fileName</span><span style="color:#56B6C2"> =</span><span style="color:#E5C07B"> file</span><span style="color:#ABB2BF">.</span><span style="color:#E06C75">name</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD">  let</span><span style="color:#E06C75"> startIndex</span><span style="color:#56B6C2"> =</span><span style="color:#E5C07B"> fileName</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">lastIndexOf</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">'.'</span><span style="color:#ABB2BF">);</span></span>
<span class="line"><span style="color:#C678DD">  if</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75">startIndex</span><span style="color:#56B6C2"> !=</span><span style="color:#56B6C2"> -</span><span style="color:#D19A66">1</span><span style="color:#ABB2BF">) {</span></span>
<span class="line"><span style="color:#C678DD">    return</span><span style="color:#E5C07B"> fileName</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">substring</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75">startIndex</span><span style="color:#56B6C2"> +</span><span style="color:#D19A66"> 1</span><span style="color:#ABB2BF">, </span><span style="color:#E5C07B">fileName</span><span style="color:#ABB2BF">.</span><span style="color:#E06C75">length</span><span style="color:#ABB2BF">).</span><span style="color:#61AFEF">toLowerCase</span><span style="color:#ABB2BF">();</span></span>
<span class="line"><span style="color:#ABB2BF">  } </span><span style="color:#C678DD">else</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#C678DD">    return</span><span style="color:#98C379"> ''</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF">}</span></span></code></pre></td></tr></tbody></table>
      </figure>
<h2 id="9-4-date-js"><a class="header-anchor" href="#9-4-date-js"></a>9.4 date.js</h2>
<p>å°† JS ä¸­ Date ç±»å‹çš„æ ¼å¼è½¬æ¢æˆ <code>yyyy-MM-dd HH:mm:ss</code> æ ¼å¼ï¼š</p>
<figure class="highlight js line-numbers" data-language="JS">
        <table style="background-color: #282c34"><tbody><tr><td class="gutter" style="background-color: #282c34"><pre style="background-color: #282c34"><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code" style="background-color: #282c34"><pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic">/**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * å°†å­—ç¬¦ä¸²æ—¥æœŸè½¬æ¢ä¸º yyyy-MM-dd HH:mm:ss æ ¼å¼</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> *</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * </span><span style="color:#C678DD;font-style:italic">@export</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * </span><span style="color:#C678DD;font-style:italic">@param</span><span style="color:#E5C07B;font-style:italic"> {*}</span><span style="color:#E06C75;font-style:italic"> date</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * </span><span style="color:#C678DD;font-style:italic">@return</span><span style="color:#E5C07B;font-style:italic"> {*}</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> */</span></span>
<span class="line"><span style="color:#C678DD">export</span><span style="color:#C678DD"> function</span><span style="color:#61AFEF"> renderTime</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75;font-style:italic">date</span><span style="color:#ABB2BF">) {</span></span>
<span class="line"><span style="color:#C678DD">  if</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75">date</span><span style="color:#56B6C2"> !=</span><span style="color:#D19A66"> null</span><span style="color:#56B6C2"> &amp;&amp;</span><span style="color:#E06C75"> date</span><span style="color:#56B6C2"> !=</span><span style="color:#98C379"> ''</span><span style="color:#ABB2BF">) {</span></span>
<span class="line"><span style="color:#C678DD">    var</span><span style="color:#E06C75"> dateJson</span><span style="color:#56B6C2"> =</span><span style="color:#C678DD"> new</span><span style="color:#61AFEF"> Date</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75">date</span><span style="color:#ABB2BF">).</span><span style="color:#61AFEF">toJSON</span><span style="color:#ABB2BF">();</span></span>
<span class="line"><span style="color:#C678DD">    return</span><span style="color:#C678DD"> new</span><span style="color:#61AFEF"> Date</span><span style="color:#ABB2BF">(</span><span style="color:#56B6C2">+</span><span style="color:#C678DD">new</span><span style="color:#61AFEF"> Date</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75">dateJson</span><span style="color:#ABB2BF">) </span><span style="color:#56B6C2">+</span><span style="color:#D19A66"> 8</span><span style="color:#56B6C2"> *</span><span style="color:#D19A66"> 3600</span><span style="color:#56B6C2"> *</span><span style="color:#D19A66"> 1000</span><span style="color:#ABB2BF">).</span><span style="color:#61AFEF">toISOString</span><span style="color:#ABB2BF">().</span><span style="color:#61AFEF">replace</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75">/T/</span><span style="color:#C678DD">g</span><span style="color:#ABB2BF">, </span><span style="color:#98C379">' '</span><span style="color:#ABB2BF">).</span><span style="color:#61AFEF">replace</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75">/</span><span style="color:#56B6C2">\.</span><span style="color:#D19A66">[</span><span style="color:#E06C75">\d</span><span style="color:#D19A66">]{3}</span><span style="color:#E06C75">Z/</span><span style="color:#ABB2BF">, </span><span style="color:#98C379">''</span><span style="color:#ABB2BF">)</span></span>
<span class="line"><span style="color:#ABB2BF">  } </span><span style="color:#C678DD">else</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#C678DD">    return</span><span style="color:#98C379"> ''</span></span>
<span class="line"><span style="color:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF">}</span></span></code></pre></td></tr></tbody></table>
      </figure>
<p>åœ¨æµè§ˆå™¨ä¸­çš„ä½¿ç”¨ç»“æœï¼š</p>
<p><img src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/loading.gif" data-lazy-src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/SummaryImages/date.js%E4%BD%BF%E7%94%A8%E7%A4%BA%E4%BE%8B.png" alt="date.jsä½¿ç”¨ç¤ºä¾‹"></p>
<h2 id="9-5-request-js"><a class="header-anchor" href="#9-5-request-js"></a>9.5 request.js</h2>
<p>åœ¨è¿›è¡Œåˆ é™¤ç­‰æ•æ„Ÿæ“ä½œæ—¶ï¼Œå‰ç«¯åº”å½“æ˜¾ç¤ºç¡®è®¤æ¡†ï¼Œå½“ç”¨æˆ·ç‚¹å‡»â€œç¡®å®šâ€åæ‰è¿›è¡Œæ•æ„Ÿæ“ä½œã€‚</p>
<p>é€šè¿‡ç‚¹å‡»æŒ‰é’®å®ç° Excel çš„ä¸‹è½½æ—¶ï¼Œåªéœ€è¦æ”¹å˜è¯·æ±‚åœ°å€å³å¯ï¼Œå› æ­¤ä¹Ÿå¯¹ Excel çš„ä¸‹è½½è¿›è¡Œå°è£…ã€‚</p>
<figure class="highlight js line-numbers" data-language="JS">
        <table style="background-color: #282c34"><tbody><tr><td class="gutter" style="background-color: #282c34"><pre style="background-color: #282c34"><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code" style="background-color: #282c34"><pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#C678DD">import</span><span style="color:#E06C75"> axios</span><span style="color:#C678DD"> from</span><span style="color:#98C379"> 'axios'</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD">import</span><span style="color:#E06C75"> Tools</span><span style="color:#C678DD"> from</span><span style="color:#98C379"> "../utils/tools"</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">/**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * æ•æ„Ÿæ“ä½œ</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * </span><span style="color:#C678DD;font-style:italic">@param</span><span style="color:#E5C07B;font-style:italic"> {*}</span><span style="color:#E06C75;font-style:italic"> _this</span><span style="color:#7F848E;font-style:italic"> Vue å®ä¾‹</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * </span><span style="color:#C678DD;font-style:italic">@param</span><span style="color:#E5C07B;font-style:italic"> {*}</span><span style="color:#E06C75;font-style:italic"> warningMsg</span><span style="color:#7F848E;font-style:italic"> é”™è¯¯ä¿¡æ¯</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * </span><span style="color:#C678DD;font-style:italic">@param</span><span style="color:#E5C07B;font-style:italic"> {*}</span><span style="color:#E06C75;font-style:italic"> func</span><span style="color:#7F848E;font-style:italic"> è¿›è¡Œçš„æ•æ„Ÿæ“ä½œæ–¹æ³•</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> */</span></span>
<span class="line"><span style="color:#C678DD">export</span><span style="color:#C678DD"> function</span><span style="color:#61AFEF"> sensitiveOperation</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75;font-style:italic">_this</span><span style="color:#ABB2BF">, </span><span style="color:#E06C75;font-style:italic">warningMsg</span><span style="color:#ABB2BF">, </span><span style="color:#E06C75;font-style:italic">func</span><span style="color:#ABB2BF">) {</span></span>
<span class="line"><span style="color:#E5C07B">  _this</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">$confirm</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75">warningMsg</span><span style="color:#ABB2BF">, </span><span style="color:#98C379">"æç¤º"</span><span style="color:#ABB2BF">, {</span></span>
<span class="line"><span style="color:#E06C75">      confirmButtonText</span><span style="color:#ABB2BF">: </span><span style="color:#98C379">"ç¡®å®š"</span><span style="color:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75">      concelButtonText</span><span style="color:#ABB2BF">: </span><span style="color:#98C379">"å–æ¶ˆ"</span><span style="color:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75">      type</span><span style="color:#ABB2BF">: </span><span style="color:#98C379">"warning"</span><span style="color:#ABB2BF">,</span></span>
<span class="line"><span style="color:#ABB2BF">    })</span></span>
<span class="line"><span style="color:#ABB2BF">    .</span><span style="color:#61AFEF">then</span><span style="color:#ABB2BF">(() </span><span style="color:#C678DD">=&gt;</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#61AFEF">      func</span><span style="color:#ABB2BF">()</span></span>
<span class="line"><span style="color:#ABB2BF">    })</span></span>
<span class="line"><span style="color:#ABB2BF">    .</span><span style="color:#61AFEF">catch</span><span style="color:#ABB2BF">(() </span><span style="color:#C678DD">=&gt;</span><span style="color:#ABB2BF"> {});</span></span>
<span class="line"><span style="color:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">/**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * å¯¼å‡º Excel æ–¹æ³•</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * </span><span style="color:#C678DD;font-style:italic">@param</span><span style="color:#E5C07B;font-style:italic"> {*}</span><span style="color:#E06C75;font-style:italic"> _this</span><span style="color:#7F848E;font-style:italic"> Vue å®ä¾‹</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * </span><span style="color:#C678DD;font-style:italic">@param</span><span style="color:#E5C07B;font-style:italic"> {*}</span><span style="color:#E06C75;font-style:italic"> url</span><span style="color:#7F848E;font-style:italic"> è¯·æ±‚è·¯å¾„</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> */</span></span>
<span class="line"><span style="color:#C678DD">export</span><span style="color:#C678DD"> function</span><span style="color:#61AFEF"> exportExcel</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75;font-style:italic">_this</span><span style="color:#ABB2BF">, </span><span style="color:#E06C75;font-style:italic">url</span><span style="color:#ABB2BF">) {</span></span>
<span class="line"><span style="color:#E06C75">  axios</span></span>
<span class="line"><span style="color:#ABB2BF">    .</span><span style="color:#61AFEF">get</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75">url</span><span style="color:#ABB2BF">, {</span></span>
<span class="line"><span style="color:#E06C75">      responseType</span><span style="color:#ABB2BF">: </span><span style="color:#98C379">"blob"</span></span>
<span class="line"><span style="color:#ABB2BF">    })</span></span>
<span class="line"><span style="color:#ABB2BF">    .</span><span style="color:#61AFEF">then</span><span style="color:#ABB2BF">((</span><span style="color:#E06C75;font-style:italic">res</span><span style="color:#ABB2BF">) </span><span style="color:#C678DD">=&gt;</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#C678DD">      let</span><span style="color:#E06C75"> type</span><span style="color:#56B6C2"> =</span><span style="color:#E5C07B"> res</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">data</span><span style="color:#ABB2BF">.</span><span style="color:#E06C75">type</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD">      const</span><span style="color:#E5C07B"> relType</span><span style="color:#56B6C2"> =</span><span style="color:#ABB2BF"> [</span></span>
<span class="line"><span style="color:#98C379">        "application/vnd.ms-excel"</span><span style="color:#ABB2BF">,</span></span>
<span class="line"><span style="color:#98C379">        "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"</span><span style="color:#ABB2BF">,</span></span>
<span class="line"><span style="color:#ABB2BF">      ];</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">      // Excel ä¸‹è½½å¤±è´¥æ—¶ --&gt; æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯</span></span>
<span class="line"><span style="color:#C678DD">      if</span><span style="color:#ABB2BF"> (</span><span style="color:#E5C07B">type</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">includes</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">"application/json"</span><span style="color:#ABB2BF">)) {</span></span>
<span class="line"><span style="color:#C678DD">        let</span><span style="color:#E06C75"> reader</span><span style="color:#56B6C2"> =</span><span style="color:#C678DD"> new</span><span style="color:#61AFEF"> FileReader</span><span style="color:#ABB2BF">();</span></span>
<span class="line"><span style="color:#E5C07B">        reader</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">onload</span><span style="color:#56B6C2"> =</span><span style="color:#C678DD"> function</span><span style="color:#ABB2BF"> (</span><span style="color:#E06C75;font-style:italic">event</span><span style="color:#ABB2BF">) {</span></span>
<span class="line"><span style="color:#C678DD">          let</span><span style="color:#E06C75"> errorResult</span><span style="color:#56B6C2"> =</span><span style="color:#E5C07B"> JSON</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">parse</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">reader</span><span style="color:#ABB2BF">.</span><span style="color:#E06C75">result</span><span style="color:#ABB2BF">); </span><span style="color:#7F848E;font-style:italic">// é”™è¯¯ä¿¡æ¯</span></span>
<span class="line"><span style="color:#C678DD">          let</span><span style="color:#E06C75"> msg</span><span style="color:#56B6C2"> =</span><span style="color:#E5C07B"> Tools</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">errMsg</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">errorResult</span><span style="color:#ABB2BF">.</span><span style="color:#E06C75">code</span><span style="color:#ABB2BF">, </span><span style="color:#E5C07B">errorResult</span><span style="color:#ABB2BF">.</span><span style="color:#E06C75">msg</span><span style="color:#ABB2BF">);</span></span>
<span class="line"><span style="color:#E5C07B">          Tools</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">showMsg</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75">_this</span><span style="color:#ABB2BF">, </span><span style="color:#E06C75">msg</span><span style="color:#ABB2BF">, </span><span style="color:#98C379">"error"</span><span style="color:#ABB2BF">, </span><span style="color:#D19A66">3000</span><span style="color:#ABB2BF">);</span></span>
<span class="line"><span style="color:#ABB2BF">        };</span></span>
<span class="line"><span style="color:#E5C07B">        reader</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">readAsText</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">res</span><span style="color:#ABB2BF">.</span><span style="color:#E06C75">data</span><span style="color:#ABB2BF">);</span></span>
<span class="line"><span style="color:#ABB2BF">      }</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">      // Excel å¯¼å‡ºæˆåŠŸ</span></span>
<span class="line"><span style="color:#C678DD">      if</span><span style="color:#ABB2BF"> (</span><span style="color:#E5C07B">relType</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">includes</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75">type</span><span style="color:#ABB2BF">)) {</span></span>
<span class="line"><span style="color:#C678DD">        let</span><span style="color:#E06C75"> blob</span><span style="color:#56B6C2"> =</span><span style="color:#C678DD"> new</span><span style="color:#61AFEF"> Blob</span><span style="color:#ABB2BF">([</span><span style="color:#E5C07B">res</span><span style="color:#ABB2BF">.</span><span style="color:#E06C75">data</span><span style="color:#ABB2BF">]);</span></span>
<span class="line"><span style="color:#C678DD">        let</span><span style="color:#E06C75"> downloadElement</span><span style="color:#56B6C2"> =</span><span style="color:#E5C07B"> document</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">createElement</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">"a"</span><span style="color:#ABB2BF">);</span></span>
<span class="line"><span style="color:#C678DD">        let</span><span style="color:#E06C75"> href</span><span style="color:#56B6C2"> =</span><span style="color:#E5C07B"> window</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">URL</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">createObjectURL</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75">blob</span><span style="color:#ABB2BF">); </span><span style="color:#7F848E;font-style:italic">//åˆ›å»ºä¸‹è½½çš„é“¾æ¥</span></span>
<span class="line"><span style="color:#E5C07B">        downloadElement</span><span style="color:#ABB2BF">.</span><span style="color:#E06C75">href</span><span style="color:#56B6C2"> =</span><span style="color:#E06C75"> href</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD">        let</span><span style="color:#E06C75"> contentDisposition</span><span style="color:#56B6C2"> =</span><span style="color:#E5C07B"> res</span><span style="color:#ABB2BF">.</span><span style="color:#E06C75">headers</span><span style="color:#ABB2BF">[</span><span style="color:#98C379">"content-disposition"</span><span style="color:#ABB2BF">];</span></span>
<span class="line"><span style="color:#C678DD">        let</span><span style="color:#E06C75"> fileName</span><span style="color:#56B6C2"> =</span><span style="color:#98C379"> "undefine.xlsx"</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD">        if</span><span style="color:#ABB2BF"> (</span><span style="color:#E06C75">contentDisposition</span><span style="color:#ABB2BF">) {</span></span>
<span class="line"><span style="color:#E06C75">          fileName</span><span style="color:#56B6C2"> =</span><span style="color:#E5C07B"> window</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">decodeURI</span><span style="color:#ABB2BF">(</span></span>
<span class="line"><span style="color:#E5C07B">            res</span><span style="color:#ABB2BF">.</span><span style="color:#E06C75">headers</span><span style="color:#ABB2BF">[</span><span style="color:#98C379">"content-disposition"</span><span style="color:#ABB2BF">].</span><span style="color:#61AFEF">split</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">"''"</span><span style="color:#ABB2BF">)[</span><span style="color:#D19A66">1</span><span style="color:#ABB2BF">],</span></span>
<span class="line"><span style="color:#98C379">            "UTF-8"</span></span>
<span class="line"><span style="color:#ABB2BF">          );</span></span>
<span class="line"><span style="color:#ABB2BF">        }</span></span>
<span class="line"><span style="color:#E5C07B">        downloadElement</span><span style="color:#ABB2BF">.</span><span style="color:#E06C75">download</span><span style="color:#56B6C2"> =</span><span style="color:#E06C75"> fileName</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#E5C07B">        document</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">body</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">appendChild</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75">downloadElement</span><span style="color:#ABB2BF">);</span></span>
<span class="line"><span style="color:#E5C07B">        downloadElement</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">click</span><span style="color:#ABB2BF">(); </span><span style="color:#7F848E;font-style:italic">//ç‚¹å‡»ä¸‹è½½</span></span>
<span class="line"><span style="color:#E5C07B">        document</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">body</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">removeChild</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75">downloadElement</span><span style="color:#ABB2BF">); </span><span style="color:#7F848E;font-style:italic">//ä¸‹è½½å®Œæˆç§»é™¤å…ƒç´ </span></span>
<span class="line"><span style="color:#E5C07B">        window</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">URL</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">revokeObjectURL</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75">href</span><span style="color:#ABB2BF">); </span><span style="color:#7F848E;font-style:italic">//é‡Šæ”¾æ‰blobå¯¹è±¡</span></span>
<span class="line"><span style="color:#ABB2BF">      }</span></span>
<span class="line"><span style="color:#ABB2BF">    })</span></span>
<span class="line"><span style="color:#ABB2BF">    .</span><span style="color:#61AFEF">catch</span><span style="color:#ABB2BF">((</span><span style="color:#E06C75;font-style:italic">err</span><span style="color:#ABB2BF">) </span><span style="color:#C678DD">=&gt;</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#E5C07B">      Tools</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">showMsg</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">this</span><span style="color:#ABB2BF">, </span><span style="color:#98C379">"Excelå¯¼å‡ºå¤±è´¥ï¼"</span><span style="color:#ABB2BF">, </span><span style="color:#98C379">"error"</span><span style="color:#ABB2BF">);</span></span>
<span class="line"><span style="color:#ABB2BF">    });</span></span>
<span class="line"><span style="color:#ABB2BF">}</span></span></code></pre></td></tr></tbody></table>
      </figure>
<h2 id="9-6-validate-js"><a class="header-anchor" href="#9-6-validate-js"></a>9.6 validate.js</h2>
<p>ä½¿ç”¨ Element-UI æäº¤ Dialog ç»„ä»¶ä¸­çš„è¡¨å•æ•°æ®æ—¶ï¼Œéœ€è¦å¯¹è¡¨å•ä¸­çš„æ•°æ®æœ‰æ•ˆæ€§è¿›è¡Œæ ¡éªŒï¼Œæ¯”å¦‚å¯¹ç”µè¯å·ç æ ¼å¼ã€é‚®ç®±æ ¼å¼è¿›è¡Œæ ¡éªŒã€‚å¦‚æœæ ¡éªŒä¸é€šè¿‡ï¼Œåº”å½“åœ¨æ‰€åœ¨ä½ç½®æ˜¾ç¤ºæç¤ºä¿¡æ¯ï¼Œå½“å…³é—­ Dialog æ—¶ï¼Œè¿˜éœ€è¦æ¸…ç©ºæ ¡éªŒä¿¡æ¯ã€‚</p>
<figure class="highlight js line-numbers" data-language="JS">
        <table style="background-color: #282c34"><tbody><tr><td class="gutter" style="background-color: #282c34"><pre style="background-color: #282c34"><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br></pre></td><td class="code" style="background-color: #282c34"><pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic">/**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * éªŒè¯å¹¶æäº¤è¡¨å•ä¿¡æ¯</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> */</span></span>
<span class="line"><span style="color:#C678DD">export</span><span style="color:#C678DD"> function</span><span style="color:#61AFEF"> formValidate</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75;font-style:italic">_this</span><span style="color:#ABB2BF">, </span><span style="color:#E06C75;font-style:italic">refName</span><span style="color:#ABB2BF">, </span><span style="color:#E06C75;font-style:italic">errMsg</span><span style="color:#ABB2BF">, </span><span style="color:#E06C75;font-style:italic">func</span><span style="color:#ABB2BF">) {</span></span>
<span class="line"><span style="color:#E5C07B">  _this</span><span style="color:#ABB2BF">.</span><span style="color:#E06C75">$refs</span><span style="color:#ABB2BF">[</span><span style="color:#E06C75">refName</span><span style="color:#ABB2BF">].</span><span style="color:#61AFEF">validate</span><span style="color:#ABB2BF">((</span><span style="color:#E06C75;font-style:italic">valid</span><span style="color:#ABB2BF">) </span><span style="color:#C678DD">=&gt;</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#C678DD">    if</span><span style="color:#ABB2BF"> (</span><span style="color:#E06C75">valid</span><span style="color:#ABB2BF">) {</span></span>
<span class="line"><span style="color:#61AFEF">      func</span><span style="color:#ABB2BF">()</span></span>
<span class="line"><span style="color:#ABB2BF">    } </span><span style="color:#C678DD">else</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#E5C07B">      _this</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">$message</span><span style="color:#ABB2BF">({</span></span>
<span class="line"><span style="color:#E06C75">        message</span><span style="color:#ABB2BF">: </span><span style="color:#E06C75">errMsg</span><span style="color:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75">        type</span><span style="color:#ABB2BF">: </span><span style="color:#98C379">"error"</span><span style="color:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75">        duration</span><span style="color:#ABB2BF">: </span><span style="color:#D19A66">3000</span><span style="color:#ABB2BF">,</span></span>
<span class="line"><span style="color:#ABB2BF">      });</span></span>
<span class="line"><span style="color:#C678DD">      return</span><span style="color:#D19A66"> false</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF">  });</span></span>
<span class="line"><span style="color:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">/**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * æ¸…ç©ºè¡¨å•éªŒè¯ä¿¡æ¯</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> */</span></span>
<span class="line"><span style="color:#C678DD">export</span><span style="color:#C678DD"> function</span><span style="color:#61AFEF"> resetForm</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75;font-style:italic">_this</span><span style="color:#ABB2BF">, </span><span style="color:#E06C75;font-style:italic">refName</span><span style="color:#ABB2BF">) {</span></span>
<span class="line"><span style="color:#E5C07B">  _this</span><span style="color:#ABB2BF">.</span><span style="color:#E06C75">$refs</span><span style="color:#ABB2BF">[</span><span style="color:#E06C75">refName</span><span style="color:#ABB2BF">].</span><span style="color:#61AFEF">resetFields</span><span style="color:#ABB2BF">();</span></span>
<span class="line"><span style="color:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">/**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * ç”¨æˆ·å¯†ç éªŒè¯</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> */</span></span>
<span class="line"><span style="color:#C678DD">export</span><span style="color:#C678DD"> const</span><span style="color:#61AFEF"> passwordValidate</span><span style="color:#56B6C2"> =</span><span style="color:#ABB2BF"> (</span><span style="color:#E06C75;font-style:italic">rule</span><span style="color:#ABB2BF">, </span><span style="color:#E06C75;font-style:italic">value</span><span style="color:#ABB2BF">, </span><span style="color:#E06C75;font-style:italic">callback</span><span style="color:#ABB2BF">, </span><span style="color:#E06C75;font-style:italic">errMsg</span><span style="color:#ABB2BF">) </span><span style="color:#C678DD">=&gt;</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#C678DD">  const</span><span style="color:#E5C07B"> passwordReg</span><span style="color:#56B6C2"> =</span><span style="color:#E06C75"> /</span><span style="color:#C678DD">^</span><span style="color:#D19A66">[a-zA-Z]</span><span style="color:#E06C75">\w</span><span style="color:#D19A66">{4,15}</span><span style="color:#C678DD">$</span><span style="color:#E06C75">/</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD">  if</span><span style="color:#ABB2BF"> (</span><span style="color:#56B6C2">!</span><span style="color:#E06C75">value</span><span style="color:#ABB2BF">) {</span></span>
<span class="line"><span style="color:#C678DD">    if</span><span style="color:#ABB2BF"> (</span><span style="color:#E06C75">errMsg</span><span style="color:#56B6C2"> !=</span><span style="color:#D19A66"> null</span><span style="color:#56B6C2"> &amp;&amp;</span><span style="color:#E06C75"> errMsg</span><span style="color:#56B6C2"> !=</span><span style="color:#98C379"> ''</span><span style="color:#56B6C2"> &amp;&amp;</span><span style="color:#E06C75"> errMsg</span><span style="color:#56B6C2"> !=</span><span style="color:#D19A66"> undefined</span><span style="color:#ABB2BF">) {</span></span>
<span class="line"><span style="color:#C678DD">      return</span><span style="color:#61AFEF"> callback</span><span style="color:#ABB2BF">(</span><span style="color:#C678DD">new</span><span style="color:#61AFEF"> Error</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75">errMsg</span><span style="color:#ABB2BF">))</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#C678DD">    return</span><span style="color:#61AFEF"> callback</span><span style="color:#ABB2BF">(</span><span style="color:#C678DD">new</span><span style="color:#61AFEF"> Error</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">'å¯†ç ä¸èƒ½ä¸ºç©º'</span><span style="color:#ABB2BF">))</span></span>
<span class="line"><span style="color:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#61AFEF">  setTimeout</span><span style="color:#ABB2BF">(() </span><span style="color:#C678DD">=&gt;</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#C678DD">    if</span><span style="color:#ABB2BF"> (</span><span style="color:#E5C07B">passwordReg</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">test</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75">value</span><span style="color:#ABB2BF">)) {</span></span>
<span class="line"><span style="color:#61AFEF">      callback</span><span style="color:#ABB2BF">()</span></span>
<span class="line"><span style="color:#ABB2BF">    } </span><span style="color:#C678DD">else</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#61AFEF">      callback</span><span style="color:#ABB2BF">(</span><span style="color:#C678DD">new</span><span style="color:#61AFEF"> Error</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">'ä»¥å­—æ¯å¼€å¤´ï¼Œé•¿åº¦åœ¨5~16ä¹‹é—´ï¼Œåªèƒ½åŒ…å«å­—æ¯ã€æ•°å­—å’Œä¸‹åˆ’çº¿'</span><span style="color:#ABB2BF">))</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF">  }, </span><span style="color:#D19A66">100</span><span style="color:#ABB2BF">)</span></span>
<span class="line"><span style="color:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">/**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * ç”¨æˆ·è´¦å·éªŒè¯</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> */</span></span>
<span class="line"><span style="color:#C678DD">export</span><span style="color:#C678DD"> const</span><span style="color:#61AFEF"> accountValidate</span><span style="color:#56B6C2"> =</span><span style="color:#ABB2BF"> (</span><span style="color:#E06C75;font-style:italic">rule</span><span style="color:#ABB2BF">, </span><span style="color:#E06C75;font-style:italic">value</span><span style="color:#ABB2BF">, </span><span style="color:#E06C75;font-style:italic">callback</span><span style="color:#ABB2BF">) </span><span style="color:#C678DD">=&gt;</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#C678DD">  const</span><span style="color:#E5C07B"> accountReg</span><span style="color:#56B6C2"> =</span><span style="color:#E06C75"> /</span><span style="color:#C678DD">^</span><span style="color:#D19A66">[a-zA-Z0-9][a-zA-Z0-9_]{4,15}</span><span style="color:#C678DD">$</span><span style="color:#E06C75">/</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD">  if</span><span style="color:#ABB2BF"> (</span><span style="color:#56B6C2">!</span><span style="color:#E06C75">value</span><span style="color:#ABB2BF">) {</span></span>
<span class="line"><span style="color:#C678DD">    return</span><span style="color:#61AFEF"> callback</span><span style="color:#ABB2BF">(</span><span style="color:#C678DD">new</span><span style="color:#61AFEF"> Error</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">'è´¦å·ä¸èƒ½ä¸ºç©º'</span><span style="color:#ABB2BF">))</span></span>
<span class="line"><span style="color:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#61AFEF">  setTimeout</span><span style="color:#ABB2BF">(() </span><span style="color:#C678DD">=&gt;</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#C678DD">    if</span><span style="color:#ABB2BF"> (</span><span style="color:#E5C07B">accountReg</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">test</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75">value</span><span style="color:#ABB2BF">)) {</span></span>
<span class="line"><span style="color:#61AFEF">      callback</span><span style="color:#ABB2BF">()</span></span>
<span class="line"><span style="color:#ABB2BF">    } </span><span style="color:#C678DD">else</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#61AFEF">      callback</span><span style="color:#ABB2BF">(</span><span style="color:#C678DD">new</span><span style="color:#61AFEF"> Error</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">'ä»¥å­—æ¯æˆ–æ•°å­—å¼€å¤´ï¼Œé•¿åº¦åœ¨5~16ä¹‹é—´ï¼Œå…è®¸å­—æ¯ã€æ•°å­—å’Œä¸‹åˆ’çº¿'</span><span style="color:#ABB2BF">))</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF">  }, </span><span style="color:#D19A66">100</span><span style="color:#ABB2BF">)</span></span>
<span class="line"><span style="color:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">/**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * ç”µè¯å·ç éªŒè¯</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> */</span></span>
<span class="line"><span style="color:#C678DD">export</span><span style="color:#C678DD"> const</span><span style="color:#61AFEF"> phoneNumValidate</span><span style="color:#56B6C2"> =</span><span style="color:#ABB2BF"> (</span><span style="color:#E06C75;font-style:italic">rule</span><span style="color:#ABB2BF">, </span><span style="color:#E06C75;font-style:italic">value</span><span style="color:#ABB2BF">, </span><span style="color:#E06C75;font-style:italic">callback</span><span style="color:#ABB2BF">, </span><span style="color:#E06C75;font-style:italic">notNull</span><span style="color:#ABB2BF">) </span><span style="color:#C678DD">=&gt;</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#C678DD">  const</span><span style="color:#E5C07B"> phoneReg</span><span style="color:#56B6C2"> =</span><span style="color:#E06C75"> /</span><span style="color:#C678DD">^</span><span style="color:#E06C75">(13</span><span style="color:#D19A66">[0-9]</span><span style="color:#ABB2BF">|</span><span style="color:#E06C75">14</span><span style="color:#D19A66">[5|7]</span><span style="color:#ABB2BF">|</span><span style="color:#E06C75">15</span><span style="color:#D19A66">[0|1|2|3|4|5|6|7|8|9]</span><span style="color:#ABB2BF">|</span><span style="color:#E06C75">18</span><span style="color:#D19A66">[0|1|2|3|5|6|7|8|9]</span><span style="color:#E06C75">)\d</span><span style="color:#D19A66">{8}</span><span style="color:#C678DD">$</span><span style="color:#E06C75">/</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD">  if</span><span style="color:#ABB2BF"> (</span><span style="color:#56B6C2">!</span><span style="color:#E06C75">value</span><span style="color:#ABB2BF">) {</span></span>
<span class="line"><span style="color:#C678DD">    if</span><span style="color:#ABB2BF"> (</span><span style="color:#E06C75">notNull</span><span style="color:#ABB2BF">) {</span></span>
<span class="line"><span style="color:#C678DD">      return</span><span style="color:#61AFEF"> callback</span><span style="color:#ABB2BF">(</span><span style="color:#C678DD">new</span><span style="color:#61AFEF"> Error</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">'ç”µè¯å·ç ä¸èƒ½ä¸ºç©º'</span><span style="color:#ABB2BF">))</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#C678DD">    return</span><span style="color:#61AFEF"> callback</span><span style="color:#ABB2BF">()</span></span>
<span class="line"><span style="color:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#61AFEF">  setTimeout</span><span style="color:#ABB2BF">(() </span><span style="color:#C678DD">=&gt;</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#C678DD">    if</span><span style="color:#ABB2BF"> (</span><span style="color:#56B6C2">!</span><span style="color:#E5C07B">Number</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">isInteger</span><span style="color:#ABB2BF">(</span><span style="color:#56B6C2">+</span><span style="color:#E06C75">value</span><span style="color:#ABB2BF">)) {</span></span>
<span class="line"><span style="color:#61AFEF">      callback</span><span style="color:#ABB2BF">(</span><span style="color:#C678DD">new</span><span style="color:#61AFEF"> Error</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">'è¯·è¾“å…¥æ•°å­—å€¼'</span><span style="color:#ABB2BF">))</span></span>
<span class="line"><span style="color:#ABB2BF">    } </span><span style="color:#C678DD">else</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#C678DD">      if</span><span style="color:#ABB2BF"> (</span><span style="color:#E5C07B">phoneReg</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">test</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75">value</span><span style="color:#ABB2BF">)) {</span></span>
<span class="line"><span style="color:#61AFEF">        callback</span><span style="color:#ABB2BF">()</span></span>
<span class="line"><span style="color:#ABB2BF">      } </span><span style="color:#C678DD">else</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#61AFEF">        callback</span><span style="color:#ABB2BF">(</span><span style="color:#C678DD">new</span><span style="color:#61AFEF"> Error</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">'ç”µè¯å·ç æ ¼å¼ä¸æ­£ç¡®'</span><span style="color:#ABB2BF">))</span></span>
<span class="line"><span style="color:#ABB2BF">      }</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF">  }, </span><span style="color:#D19A66">100</span><span style="color:#ABB2BF">)</span></span>
<span class="line"><span style="color:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">/**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * ä¼ çœŸç”µè¯å·ç éªŒè¯</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> */</span></span>
<span class="line"><span style="color:#C678DD">export</span><span style="color:#C678DD"> const</span><span style="color:#61AFEF"> faxNumValidate</span><span style="color:#56B6C2"> =</span><span style="color:#ABB2BF"> (</span><span style="color:#E06C75;font-style:italic">rule</span><span style="color:#ABB2BF">, </span><span style="color:#E06C75;font-style:italic">value</span><span style="color:#ABB2BF">, </span><span style="color:#E06C75;font-style:italic">callback</span><span style="color:#ABB2BF">, </span><span style="color:#E06C75;font-style:italic">notNull</span><span style="color:#ABB2BF">) </span><span style="color:#C678DD">=&gt;</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#C678DD">  const</span><span style="color:#E5C07B"> faxReg</span><span style="color:#56B6C2"> =</span><span style="color:#E06C75"> /\d</span><span style="color:#D19A66">{3}</span><span style="color:#E06C75">-\d</span><span style="color:#D19A66">{8}</span><span style="color:#ABB2BF">|</span><span style="color:#E06C75">\d</span><span style="color:#D19A66">{4}</span><span style="color:#E06C75">-\d</span><span style="color:#D19A66">{7}</span><span style="color:#E06C75">/</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD">  if</span><span style="color:#ABB2BF"> (</span><span style="color:#56B6C2">!</span><span style="color:#E06C75">value</span><span style="color:#ABB2BF">) {</span></span>
<span class="line"><span style="color:#C678DD">    if</span><span style="color:#ABB2BF"> (</span><span style="color:#E06C75">notNull</span><span style="color:#ABB2BF">) {</span></span>
<span class="line"><span style="color:#C678DD">      return</span><span style="color:#61AFEF"> callback</span><span style="color:#ABB2BF">(</span><span style="color:#C678DD">new</span><span style="color:#61AFEF"> Error</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">'ä¼ çœŸç”µè¯å·ç ä¸èƒ½ä¸ºç©º'</span><span style="color:#ABB2BF">))</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#C678DD">    return</span><span style="color:#61AFEF"> callback</span><span style="color:#ABB2BF">()</span></span>
<span class="line"><span style="color:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#61AFEF">  setTimeout</span><span style="color:#ABB2BF">(() </span><span style="color:#C678DD">=&gt;</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#C678DD">    if</span><span style="color:#ABB2BF"> (</span><span style="color:#E5C07B">faxReg</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">test</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75">value</span><span style="color:#ABB2BF">)) {</span></span>
<span class="line"><span style="color:#61AFEF">      callback</span><span style="color:#ABB2BF">()</span></span>
<span class="line"><span style="color:#ABB2BF">    } </span><span style="color:#C678DD">else</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#61AFEF">      callback</span><span style="color:#ABB2BF">(</span><span style="color:#C678DD">new</span><span style="color:#61AFEF"> Error</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">'è¯·è¾“å…¥æ­£ç¡®æ ¼å¼çš„ä¼ çœŸç”µè¯å·ç '</span><span style="color:#ABB2BF">))</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF">  }, </span><span style="color:#D19A66">100</span><span style="color:#ABB2BF">)</span></span>
<span class="line"><span style="color:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">/**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * é‚®ç®±éªŒè¯</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> */</span></span>
<span class="line"><span style="color:#C678DD">export</span><span style="color:#C678DD"> const</span><span style="color:#61AFEF"> emailValidate</span><span style="color:#56B6C2"> =</span><span style="color:#ABB2BF"> (</span><span style="color:#E06C75;font-style:italic">rule</span><span style="color:#ABB2BF">, </span><span style="color:#E06C75;font-style:italic">value</span><span style="color:#ABB2BF">, </span><span style="color:#E06C75;font-style:italic">callback</span><span style="color:#ABB2BF">, </span><span style="color:#E06C75;font-style:italic">notNull</span><span style="color:#ABB2BF">) </span><span style="color:#C678DD">=&gt;</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">  // å¦ä¸€ä¸ªé‚®ç®±æ­£åˆ™ ^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$</span></span>
<span class="line"><span style="color:#C678DD">  const</span><span style="color:#E5C07B"> mailReg</span><span style="color:#56B6C2"> =</span><span style="color:#E06C75"> /</span><span style="color:#C678DD">^</span><span style="color:#D19A66">[A-Za-z</span><span style="color:#E06C75">\d</span><span style="color:#D19A66">]+</span><span style="color:#E06C75">(</span><span style="color:#D19A66">[-_</span><span style="color:#E06C75">.</span><span style="color:#D19A66">][A-Za-z</span><span style="color:#E06C75">\d</span><span style="color:#D19A66">]+</span><span style="color:#E06C75">)</span><span style="color:#D19A66">*</span><span style="color:#E06C75">@(</span><span style="color:#D19A66">[A-Za-z</span><span style="color:#E06C75">\d</span><span style="color:#D19A66">]+[-</span><span style="color:#E06C75">.</span><span style="color:#D19A66">]</span><span style="color:#E06C75">)</span><span style="color:#D19A66">+[A-Za-z</span><span style="color:#E06C75">\d</span><span style="color:#D19A66">]{2,4}</span><span style="color:#C678DD">$</span><span style="color:#E06C75">/</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD">  if</span><span style="color:#ABB2BF"> (</span><span style="color:#56B6C2">!</span><span style="color:#E06C75">value</span><span style="color:#ABB2BF">) {</span></span>
<span class="line"><span style="color:#C678DD">    if</span><span style="color:#ABB2BF"> (</span><span style="color:#E06C75">notNull</span><span style="color:#ABB2BF">) {</span></span>
<span class="line"><span style="color:#C678DD">      return</span><span style="color:#61AFEF"> callback</span><span style="color:#ABB2BF">(</span><span style="color:#C678DD">new</span><span style="color:#61AFEF"> Error</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">'é‚®ç®±ä¸èƒ½ä¸ºç©º'</span><span style="color:#ABB2BF">))</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#C678DD">    return</span><span style="color:#61AFEF"> callback</span><span style="color:#ABB2BF">()</span></span>
<span class="line"><span style="color:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#61AFEF">  setTimeout</span><span style="color:#ABB2BF">(() </span><span style="color:#C678DD">=&gt;</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#C678DD">    if</span><span style="color:#ABB2BF"> (</span><span style="color:#E5C07B">mailReg</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">test</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75">value</span><span style="color:#ABB2BF">)) {</span></span>
<span class="line"><span style="color:#61AFEF">      callback</span><span style="color:#ABB2BF">()</span></span>
<span class="line"><span style="color:#ABB2BF">    } </span><span style="color:#C678DD">else</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#61AFEF">      callback</span><span style="color:#ABB2BF">(</span><span style="color:#C678DD">new</span><span style="color:#61AFEF"> Error</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">'è¯·è¾“å…¥æ­£ç¡®æ ¼å¼çš„é‚®ç®±'</span><span style="color:#ABB2BF">))</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF">  }, </span><span style="color:#D19A66">100</span><span style="color:#ABB2BF">)</span></span>
<span class="line"><span style="color:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">/**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic"> * èº«ä»½è¯éªŒè¯</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">*/</span></span>
<span class="line"><span style="color:#C678DD">export</span><span style="color:#C678DD"> const</span><span style="color:#61AFEF"> identityNumValidate</span><span style="color:#56B6C2"> =</span><span style="color:#ABB2BF"> (</span><span style="color:#E06C75;font-style:italic">rule</span><span style="color:#ABB2BF">, </span><span style="color:#E06C75;font-style:italic">value</span><span style="color:#ABB2BF">, </span><span style="color:#E06C75;font-style:italic">callback</span><span style="color:#ABB2BF">, </span><span style="color:#E06C75;font-style:italic">notNull</span><span style="color:#ABB2BF">) </span><span style="color:#C678DD">=&gt;</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">  // èº«ä»½è¯æ­£åˆ™ (^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)</span></span>
<span class="line"><span style="color:#C678DD">  const</span><span style="color:#E5C07B"> mailReg</span><span style="color:#56B6C2"> =</span><span style="color:#E06C75"> /(</span><span style="color:#C678DD">^</span><span style="color:#E06C75">\d</span><span style="color:#D19A66">{15}</span><span style="color:#C678DD">$</span><span style="color:#E06C75">)</span><span style="color:#ABB2BF">|</span><span style="color:#E06C75">(</span><span style="color:#C678DD">^</span><span style="color:#E06C75">\d</span><span style="color:#D19A66">{18}</span><span style="color:#C678DD">$</span><span style="color:#E06C75">)</span><span style="color:#ABB2BF">|</span><span style="color:#E06C75">(</span><span style="color:#C678DD">^</span><span style="color:#E06C75">\d</span><span style="color:#D19A66">{17}</span><span style="color:#E06C75">(\d</span><span style="color:#ABB2BF">|</span><span style="color:#E06C75">X</span><span style="color:#ABB2BF">|</span><span style="color:#E06C75">x)</span><span style="color:#C678DD">$</span><span style="color:#E06C75">)/</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD">  if</span><span style="color:#ABB2BF"> (</span><span style="color:#56B6C2">!</span><span style="color:#E06C75">value</span><span style="color:#ABB2BF">) {</span></span>
<span class="line"><span style="color:#C678DD">    if</span><span style="color:#ABB2BF"> (</span><span style="color:#E06C75">notNull</span><span style="color:#ABB2BF">) {</span></span>
<span class="line"><span style="color:#C678DD">      return</span><span style="color:#61AFEF"> callback</span><span style="color:#ABB2BF">(</span><span style="color:#C678DD">new</span><span style="color:#61AFEF"> Error</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">'èº«ä»½è¯å·ç ä¸èƒ½ä¸ºç©º'</span><span style="color:#ABB2BF">))</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#C678DD">    return</span><span style="color:#61AFEF"> callback</span><span style="color:#ABB2BF">()</span></span>
<span class="line"><span style="color:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#61AFEF">  setTimeout</span><span style="color:#ABB2BF">(() </span><span style="color:#C678DD">=&gt;</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#C678DD">    if</span><span style="color:#ABB2BF"> (</span><span style="color:#E5C07B">mailReg</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">test</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75">value</span><span style="color:#ABB2BF">)) {</span></span>
<span class="line"><span style="color:#61AFEF">      callback</span><span style="color:#ABB2BF">()</span></span>
<span class="line"><span style="color:#ABB2BF">    } </span><span style="color:#C678DD">else</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#61AFEF">      callback</span><span style="color:#ABB2BF">(</span><span style="color:#C678DD">new</span><span style="color:#61AFEF"> Error</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">'è¯·è¾“å…¥æ­£ç¡®æ ¼å¼çš„èº«ä»½è¯å·ç '</span><span style="color:#ABB2BF">))</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF">  }, </span><span style="color:#D19A66">100</span><span style="color:#ABB2BF">)</span></span>
<span class="line"><span style="color:#ABB2BF">}</span></span></code></pre></td></tr></tbody></table>
      </figure>
<h2 id="9-7-index-js"><a class="header-anchor" href="#9-7-index-js"></a>9.7 index.js</h2>
<p>è·¯ç”±å‰ç½®å®ˆå«ï¼š</p>
<figure class="highlight js line-numbers" data-language="JS">
        <table style="background-color: #282c34"><tbody><tr><td class="gutter" style="background-color: #282c34"><pre style="background-color: #282c34"><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code" style="background-color: #282c34"><pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic">// å…¨å±€å‰ç½®å®ˆå«</span></span>
<span class="line"><span style="color:#E5C07B">router</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">beforeEach</span><span style="color:#ABB2BF">((</span><span style="color:#E06C75;font-style:italic">to</span><span style="color:#ABB2BF">, </span><span style="color:#E06C75;font-style:italic">from</span><span style="color:#ABB2BF">, </span><span style="color:#E06C75;font-style:italic">next</span><span style="color:#ABB2BF">) </span><span style="color:#C678DD">=&gt;</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">  /*</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">   *  to å°†è¦è®¿é—®çš„è·¯å¾„</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">   * from ä»å“ªä¸ªè·¯å¾„è·³è½¬è€Œæ¥</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">   * next  ä¸€ä¸ªå‡½æ•°ï¼Œè¡¨ç¤ºæ”¾è¡Œ</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">   * next() æ”¾è¡Œ next('/xxx') å¼ºåˆ¶è·³è½¬</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">   */</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">  // ç•Œé¢ Title</span></span>
<span class="line"><span style="color:#C678DD">  if</span><span style="color:#ABB2BF"> (</span><span style="color:#E5C07B">to</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">meta</span><span style="color:#ABB2BF">.</span><span style="color:#E06C75">title</span><span style="color:#ABB2BF">) {</span></span>
<span class="line"><span style="color:#E5C07B">    document</span><span style="color:#ABB2BF">.</span><span style="color:#E06C75">title</span><span style="color:#56B6C2"> =</span><span style="color:#E5C07B"> to</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">meta</span><span style="color:#ABB2BF">.</span><span style="color:#E06C75">title</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#ABB2BF">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD">  if</span><span style="color:#ABB2BF"> (</span><span style="color:#E5C07B">to</span><span style="color:#ABB2BF">.</span><span style="color:#E06C75">path</span><span style="color:#56B6C2"> ===</span><span style="color:#98C379"> '/'</span><span style="color:#ABB2BF">) </span><span style="color:#C678DD">return</span><span style="color:#61AFEF"> next</span><span style="color:#ABB2BF">();</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">  // è·å– token ä¿¡æ¯</span></span>
<span class="line"><span style="color:#C678DD">  const</span><span style="color:#E5C07B"> token</span><span style="color:#56B6C2"> =</span><span style="color:#E5C07B"> window</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">localStorage</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">getItem</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">'token'</span><span style="color:#ABB2BF">);</span></span>
<span class="line"><span style="color:#C678DD">  if</span><span style="color:#ABB2BF"> (</span><span style="color:#E06C75">token</span><span style="color:#56B6C2"> ===</span><span style="color:#D19A66"> null</span><span style="color:#56B6C2"> ||</span><span style="color:#E06C75"> token</span><span style="color:#56B6C2"> ===</span><span style="color:#98C379"> ''</span><span style="color:#ABB2BF">) {</span></span>
<span class="line"><span style="color:#C678DD">    return</span><span style="color:#61AFEF"> next</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">'/'</span><span style="color:#ABB2BF">);</span></span>
<span class="line"><span style="color:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#61AFEF">  next</span><span style="color:#ABB2BF">();</span></span>
<span class="line"><span style="color:#ABB2BF">})</span></span></code></pre></td></tr></tbody></table>
      </figure>
<h1 id="10-Element-UI-çš„ä½¿ç”¨"><a class="header-anchor" href="#10-Element-UI-çš„ä½¿ç”¨"></a>10. Element-UI çš„ä½¿ç”¨</h1>
<h2 id="10-1-åœ¨è¡¨å•æŒ‡å®šå­—æ®µä¸‹æç¤ºé”™è¯¯ä¿¡æ¯"><a class="header-anchor" href="#10-1-åœ¨è¡¨å•æŒ‡å®šå­—æ®µä¸‹æç¤ºé”™è¯¯ä¿¡æ¯"></a>10.1 åœ¨è¡¨å•æŒ‡å®šå­—æ®µä¸‹æç¤ºé”™è¯¯ä¿¡æ¯</h2>
<p>æ¯”å¦‚ï¼Œåœ¨ä¸Šä¼ è€ƒè¯•ç§‘ç›®ä¿¡æ¯æ—¶ï¼Œå¯¹è€ƒè¯•ç§‘ç›®ç±»å‹è¿›è¡Œæ ¡éªŒï¼Œå¹¶ä¸”è€ƒè¯•ç§‘ç›®ç±»å‹å­—æ®µæ‰€åœ¨çš„è¾“å…¥æ¡†ç±»å‹ä¸ºä¸‹æ‹‰æ¡†ã€‚</p>
<p>å…ˆåœ¨ <code>data</code> ä¸­æŒ‡å®šé”™è¯¯ä¿¡æ¯ï¼š</p>
<figure class="highlight js line-numbers" data-language="JS">
        <table style="background-color: #282c34"><tbody><tr><td class="gutter" style="background-color: #282c34"><pre style="background-color: #282c34"><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code" style="background-color: #282c34"><pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF">data</span><span style="color:#ABB2BF">() {</span></span>
<span class="line"><span style="color:#C678DD">    return</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">      // é”™è¯¯ä¿¡æ¯</span></span>
<span class="line"><span style="color:#E06C75">      examTypeError</span><span style="color:#ABB2BF">: </span><span style="color:#D19A66">null</span><span style="color:#ABB2BF">,</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF">}</span></span></code></pre></td></tr></tbody></table>
      </figure>
<p>ç„¶ååœ¨ <code>el-form-item</code> ç»„ä»¶ä¸Šä½¿ç”¨ <code>error</code> å±æ€§ï¼Œç»‘å®šé”™è¯¯ä¿¡æ¯ï¼š</p>
<figure class="highlight plaintext line-numbers" data-language="PLAINTEXT">
        <table style="background-color: #282c34"><tbody><tr><td class="gutter" style="background-color: #282c34"><pre style="background-color: #282c34"><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code" style="background-color: #282c34"><pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span>&lt;el-form-item :error="examTypeError"&gt;</span></span>
<span class="line"><span>    &lt;el-select</span></span>
<span class="line"><span>       @blur="selectValueValidate"</span></span>
<span class="line"><span>       @change="selectValueValidate"</span></span>
<span class="line"><span>    &gt;&lt;/el-select&gt;</span></span>
<span class="line"><span>&lt;/el-form-item&gt;</span></span></code></pre></td></tr></tbody></table>
      </figure>
<p>ç”±äºä½¿ç”¨ Element-UI è‡ªå¸¦çš„æ ¡éªŒå¯¹ Select ç»„ä»¶è¿›è¡Œæ ¡éªŒæ—¶æ— æ³•å‡†ç¡®åœ°æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯ï¼Œå› æ­¤åœ¨æ­¤ä½¿ç”¨äº‹ä»¶çš„æ–¹å¼è¿›è¡Œæ ¡éªŒï¼Œå¹¶æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯ã€‚</p>
<p>æœ€åç¼–å†™é”™è¯¯æ ¡éªŒæ–¹æ³•å³å¯ï¼š</p>
<figure class="highlight js line-numbers" data-language="JS">
        <table style="background-color: #282c34"><tbody><tr><td class="gutter" style="background-color: #282c34"><pre style="background-color: #282c34"><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code" style="background-color: #282c34"><pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF">selectValueValidate</span><span style="color:#ABB2BF">() {</span></span>
<span class="line"><span style="color:#C678DD">    if</span><span style="color:#ABB2BF"> (</span><span style="color:#E5C07B">this</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">subjectForm</span><span style="color:#ABB2BF">.</span><span style="color:#E06C75">examType</span><span style="color:#56B6C2"> ==</span><span style="color:#D19A66"> null</span><span style="color:#ABB2BF">) {</span></span>
<span class="line"><span style="color:#E5C07B">        this</span><span style="color:#ABB2BF">.</span><span style="color:#E06C75">examTypeError</span><span style="color:#56B6C2"> =</span><span style="color:#E5C07B"> Math</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">random</span><span style="color:#ABB2BF">().</span><span style="color:#61AFEF">toString</span><span style="color:#ABB2BF">();</span></span>
<span class="line"><span style="color:#E5C07B">        this</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">$nextTick</span><span style="color:#ABB2BF">(() </span><span style="color:#C678DD">=&gt;</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#E5C07B">            this</span><span style="color:#ABB2BF">.</span><span style="color:#E06C75">examTypeError</span><span style="color:#56B6C2"> =</span><span style="color:#98C379"> "è€ƒè¯•ç§‘ç›®ç±»å‹ä¸èƒ½ä¸ºç©º"</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#ABB2BF">        });</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF">}</span></span></code></pre></td></tr></tbody></table>
      </figure>
<p><code>&lt;el-form-item&gt;</code> çš„ <code>error</code> å±æ€§ç›‘å¬çš„æ˜¯ <code>watch</code> æ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯ä¸¤æ¬¡é‡å¤çš„é”™è¯¯æ“ä½œï¼Œæç¤ºçš„é”™è¯¯ä¿¡æ¯ä¸€è‡´ï¼Œå°±ä¸ä¼šè§¦å‘ watch æ–¹æ³•ã€‚</p>
<p>Element-UI è¡¨å•ç»„ä»¶è§„å®šä¸€æ—¦è¡¨å•éªŒè¯é€šè¿‡å°±ä¼šæ¸…é™¤åŸæ¥çš„é”™è¯¯æç¤ºä¿¡æ¯ï¼Œè¿™æ ·å°±å¯¼è‡´äº†åœ¨è¿›è¡Œç¬¬äºŒæ¬¡éªŒè¯æ—¶åŸæ¥çš„é”™è¯¯ä¿¡æ¯è¢«æ¸…é™¤äº†ï¼Œè€Œä¸¤æ¬¡é”™è¯¯ä¿¡æ¯åˆä¸€è‡´æ²¡æ³•è§¦å‘ <code>watch</code> æ–¹æ³•ï¼Œæ‰€ä»¥ä¹Ÿä¸ä¼šé‡æ–°æ¸²æŸ“å‡ºæ–°çš„é”™è¯¯ä¿¡æ¯å‡ºæ¥ã€‚</p>
<p>è§£å†³æ–¹æ³•å¾ˆç®€å•ï¼šä½¿ç”¨ <code>$nextTick</code> æ¥ä¿®å¤è¿™ä¸ªé—®é¢˜ã€‚</p>
<p><code>vm.$nextTick</code> å¯ä»¥å°†å›è°ƒå»¶è¿Ÿåˆ°ä¸‹æ¬¡ DOM æ›´æ–°å¾ªç¯ä¹‹åæ‰§è¡Œã€‚åœ¨ä¿®æ”¹æ•°æ®ä¹‹åç«‹å³ä½¿ç”¨å®ƒï¼Œç„¶åç­‰å¾… DOM æ›´æ–°ã€‚æˆ‘ä»¬çŸ¥é“é”™è¯¯æç¤ºä¸æ˜¾ç¤ºçš„æ ¹æœ¬åŸå› æ˜¯ watch æ–¹æ³•æ²¡æœ‰è¢«è§¦å‘ã€‚é‚£å¦‚æœæˆ‘æ¯æ¬¡ç»™é”™è¯¯èµ‹å€¼ä¸€ä¸ªéšæœºå€¼ï¼Œç„¶åä½¿ç”¨ <code>$nextTick</code> åœ¨ DOM è¢«æ›´æ–°ä¹‹åå°†éšæœºå€¼æ”¹æˆæˆ‘ä»¬éœ€è¦çš„é”™è¯¯ä¿¡æ¯å°±å¯ä»¥äº†ã€‚</p>
<h2 id="10-2-el-select-è®¾ç½®-multiple-åå‡ºç°çš„é—®é¢˜"><a class="header-anchor" href="#10-2-el-select-è®¾ç½®-multiple-åå‡ºç°çš„é—®é¢˜"></a>10.2 el-select è®¾ç½® multiple åå‡ºç°çš„é—®é¢˜</h2>
<p>è®¾ç½® <code>&lt;el-select&gt;</code> çš„ <code>multiple</code> å±æ€§ï¼Œå¹¶ä¸ºè¯¥ç»„ä»¶ç»‘å®š Element UI çš„è¡¨å•éªŒè¯åï¼Œä¼šå‡ºç° <strong>ä¸€è¿›ç•Œé¢å°±æ ¡éªŒå¤±è´¥çš„é”™è¯¯æç¤ºä¿¡æ¯</strong>ï¼Œä¸ºè§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥åœ¨å½“å‰æ‰€åœ¨ Vue çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°ä¸­æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š</p>
<figure class="highlight js line-numbers" data-language="JS">
        <table style="background-color: #282c34"><tbody><tr><td class="gutter" style="background-color: #282c34"><pre style="background-color: #282c34"><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code" style="background-color: #282c34"><pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF">created</span><span style="color:#ABB2BF">() {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    // é˜²æ­¢å‡ºç°ä¸€è¿›ç•Œé¢å°±æ ¡éªŒé”™è¯¯çš„æƒ…å†µ</span></span>
<span class="line"><span style="color:#E5C07B">    this</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">$set</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">this</span><span style="color:#ABB2BF">.</span><span style="color:#E06C75">userForm</span><span style="color:#ABB2BF">, </span><span style="color:#98C379">"roleList"</span><span style="color:#ABB2BF">, []);</span></span>
<span class="line"><span style="color:#ABB2BF">},</span></span></code></pre></td></tr></tbody></table>
      </figure>
<p>å…¶ä¸­ï¼Œ<code>this.userForm</code> æ˜¯ data åŸŸä¸­çš„è¡¨å•æ•°æ®ï¼Œå¦‚ï¼š</p>
<figure class="highlight js line-numbers" data-language="JS">
        <table style="background-color: #282c34"><tbody><tr><td class="gutter" style="background-color: #282c34"><pre style="background-color: #282c34"><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code" style="background-color: #282c34"><pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF">data</span><span style="color:#ABB2BF">() {</span></span>
<span class="line"><span style="color:#C678DD">    return</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#E06C75">      userForm</span><span style="color:#ABB2BF">: {},</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF">}</span></span></code></pre></td></tr></tbody></table>
      </figure>
<p>è€Œ <code>roleList</code> æ˜¯åœ¨ä½¿ç”¨æ ¡éªŒæ—¶ï¼ŒElement UI <code>&lt;el-select&gt;</code> ç»„ä»¶æ‰€åœ¨çš„ <code>&lt;el-form-item&gt;</code> ç»„ä»¶ç»‘å®šçš„ <code>prop</code> çš„å€¼ï¼Œå¦‚ï¼š</p>
<figure class="highlight plaintext line-numbers" data-language="PLAINTEXT">
        <table style="background-color: #282c34"><tbody><tr><td class="gutter" style="background-color: #282c34"><pre style="background-color: #282c34"><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code" style="background-color: #282c34"><pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span>&lt;el-form-item prop="roleList"&gt;</span></span>
<span class="line"><span>    &lt;el-select v-model="userForm.roleList" multiple &gt;</span></span>
<span class="line"><span>        &lt;!----&gt;</span></span>
<span class="line"><span>    &lt;/el-select&gt;</span></span>
<span class="line"><span>&lt;/el-form-item&gt;</span></span></code></pre></td></tr></tbody></table>
      </figure>
<p>å½“ <code>&lt;el-select&gt;</code> ç»„ä»¶è¢«è®¾ç½®äº† <code>multiple</code> å±æ€§åï¼Œå…¶ç»‘å®šçš„æ•°æ®ç±»å‹å°†ä¼šå˜ä¸ºä¸€ä¸ªæ•°ç»„ï¼Œå› æ­¤éœ€è¦å°†å…¶è®¾ç½®ä¸º <code>[]</code>ã€‚</p>
<p>è€Œå‡ºç°è¿™ç§é—®é¢˜çš„åŸå› ä¹Ÿå¾ˆç®€å•ï¼Œå½“ <code>&lt;el-select&gt;</code> ç»„ä»¶è¢«è®¾ç½®äº† <code>multiple</code> å±æ€§åï¼Œåˆæ¬¡è¿›å…¥è¿™ä¸ªè¿™ä»¶çš„æ‰€åœ¨çš„é¡µé¢æ—¶ï¼Œå°†ä¼šè‡ªåŠ¨è§¦å‘ <code>&lt;el-select&gt;</code> ç»„ä»¶çš„ <code>change</code> äº‹ä»¶ï¼Œè€Œç”±äºæˆ‘ä»¬ <code>data</code> åŸŸä¸­è¡¨å•æ•°æ®åˆå§‹åŒ–ä¸º <code>userForm: {}</code>ï¼ŒElement UI å°±ä¼šè®¤å®šå€¼ç¼ºå¤±ï¼Œå¹¶æ˜¾ç¤ºæ ¡éªŒå¤±è´¥çš„é”™è¯¯æç¤ºä¿¡æ¯ã€‚</p>
<blockquote>
<p>è¡¥å……</p>
</blockquote>
<p>è€Œæˆ‘åœ¨ä½¿ç”¨æ—¶ï¼Œæ˜¯åœ¨ Element UI dialog å¯¹è¯æ¡†ä¸­ä½¿ç”¨äº† <code>&lt;el-select&gt;</code> ç»„ä»¶ï¼Œå¹¶ä¸”å°†è¿™ä¸ªå¯¹è¯æ¡†å†™åœ¨äº†å¦ä¸€ä¸ª <code>vue</code> æ–‡ä»¶ä¸­ã€‚</p>
<p>ä¸ºäº†åœ¨ç¬¬äºŒæ¬¡æ‰“å¼€ dialog æ—¶ï¼Œå°†ç»‘å®šæ•°æ®å’Œæ ¡éªŒä¿¡æ¯æ¸…ç©ºï¼Œå› æ­¤ä¸º <code>&lt;el-dialog&gt;</code> ç»„ä»¶ç»‘å®šäº† <code>close</code> æ–¹æ³•ï¼Œä½¿å…¶åœ¨å…³é—­ dialog æ—¶ï¼Œå¯ä»¥æ¸…ç©ºç»‘å®šæ•°æ®å’Œæ ¡éªŒä¿¡æ¯æ¸…ç©ºã€‚å¦‚ï¼š</p>
<figure class="highlight plaintext line-numbers" data-language="PLAINTEXT">
        <table style="background-color: #282c34"><tbody><tr><td class="gutter" style="background-color: #282c34"><pre style="background-color: #282c34"><span class="line">1</span><br></pre></td><td class="code" style="background-color: #282c34"><pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span>&lt;el-dialog @close="closeSaveOrUpdateDialog"&gt;</span></span></code></pre></td></tr></tbody></table>
      </figure>
<figure class="highlight js line-numbers" data-language="JS">
        <table style="background-color: #282c34"><tbody><tr><td class="gutter" style="background-color: #282c34"><pre style="background-color: #282c34"><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code" style="background-color: #282c34"><pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF">closeSaveOrUpdateDialog</span><span style="color:#ABB2BF">() {</span></span>
<span class="line"><span style="color:#E5C07B">    this</span><span style="color:#ABB2BF">.</span><span style="color:#E06C75">userForm</span><span style="color:#56B6C2"> =</span><span style="color:#ABB2BF"> {};</span></span>
<span class="line"><span style="color:#61AFEF">    resetForm</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">this</span><span style="color:#ABB2BF">, </span><span style="color:#98C379">"userForm"</span><span style="color:#ABB2BF">);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    // é˜²æ­¢å‡ºç°ä¸€è¿›ç•Œé¢å°±æ ¡éªŒé”™è¯¯çš„æƒ…å†µ</span></span>
<span class="line"><span style="color:#E5C07B">    this</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">$set</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">this</span><span style="color:#ABB2BF">.</span><span style="color:#E06C75">userForm</span><span style="color:#ABB2BF">, </span><span style="color:#98C379">"roleList"</span><span style="color:#ABB2BF">, []);</span></span>
<span class="line"><span style="color:#ABB2BF">},</span></span></code></pre></td></tr></tbody></table>
      </figure>
<p>æ³¨æ„ï¼Œç”±äºè¿™é‡Œç›´æ¥å°† <code>this.userForm</code> è®¾ç½®ä¸º <code>{}</code>ï¼Œåˆå‡ºç°äº†å‰é¢çš„é—®é¢˜ï¼Œ<strong>å› æ­¤åœ¨è¿™æ–¹æ³•æœ€åä¹Ÿè¦è®¾ç½®ä¸€ä¸‹ã€‚</strong></p>
<p>å¦åˆ™å°±ä¼šå‡ºç°ä»¥ä¸‹æƒ…å†µï¼šç¬¬ä¸€æ¬¡æ‰“å¼€ dialog ä¸ä¼šè§¦å‘å¼‚å¸¸æ ¡éªŒï¼Œå•¥éƒ½ä¸å¹²ï¼Œå†æ¬¡æ‰“å¼€æ—¶å°±åˆä¼šè§¦å‘å¼‚å¸¸æ ¡éªŒã€‚</p>
<hr>
<p>å¦‚æœ <code>&lt;el-select&gt;</code> ç»„ä»¶è¢«è®¾ç½®äº† <code>multiple</code> å±æ€§åï¼Œå‡ºç°äº†æ•°æ®æ— æ³•å›æ˜¾ï¼Œæˆ–æ•°æ®æ— æ³•ç¼–è¾‘çš„æƒ…å†µï¼Œå¯ä»¥ä¸º <code>&lt;el-select&gt;</code> ç»„ä»¶ç»‘å®š <code>change</code> äº‹ä»¶ï¼Œå¹¶åœ¨è¿™ä¸ªäº‹ä»¶ç»‘å®šçš„æ–¹æ³•ä¸­æ‰§è¡Œï¼š</p>
<figure class="highlight js line-numbers" data-language="JS">
        <table style="background-color: #282c34"><tbody><tr><td class="gutter" style="background-color: #282c34"><pre style="background-color: #282c34"><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code" style="background-color: #282c34"><pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF">changeSelect</span><span style="color:#ABB2BF">() {</span></span>
<span class="line"><span style="color:#E5C07B">    this</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">$forceUpdate</span><span style="color:#ABB2BF">()</span></span>
<span class="line"><span style="color:#ABB2BF">}</span></span></code></pre></td></tr></tbody></table>
      </figure>
<p>è¿™æ˜¯å› ä¸ºç”±äºä¸€äº›åµŒå¥—ç‰¹åˆ«æ·±çš„æ•°æ®ï¼Œå¯¼è‡´æ•°æ®æ›´æ–°äº†ï¼Œä½†æ˜¯é¡µé¢å´æ²¡æœ‰é‡æ–°æ¸²æŸ“ï¼Œéœ€è¦ä½¿ç”¨ <code>this.$forceUpdate()</code> è¿«ä½¿ Vue å®ä¾‹é‡æ–°æ¸²æŸ“ã€‚</p>
<blockquote>
<p>ç»éªŒä¹‹è°ˆ</p>
</blockquote>
<p>é’ˆå¯¹é¡µé¢ä¸Š data åŸŸä¸­åŒä¸€æ•°æ®çš„ç»‘å®šï¼Œæœ€å¥½ä½¿ç”¨ä¸€æ¬¡è¯·æ±‚å®Œæˆï¼Œè€Œä¸æ˜¯å‘åå°å‘é€å¤šæ¬¡è¯·æ±‚ã€‚</p>
<p>æ¯”å¦‚ï¼Œdata åŸŸä¸­æœ‰ä¸€å¦‚ä¸‹æ•°æ®ï¼š</p>
<figure class="highlight js line-numbers" data-language="JS">
        <table style="background-color: #282c34"><tbody><tr><td class="gutter" style="background-color: #282c34"><pre style="background-color: #282c34"><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code" style="background-color: #282c34"><pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#61AFEF">data</span><span style="color:#ABB2BF">() {</span></span>
<span class="line"><span style="color:#C678DD">    return</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#E06C75">      userForm</span><span style="color:#ABB2BF">: {},</span></span>
<span class="line"><span style="color:#ABB2BF">    }</span></span>
<span class="line"><span style="color:#ABB2BF">}</span></span></code></pre></td></tr></tbody></table>
      </figure>
<p>å¾ˆæ˜æ˜¾ï¼Œ<code>userForm</code> æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡ä¸­å¯èƒ½æœ‰å¤šä¸ªå±æ€§ï¼Œå½“æˆ‘ä»¬å‘åå°å‘é€è¯·æ±‚ï¼Œä¸ºè¿™ä¸ªå¯¹è±¡ç»‘å®šæ•°æ®æ—¶ï¼Œæœ€å¥½æ˜¯åœ¨ä¸€æ¬¡è¯·æ±‚å®Œæˆåå°±ä¸ºè¿™ä¸ªå¯¹è±¡ç»‘å®šæ•°æ®ã€‚è€Œä¸æ˜¯å…ˆå‘é€ä¸€æ¬¡è¯·æ±‚ï¼Œç»‘å®šè¯¥å¯¹è±¡ä¸­ Aã€B å±æ€§çš„å€¼ï¼Œå†å‘é€ä¸€æ¬¡è¯·æ±‚ç»‘å®šè¯¥å¯¹è±¡ä¸­ C å±æ€§çš„å€¼ã€‚</p>
<h1 id="11-å‰ç«¯-å…¶ä»–"><a class="header-anchor" href="#11-å‰ç«¯-å…¶ä»–"></a>11. å‰ç«¯ - å…¶ä»–</h1>
<h2 id="11-1-åç«¯-ID-å¼‚å¸¸"><a class="header-anchor" href="#11-1-åç«¯-ID-å¼‚å¸¸"></a>11.1 åç«¯ ID å¼‚å¸¸</h2>
<p>ç”±äº JS çš„ç²¾åº¦æ‰€é™ï¼Œå½“åç«¯çš„ ID ä¿¡æ¯ï¼ˆ<code>Long</code> ç±»å‹ï¼‰ä¼ é€’åˆ°å‰ç«¯æ—¶ä¼šå‡ºç°ç²¾åº¦ç¼ºå¤±ï¼Œå› æ­¤åç«¯åº”å½“å°† <code>Long</code> ç±»å‹çš„ ID ä¿¡æ¯è½¬æ¢æˆå­—ç¬¦ä¸²ä¼ é€’ç»™å‰ç«¯ã€‚</p>
<p>é’ˆå¯¹è¿™ç§æƒ…å†µï¼Œåç«¯å¯ä»¥åœ¨è¡¨ç¤º ID çš„å­—æ®µä¸Šä½¿ç”¨ Jackson çš„æ³¨è§£ï¼Œå¦‚ï¼š</p>
<figure class="highlight java line-numbers" data-language="JAVA">
        <table style="background-color: #282c34"><tbody><tr><td class="gutter" style="background-color: #282c34"><pre style="background-color: #282c34"><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code" style="background-color: #282c34"><pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic">/**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">* ä¸»é”®</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">*/</span></span>
<span class="line"><span style="color:#ABB2BF">@</span><span style="color:#E5C07B">JsonSerialize</span><span style="color:#E06C75">(</span><span style="color:#D19A66">using</span><span style="color:#56B6C2"> =</span><span style="color:#E5C07B"> ToStringSerializer</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">class</span><span style="color:#E06C75">)</span></span>
<span class="line"><span style="color:#C678DD">private</span><span style="color:#E5C07B"> Long</span><span style="color:#E06C75"> id</span><span style="color:#ABB2BF">;</span></span></code></pre></td></tr></tbody></table>
      </figure>
<h2 id="11-2-Token-ä¿¡æ¯çš„å­˜å‚¨"><a class="header-anchor" href="#11-2-Token-ä¿¡æ¯çš„å­˜å‚¨"></a>11.2 Token ä¿¡æ¯çš„å­˜å‚¨</h2>
<p>ç”¨æˆ·æˆåŠŸç™»å½•åï¼Œåç«¯ä¼šå°†å½“å‰ç”¨æˆ·çš„ Token ä¿¡æ¯å­˜å‚¨åœ¨å“åº”å¤´ä¸­ï¼Œå‰ç«¯åº”å½“æ‹¿åˆ°è¿™ä¸ª Token ä¿¡æ¯ï¼Œå¹¶åœ¨æ¯æ¬¡å‘åç«¯å‘é€è¯·æ±‚æ—¶æºå¸¦è¿™ä¸ª Token ä¿¡æ¯ç”¨äºç”¨æˆ·éªŒè¯ã€‚</p>
<p>è·å–å“åº”å¤´ä¸­ Token ä¿¡æ¯çš„æ–¹å¼ï¼š</p>
<figure class="highlight js line-numbers" data-language="JS">
        <table style="background-color: #282c34"><tbody><tr><td class="gutter" style="background-color: #282c34"><pre style="background-color: #282c34"><span class="line">1</span><br></pre></td><td class="code" style="background-color: #282c34"><pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#E5C07B">window</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">localStorage</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">setItem</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">"token"</span><span style="color:#ABB2BF">, </span><span style="color:#E5C07B">res</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">headers</span><span style="color:#ABB2BF">.</span><span style="color:#E06C75">authorization</span><span style="color:#ABB2BF">);</span></span></code></pre></td></tr></tbody></table>
      </figure>
<p>å…¶ä¸­ï¼Œ<code>res</code> ä¸º Axios è¯·æ±‚å‘é€æˆåŠŸåçš„å“åº”ä½“ã€‚</p>
<p>åœ¨è¿™é‡Œï¼Œæˆ‘å°† Token ä¿¡æ¯å­˜å‚¨åˆ° <code>localStorage</code> ä¸­ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥å­˜å‚¨åˆ° <code>sessionStorage</code> ä¸­ï¼Œè¿™ä¸¤è€…ä¸ <code>cookie</code> çš„åŒºåˆ«<sup class="footnote-ref"><a href="#fn4" id="fnref4">[4]</a></sup>å¦‚ä¸‹ï¼š</p>
<p>1ã€cookie æ•°æ®å§‹ç»ˆåœ¨åŒæºçš„ http è¯·æ±‚ä¸­æºå¸¦ï¼ˆå³ä½¿ä¸éœ€è¦ï¼‰ï¼Œå³ cookie åœ¨æµè§ˆå™¨å’ŒæœåŠ¡å™¨é—´æ¥å›ä¼ é€’ï¼Œè€Œ sessionStorage å’Œ localStorage ä¸ä¼šè‡ªåŠ¨æŠŠæ•°æ®å‘é€ç»™æœåŠ¡å™¨ï¼Œä»…åœ¨æœ¬åœ°ä¿å­˜ã€‚cookie æ•°æ®è¿˜æœ‰è·¯å¾„ï¼ˆpathï¼‰çš„æ¦‚å¿µï¼Œå¯ä»¥é™åˆ¶ cookie åªå±äºæŸä¸ªè·¯å¾„ä¸‹</p>
<p>2ã€å­˜å‚¨å¤§å°é™åˆ¶ä¹Ÿä¸åŒã€‚cookie æ•°æ®ä¸èƒ½è¶…è¿‡ 4Kï¼ŒåŒæ—¶å› ä¸ºæ¯æ¬¡ http è¯·æ±‚éƒ½ä¼šæºå¸¦ cookieï¼Œæ‰€ä»¥ cookie åªé€‚åˆä¿å­˜å¾ˆå°çš„æ•°æ®ï¼Œå¦‚ä¼šè¯æ ‡è¯†ã€‚sessionStorage å’Œ localStorage è™½ç„¶ä¹Ÿæœ‰å­˜å‚¨å¤§å°çš„é™åˆ¶ï¼Œä½†æ¯” cookie å¤§å¾—å¤šï¼Œå¯ä»¥è¾¾åˆ° 5M æˆ–æ›´å¤§</p>
<p>3ã€æ•°æ®æœ‰æ•ˆæœŸä¸åŒã€‚sessionStorage ä»…åœ¨å½“å‰æµè§ˆå™¨çª—å£å…³é—­ä¹‹å‰æœ‰æ•ˆï¼›localStorage å§‹ç»ˆæœ‰æ•ˆï¼Œçª—å£æˆ–æµè§ˆå™¨å…³é—­ä¹Ÿä¸€ç›´ä¿å­˜ï¼Œå› æ­¤ç”¨ä½œæŒä¹…æ•°æ®ï¼›cookie åªåœ¨è®¾ç½®çš„ cookie è¿‡æœŸæ—¶é—´ä¹‹å‰æœ‰æ•ˆï¼Œå³ä½¿çª—å£å…³é—­æˆ–æµè§ˆå™¨å…³é—­</p>
<p>4ã€ä½œç”¨åŸŸä¸åŒã€‚sessionStorage ä¸åœ¨ä¸åŒçš„æµè§ˆå™¨çª—å£ä¸­å…±äº«ï¼Œå³ä½¿æ˜¯åŒä¸€ä¸ªé¡µé¢ï¼›localstorage åœ¨æ‰€æœ‰åŒæºçª—å£ä¸­éƒ½æ˜¯å…±äº«çš„ï¼›cookie ä¹Ÿæ˜¯åœ¨æ‰€æœ‰åŒæºçª—å£ä¸­éƒ½æ˜¯å…±äº«çš„</p>
<p>5ã€web Storage æ”¯æŒäº‹ä»¶é€šçŸ¥æœºåˆ¶ï¼Œå¯ä»¥å°†æ•°æ®æ›´æ–°çš„é€šçŸ¥å‘é€ç»™ç›‘å¬è€…</p>
<p>6ã€web Storage çš„ api æ¥å£ä½¿ç”¨æ›´æ–¹ä¾¿</p>
<p><code>localStorage</code> çš„ä½¿ç”¨æ–¹å¼å¾ˆç®€å•ï¼Œå‚è€ƒã€localStorage ä½¿ç”¨æ€»ç»“ã€‘<sup class="footnote-ref"><a href="#fn5" id="fnref5">[5]</a></sup>ä¸€æ–‡ã€‚</p>
<h1 id="12-ç»“è¯­"><a class="header-anchor" href="#12-ç»“è¯­"></a>12. ç»“è¯­</h1>
<p>ä»¥ä¸Šå°±æ˜¯æˆ‘æœ¬æ¬¡æ¯•ä¸šè®¾è®¡ä¸€ä¸ªç®€å•çš„æ€»ç»“ï¼Œç”±äºä»£ç é‡æ¯”è¾ƒå¤§ï¼Œå¯èƒ½æœ‰äº›åœ°æ–¹å¹¶ä¸å®Œå–„ï¼Œå¦‚æœæœ‰ä¸å®Œå–„çš„åœ°æ–¹åç»­å†è¡¥å……å§ã€‚</p>
<p>å›æœ›æ•´ä¸ªè¿‡ç¨‹ï¼Œå…¶å®è¿™æ¬¡æ¯•ä¸šè®¾è®¡åœ¨æŠ€æœ¯é¢†åŸŸä¸Šå¹¶ä¸éš¾ï¼Œéš¾çš„æ˜¯æŸäº›åŠŸèƒ½çš„å®ç°é€»è¾‘ã€‚çºµè§‚æ•´ä¸ªåç«¯ä»£ç ï¼Œç”±äºæˆ‘åˆæœŸçš„è®¾è®¡é—®é¢˜ï¼Œé€ æˆäº†å¾ˆå¤šä»£ç å†—ä½™ï¼ˆå½“ç„¶ï¼Œè¿™ä¸ªé—®é¢˜åœ¨å‰ç«¯ä¸Šæ›´ä¸ºä¸¥é‡ï¼‰ï¼Œå› æ­¤åœ¨ä»£ç çš„è®¾è®¡ä¸æ•´æ´æ–¹é¢è¿˜éœ€è¦æ›´å¤šçš„å­¦ä¹ ã€‚</p>
<p>ä½†åº†å¹¸çš„æ˜¯ï¼Œå› ä¸ºæœ¬æ¬¡æ¯•ä¸šè®¾è®¡æ˜¯ä» 0 å¼€å§‹ï¼ˆæ— è®ºå‰ç«¯è¿˜æ˜¯åç«¯ï¼‰ï¼Œä»å¯è¡Œæ€§åˆ†æä¸€æ­¥æ­¥èµ°åˆ°æµ‹è¯•ï¼Œåœ¨è¿™æœŸé—´è¿˜æ˜¯å­¦åˆ°äº†å¾ˆå¤šä¸œè¥¿ï¼Œä¹Ÿæ²¡æ‰è´¹æˆ‘ä¸¤ä¸ªæœˆçš„å®ä¹ å·¥èµ„ã€‚</p>
<p>ä»æœ¬æ–‡çš„å°é¢å¯ä»¥çœ‹å‡ºï¼Œæˆ‘å°†æˆ‘çš„æŒ‡å¯¼è€å¸ˆå§“åæ·»åŠ äº†ä¸Šå»ï¼ˆè™½ç„¶ä½ å¹¶ä¸è®¤è¯†ï¼Œä½†è¿™æ²¡æœ‰å…³ç³»ï¼‰ï¼Œå†æ¬¡å‘éƒ­è€å¸ˆè¡¨ç¤ºç”±è¡·çš„æ„Ÿè°¢ã€‚æœ¬æ¬¡æ¯•ä¸šè®¾è®¡çš„é€‰é¢˜æ˜¯ç”±æˆ‘çš„æŒ‡å¯¼è€å¸ˆæ‰€ç»™å®šçš„ï¼Œæ„Ÿè°¢éƒ­è€å¸ˆåœ¨ç³»ç»Ÿå‰æœŸè®¾è®¡æ—¶ç»™äºˆæˆ‘ä¼—å¤šçš„å®è´µæ„è§ä¸å‚è€ƒï¼ŒæŒ‡å¯¼æˆ‘åˆ†æã€è®¾è®¡ã€å®ç°æ•´ä¸ªç³»ç»Ÿã€‚åœ¨è®ºæ–‡æ’°å†™æ–¹é¢å°½å¿ƒå°½è´£çš„ä¸ºæˆ‘è®²è§£æ’°å†™è§„èŒƒä¸æ³¨æ„äº‹é¡¹ï¼Œå¹¶å¯¹æˆ‘çš„è®ºæ–‡è¿›è¡Œäº†ä»”ç»†ã€åå¤çš„æ£€æŸ¥ï¼Œå‡†ç¡®å¾—ç»™å‡ºä¿®æ”¹æ„è§ï¼Œæ­£æ˜¯å› ä¸ºæœ‰éƒ­è€å¸ˆçš„å¸®åŠ©ï¼Œç³»ç»Ÿä¸è®ºæ–‡æ‰å¾—ä»¥é¡ºåˆ©å®Œæˆã€‚</p>
<p>æˆ‘è¿˜å°†æˆ‘å¤§å­¦å››å¹´æ‰€åœ¨çš„ç­çº§ä¹Ÿæ·»åŠ äº†ä¸Šå»ï¼Œä»¥æ­¤çºªå¿µæˆ‘é€å»çš„å¤§å­¦æ—¶å…‰ã€‚</p>
<hr class="footnotes-sep">
<section class="footnotes">
<ol class="footnotes-list">
<li id="fn1" class="footnote-item"><p>èœé¸Ÿå·¥å…· æ­£åˆ™è¡¨è¾¾å¼ åœ¨çº¿æµ‹è¯•ï¼š<a target="_blank" rel="noopener" href="https://c.runoob.com/front-end/854">é“¾æ¥</a> <a href="#fnref1" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn2" class="footnote-item"><p>Hutool å‚è€ƒæ–‡æ¡£ï¼š<a target="_blank" rel="noopener" href="https://hutool.cn/docs/#/">é“¾æ¥</a> <a href="#fnref2" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn3" class="footnote-item"><p>Hutool API æ–‡æ¡£ï¼š<a target="_blank" rel="noopener" href="https://apidoc.gitee.com/dromara/hutool/">é“¾æ¥</a> <a href="#fnref3" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn4" class="footnote-item"><p>Cookieã€sessionå’ŒlocalStorageã€ä»¥åŠsessionStorageä¹‹é—´çš„åŒºåˆ«ï¼š<a target="_blank" rel="noopener" href="https://www.cnblogs.com/lishiyuan/p/10273991.html">é“¾æ¥</a> <a href="#fnref4" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn5" class="footnote-item"><p>localStorageä½¿ç”¨æ€»ç»“ï¼š<a target="_blank" rel="noopener" href="https://www.cnblogs.com/st-leslie/p/5617130">é“¾æ¥</a> <a href="#fnref5" class="footnote-backref">â†©ï¸</a></p>
</li>
</ol>
</section>
</body></html></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="https://mofan212.github.io">é»˜çƒ¦</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="https://mofan212.github.io/posts/Code-Summary-Of-Graduation-Project/">https://mofan212.github.io/posts/Code-Summary-Of-Graduation-Project/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥æº <a href="https://mofan212.github.io" target="_blank">Mofan</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Code-In-Practice/">Code-In-Practice</a></div><div class="post-share"><div class="social-share" data-image="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/ArticleCover/87.png" data-sites="wechat,qq,weibo,facebook,x"></div><link rel="stylesheet" href="https://testingcf.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://testingcf.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i>èµåŠ©</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/AliPay.png" target="_blank"><img class="post-qr-code-img" src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/loading.gif" data-lazy-src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/AliPay.png" alt="æ”¯ä»˜å®"/></a><div class="post-qr-code-desc">æ”¯ä»˜å®</div></li><li class="reward-item"><a href="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/WeChatPay.png" target="_blank"><img class="post-qr-code-img" src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/loading.gif" data-lazy-src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/WeChatPay.png" alt="å¾®ä¿¡"/></a><div class="post-qr-code-desc">å¾®ä¿¡</div></li></ul></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/posts/Basic-Use-Of-Json-Web-Token/" title="JWT çš„åŸºæœ¬ä½¿ç”¨"><img class="cover" src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/loading.gif" data-lazy-src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/ArticleCover/86.png" onerror="onerror=null;src='https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">ä¸Šä¸€ç¯‡</div><div class="info-item-2">JWT çš„åŸºæœ¬ä½¿ç”¨</div></div><div class="info-2"><div class="info-item-1">æœ¬æ–‡ä»‹ç»äº† JWT çš„ç»“æ„ä»¥åŠä¸ Spring Securityã€Redis çš„ç®€å•æ•´åˆã€‚</div></div></div></a><a class="pagination-related" href="/posts/Design-Pattern-Factory-Pattern/" title="ã€è®¾è®¡æ¨¡å¼ã€‘å·¥å‚æ¨¡å¼"><img class="cover" src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/loading.gif" data-lazy-src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/ArticleCover/88.png" onerror="onerror=null;src='https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">ä¸‹ä¸€ç¯‡</div><div class="info-item-2">ã€è®¾è®¡æ¨¡å¼ã€‘å·¥å‚æ¨¡å¼</div></div><div class="info-2"><div class="info-item-1">æœ¬æ–‡ä¸»è¦å¯¹ Java è®¾è®¡æ¨¡å¼ä¸­çš„å·¥å‚æ¨¡å¼è¿›è¡Œäº†ä»‹ç»ã€‚</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>ç›¸å…³æ¨è</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/posts/Java-Lambda-In-Action/" title="Java Lambda In Action"><img class="cover" src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/loading.gif" data-lazy-src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/ArticleCover/159.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-03-19</div><div class="info-item-2">Java Lambda In Action</div></div><div class="info-2"><div class="info-item-1">è®²è§£ä¸ä¸€æ ·çš„ Lambda è¡¨è¾¾å¼ç”¨æ³•ï¼Œå¸Œæœ›èƒ½ç»™ä½ å¸¦æ¥ä¸€äº›å¯å‘ã€‚</div></div></div></a><a class="pagination-related" href="/posts/Reduce-Functions/" title="Reduce Functions"><img class="cover" src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/loading.gif" data-lazy-src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/ArticleCover/137.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2023-08-27</div><div class="info-item-2">Reduce Functions</div></div><div class="info-2"><div class="info-item-1">Stream å°±æ˜¯ Lambda è¡¨è¾¾å¼çš„å…¨éƒ¨ï¼Ÿæˆ–è®¸æœ¬æ–‡å¯ä»¥ç»™ä½ ä¸€ç‚¹å¯å‘ã€‚</div></div></div></a><a class="pagination-related" href="/posts/Implement-Dubbo-Default-Service/" title="å®ç° Dubbo é»˜è®¤æœåŠ¡"><img class="cover" src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/loading.gif" data-lazy-src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/ArticleCover/160.webp" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-04-20</div><div class="info-item-2">å®ç° Dubbo é»˜è®¤æœåŠ¡</div></div><div class="info-2"><div class="info-item-1">æ€»ç»“å·¥ä½œä¸å­¦ä¹ ä¸­é˜…è¯»æºç çš„åŒºåˆ«ã€‚</div></div></div></a><a class="pagination-related" href="/posts/Ways-To-Eliminate-Bugs-1/" title="è‡­è™«æ²»ç†æ–¹æ¡ˆï¼ˆä¸€ï¼‰"><img class="cover" src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/loading.gif" data-lazy-src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/ArticleCover/70.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2020-12-02</div><div class="info-item-2">è‡­è™«æ²»ç†æ–¹æ¡ˆï¼ˆä¸€ï¼‰</div></div><div class="info-2"><div class="info-item-1">æœ¬æ–‡ä½œä¸ºæ—¥å¸¸å­¦ä¹ å·¥ä½œæ€»ç»“ï¼Œä¸»è¦ç”¨äºè®°å½•é‡åˆ°çš„å„ç§é¡½å›ºâ€œè‡­è™«â€ã€‚</div></div></div></a><a class="pagination-related" href="/posts/Using-Lambda-Expressions-To-Refactor-Backtracking/" title="ä½¿ç”¨ Lambda è¡¨è¾¾å¼é‡æ„æˆå›æº¯"><img class="cover" src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/loading.gif" data-lazy-src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/ArticleCover/143.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2023-11-12</div><div class="info-item-2">ä½¿ç”¨ Lambda è¡¨è¾¾å¼é‡æ„æˆå›æº¯</div></div><div class="info-2"><div class="info-item-1">ä½¿ç”¨ Lambda è¡¨è¾¾å¼ä¸ºä»£ç é‡æ„æä¾›æ–°æ€è·¯ã€‚</div></div></div></a><a class="pagination-related" href="/posts/Record-A-Test/" title="ã€éšç¬”ã€‘è®°ä¸€æ¬¡å…¥èŒæµ‹è¯•"><img class="cover" src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/loading.gif" data-lazy-src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/ArticleCover/71.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2020-12-03</div><div class="info-item-2">ã€éšç¬”ã€‘è®°ä¸€æ¬¡å…¥èŒæµ‹è¯•</div></div><div class="info-2"><div class="info-item-1">è™šå¿ƒå­¦ä¹ ï¼ŒåŠ æ²¹åŠªåŠ›ã€‚è‡ªå·±è¦èµ°çš„è·¯è¿˜æœ‰å¾ˆè¿œï¼Œè¦å­¦ä¹ çš„çŸ¥è¯†è¿˜æœ‰å¾ˆå¤šã€‚</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/loading.gif" data-lazy-src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/avatar.jpg" onerror="this.onerror=null;this.src='https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">é»˜çƒ¦</div><div class="author-info-description">å½©ç¬”çš„æ‰“æ€ªå‡çº§ä¹‹è·¯...</div><div class="site-data"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">174</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">54</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">37</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/mofan212"><i class="fab fa-github"></i><span>follow me</span></a><div class="card-info-social-icons"><a class="social-icon" href="mailto:cy.mofan@foxmail.com" target="_blank" title="é‚®ç®±"><i class="fas fa-envelope"></i></a><a class="social-icon" href="/atom.xml" target="_blank" title="RSS"><i class="fa fa-rss"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>å…¬å‘Š</span></div><div class="announcement_content">æœ¬ç«™æ‰€æœ‰åšæ–‡å‡æ˜¯åšä¸»çš„å­¦ä¹ ç¬”è®°ä¸ä¸ªäººç†è§£ã€‚<strong><font style="color:red">é™¤ç‰¹åˆ«æ³¨æ˜å¤–ï¼Œ</font>å¦‚éœ€è½¬è½½ï¼Œè¯·åœ¨æ–‡ç« å¤´éƒ¨é†’ç›®å¤„é™„å¸¦åŸæ–‡é“¾æ¥å¹¶<a href="./mine/" style="color:#49B1F5;text-decoration:underline">å‘ŠçŸ¥æˆ‘</a></strong>ä½ å°†è½¬è½½ã€‚ğŸ˜Š</br><strong><font style="color:red">ä¸¥ç¦æœªéµå¾ªè§„èŒƒçš„è½¬è½½ã€‚</font></strong>ğŸ˜¡</br><strong>æ­»å»çš„è¯„è®ºç³»ç»Ÿå¤æ´»å•¦ï¼æ¬¢è¿åˆ°ç•™è¨€æ¿ç•…æ‰€æ¬²è¨€ï¼</strong>å½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨æ›´é«˜æ•ˆçš„<a target="_blank" href="https://space.bilibili.com/23658864/dynamic" style="color:#49B1F5;text-decoration:underline"> å“”å“©å“”å“©ç§ä¿¡ </a>æˆ–<a href="mailto:cy.mofan@foxmail.com" style="color:#49B1F5;text-decoration:underline" target="_blank">é‚®ç®±</a>ã€‚ ğŸ˜‰</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#0-%E5%89%8D%E8%A8%80"><span class="toc-text">0. å‰è¨€</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#1-%E5%90%8E%E7%AB%AF-%E8%87%AA%E5%AE%9A%E4%B9%89%E7%B1%BB"><span class="toc-text">1. åç«¯ - è‡ªå®šä¹‰ç±»</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-1-JSR-303-%E5%BC%82%E5%B8%B8%E4%BF%A1%E6%81%AF%E7%B1%BB"><span class="toc-text">1.1 JSR-303 å¼‚å¸¸ä¿¡æ¯ç±»</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-2-%E8%87%AA%E5%AE%9A%E4%B9%89%E4%B8%9A%E5%8A%A1%E5%BC%82%E5%B8%B8%E7%B1%BB"><span class="toc-text">1.2 è‡ªå®šä¹‰ä¸šåŠ¡å¼‚å¸¸ç±»</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-3-%E7%BB%9F%E4%B8%80%E8%BF%94%E5%9B%9E%E5%80%BC"><span class="toc-text">1.3 ç»Ÿä¸€è¿”å›å€¼</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-4-%E5%88%86%E9%A1%B5%E8%AF%B7%E6%B1%82%E5%AF%B9%E8%B1%A1"><span class="toc-text">1.4 åˆ†é¡µè¯·æ±‚å¯¹è±¡</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-5-%E6%9E%9A%E4%B8%BE%E6%8E%A5%E5%8F%A3"><span class="toc-text">1.5 æšä¸¾æ¥å£</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-6-%E5%AE%9E%E4%BD%93%E5%9F%BA%E7%B1%BB"><span class="toc-text">1.6 å®ä½“åŸºç±»</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-7-%E6%95%B0%E6%8D%AE%E4%BC%A0%E8%BE%93%E5%AF%B9%E8%B1%A1%E5%9F%BA%E7%B1%BB"><span class="toc-text">1.7 æ•°æ®ä¼ è¾“å¯¹è±¡åŸºç±»</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-%E5%90%8E%E7%AB%AF-SpringBoot"><span class="toc-text">2. åç«¯ - SpringBoot</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#2-1-%E7%BB%9F%E4%B8%80%E5%BC%82%E5%B8%B8%E6%8B%A6%E6%88%AA"><span class="toc-text">2.1 ç»Ÿä¸€å¼‚å¸¸æ‹¦æˆª</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-2-JSR-303-%E6%A0%A1%E9%AA%8C"><span class="toc-text">2.2 JSR-303 æ ¡éªŒ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-3-%E8%87%AA%E5%AE%9A%E4%B9%89%E6%A0%A1%E9%AA%8C%E6%B3%A8%E8%A7%A3"><span class="toc-text">2.3 è‡ªå®šä¹‰æ ¡éªŒæ³¨è§£</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-4-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E9%99%90%E5%88%B6"><span class="toc-text">2.4 æ–‡ä»¶ä¸Šä¼ é™åˆ¶</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3-%E5%90%8E%E7%AB%AF-%E9%98%BF%E9%87%8C%E4%BA%91-OSS"><span class="toc-text">3. åç«¯ - é˜¿é‡Œäº‘ OSS</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#4-%E5%90%8E%E7%AB%AF-logback"><span class="toc-text">4.åç«¯ - logback</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#5-%E5%90%8E%E7%AB%AF-%E5%88%87%E9%9D%A2"><span class="toc-text">5. åç«¯ - åˆ‡é¢</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#6-%E5%90%8E%E7%AB%AF-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E5%8A%A0%E5%AF%86"><span class="toc-text">6. åç«¯ - é…ç½®æ–‡ä»¶åŠ å¯†</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#6-1-%E8%87%AA%E5%AE%9A%E4%B9%89%E5%8A%A0%E5%AF%86%E5%89%8D%E5%90%8E%E7%BC%80"><span class="toc-text">6.1 è‡ªå®šä¹‰åŠ å¯†å‰åç¼€</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-2-%E6%9B%B4%E5%A4%9A%E8%87%AA%E5%AE%9A%E4%B9%89"><span class="toc-text">6.2 æ›´å¤šè‡ªå®šä¹‰</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#7-%E5%90%8E%E7%AB%AF-%E5%B7%A5%E5%85%B7%E7%B1%BB"><span class="toc-text">7. åç«¯ - å·¥å…·ç±»</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#7-1-Hutool"><span class="toc-text">7.1 Hutool</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-2-%E4%BD%BF%E7%94%A8%E7%9A%84%E5%B7%A5%E5%85%B7%E7%B1%BB"><span class="toc-text">7.2 ä½¿ç”¨çš„å·¥å…·ç±»</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#8-%E5%90%8E%E7%AB%AF-%E5%85%B6%E4%BB%96"><span class="toc-text">8. åç«¯ - å…¶ä»–</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#8-1-DateTimeFormat-%E4%B8%8E-JsonFormat-%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-text">8.1 @DateTimeFormat ä¸ @JsonFormat çš„åŒºåˆ«</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-2-Excel-%E7%9A%84%E5%AF%BC%E5%87%BA"><span class="toc-text">8.2 Excel çš„å¯¼å‡º</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#9-%E5%89%8D%E7%AB%AF-JS-%E7%9A%84%E5%B0%81%E8%A3%85"><span class="toc-text">9. å‰ç«¯ - JS çš„å°è£…</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#9-1-http-js"><span class="toc-text">9.1 http.js</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-2-tools-js"><span class="toc-text">9.2 tools.js</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-3-file-js"><span class="toc-text">9.3 file.js</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-4-date-js"><span class="toc-text">9.4 date.js</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-5-request-js"><span class="toc-text">9.5 request.js</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-6-validate-js"><span class="toc-text">9.6 validate.js</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-7-index-js"><span class="toc-text">9.7 index.js</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#10-Element-UI-%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-text">10. Element-UI çš„ä½¿ç”¨</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#10-1-%E5%9C%A8%E8%A1%A8%E5%8D%95%E6%8C%87%E5%AE%9A%E5%AD%97%E6%AE%B5%E4%B8%8B%E6%8F%90%E7%A4%BA%E9%94%99%E8%AF%AF%E4%BF%A1%E6%81%AF"><span class="toc-text">10.1 åœ¨è¡¨å•æŒ‡å®šå­—æ®µä¸‹æç¤ºé”™è¯¯ä¿¡æ¯</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-2-el-select-%E8%AE%BE%E7%BD%AE-multiple-%E5%90%8E%E5%87%BA%E7%8E%B0%E7%9A%84%E9%97%AE%E9%A2%98"><span class="toc-text">10.2 el-select è®¾ç½® multiple åå‡ºç°çš„é—®é¢˜</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#11-%E5%89%8D%E7%AB%AF-%E5%85%B6%E4%BB%96"><span class="toc-text">11. å‰ç«¯ - å…¶ä»–</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#11-1-%E5%90%8E%E7%AB%AF-ID-%E5%BC%82%E5%B8%B8"><span class="toc-text">11.1 åç«¯ ID å¼‚å¸¸</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-2-Token-%E4%BF%A1%E6%81%AF%E7%9A%84%E5%AD%98%E5%82%A8"><span class="toc-text">11.2 Token ä¿¡æ¯çš„å­˜å‚¨</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#12-%E7%BB%93%E8%AF%AD"><span class="toc-text">12. ç»“è¯­</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/Git/" title="Gitç†è®ºä¸ä½¿ç”¨"><img src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/loading.gif" data-lazy-src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/ArticleCover/3.jpg" onerror="this.onerror=null;this.src='https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/404.jpg'" alt="Gitç†è®ºä¸ä½¿ç”¨"/></a><div class="content"><a class="title" href="/posts/Git/" title="Gitç†è®ºä¸ä½¿ç”¨">Gitç†è®ºä¸ä½¿ç”¨</a><time datetime="2026-01-26T16:00:00.000Z" title="æ›´æ–°äº 2026-01-27 00:00:00">2026-01-27</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/Something-About-Blog/" title="åšå®¢æ­å»ºä¸ç»´æŠ¤"><img src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/loading.gif" data-lazy-src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/ArticleCover/42.jpg" onerror="this.onerror=null;this.src='https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/404.jpg'" alt="åšå®¢æ­å»ºä¸ç»´æŠ¤"/></a><div class="content"><a class="title" href="/posts/Something-About-Blog/" title="åšå®¢æ­å»ºä¸ç»´æŠ¤">åšå®¢æ­å»ºä¸ç»´æŠ¤</a><time datetime="2026-01-24T16:00:00.000Z" title="æ›´æ–°äº 2026-01-25 00:00:00">2026-01-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/Java-Memory-Model/" title="Java å†…å­˜æ¨¡å‹"><img src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/loading.gif" data-lazy-src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/ArticleCover/174.png" onerror="this.onerror=null;this.src='https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/404.jpg'" alt="Java å†…å­˜æ¨¡å‹"/></a><div class="content"><a class="title" href="/posts/Java-Memory-Model/" title="Java å†…å­˜æ¨¡å‹">Java å†…å­˜æ¨¡å‹</a><time datetime="2026-01-02T16:00:00.000Z" title="æ›´æ–°äº 2026-01-03 00:00:00">2026-01-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/Java-Bytecode-And-Class-Loading/" title="å­—èŠ‚ç ä¸ç±»åŠ è½½"><img src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/loading.gif" data-lazy-src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/ArticleCover/173.png" onerror="this.onerror=null;this.src='https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/404.jpg'" alt="å­—èŠ‚ç ä¸ç±»åŠ è½½"/></a><div class="content"><a class="title" href="/posts/Java-Bytecode-And-Class-Loading/" title="å­—èŠ‚ç ä¸ç±»åŠ è½½">å­—èŠ‚ç ä¸ç±»åŠ è½½</a><time datetime="2026-01-01T16:00:00.000Z" title="æ›´æ–°äº 2026-01-02 00:00:00">2026-01-02</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/Class-Resource-Loading-In-Java/" title="Java çš„ç±»èµ„æºåŠ è½½"><img src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/loading.gif" data-lazy-src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/ArticleCover/103.png" onerror="this.onerror=null;this.src='https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/404.jpg'" alt="Java çš„ç±»èµ„æºåŠ è½½"/></a><div class="content"><a class="title" href="/posts/Class-Resource-Loading-In-Java/" title="Java çš„ç±»èµ„æºåŠ è½½">Java çš„ç±»èµ„æºåŠ è½½</a><time datetime="2026-01-01T16:00:00.000Z" title="æ›´æ–°äº 2026-01-02 00:00:00">2026-01-02</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/Annotation-And-Reflection/" title="æ³¨è§£ã€ç±»çš„åŠ è½½ã€åå°„"><img src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/loading.gif" data-lazy-src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/ArticleCover/20.jpg" onerror="this.onerror=null;this.src='https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/404.jpg'" alt="æ³¨è§£ã€ç±»çš„åŠ è½½ã€åå°„"/></a><div class="content"><a class="title" href="/posts/Annotation-And-Reflection/" title="æ³¨è§£ã€ç±»çš„åŠ è½½ã€åå°„">æ³¨è§£ã€ç±»çš„åŠ è½½ã€åå°„</a><time datetime="2026-01-01T16:00:00.000Z" title="æ›´æ–°äº 2026-01-02 00:00:00">2026-01-02</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2020 - 2026 By é»˜çƒ¦</span><span class="framework-info"><span>æ¡†æ¶ </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>ä¸»é¢˜ </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.5.4</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="æ—¥é—´å’Œå¤œé—´æ¨¡å¼åˆ‡æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.4"></script><script src="/js/main.js?v=5.5.4"></script><script src="https://testingcf.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><script src="https://testingcf.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://testingcf.jsdelivr.net/npm/vanilla-lazyload@latest/dist/lazyload.iife.min.js"></script><script src="https://testingcf.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><div class="js-pjax"><script>(() => {
  const parseViewBox = viewBox => {
    if (!viewBox) return null
    const parts = viewBox.trim().split(/[\s,]+/).map(n => Number(n))
    if (parts.length !== 4 || parts.some(n => Number.isNaN(n))) return null
    return parts
  }

  const getSvgViewBox = svg => {
    const attr = parseViewBox(svg.getAttribute('viewBox'))
    if (attr) return attr

    // Fallback: use bbox to build a viewBox
    try {
      const bbox = svg.getBBox()
      if (bbox && bbox.width && bbox.height) return [bbox.x, bbox.y, bbox.width, bbox.height]
    } catch (e) {
      // getBBox may fail on some edge cases; ignore
    }

    const w = Number(svg.getAttribute('width')) || 0
    const h = Number(svg.getAttribute('height')) || 0
    if (w > 0 && h > 0) return [0, 0, w, h]
    return [0, 0, 100, 100]
  }

  const setSvgViewBox = (svg, vb) => {
    svg.setAttribute('viewBox', `${vb[0]} ${vb[1]} ${vb[2]} ${vb[3]}`)
  }

  const clamp = (v, min, max) => Math.max(min, Math.min(max, v))

  const openSvgInNewTab = ({ source, initViewBox }) => {
    const getClonedSvg = () => {
      if (typeof source === 'string') {
        const template = document.createElement('template')
        template.innerHTML = source.trim()
        const svg = template.content.querySelector('svg')
        return svg ? svg.cloneNode(true) : null
      }
      if (source && typeof source.cloneNode === 'function') {
        return source.cloneNode(true)
      }
      return null
    }

    const clone = getClonedSvg()
    if (!clone) return
    if (initViewBox && initViewBox.length === 4) {
      clone.setAttribute('viewBox', initViewBox.join(' '))
    }
    if (!clone.getAttribute('xmlns')) clone.setAttribute('xmlns', 'http://www.w3.org/2000/svg')
    if (!clone.getAttribute('xmlns:xlink') && clone.outerHTML.includes('xlink:')) {
      clone.setAttribute('xmlns:xlink', 'http://www.w3.org/1999/xlink')
    }
    // inject background to match current theme
    const isDark = document.documentElement.getAttribute('data-theme') === 'dark'
    const bg = getComputedStyle(document.body).backgroundColor || (isDark ? '#1e1e1e' : '#ffffff')
    if (!clone.style.background) clone.style.background = bg

    const serializer = new XMLSerializer()
    const svgSource = serializer.serializeToString(clone)
    const htmlSource = `<!doctype html><html><head><meta charset="utf-8" />
      <style>
        html, body { width: 100%; height: 100%; margin: 0; display: flex; align-items: center; justify-content: center; background: ${bg}; }
        svg { max-width: 100%; max-height: 100%; height: auto; width: auto; }
      </style>
      </head><body>${svgSource}</body></html>`
    const blob = new Blob([htmlSource], { type: 'text/html;charset=utf-8' })
    const url = URL.createObjectURL(blob)
    window.open(url, '_blank', 'noopener')
    setTimeout(() => URL.revokeObjectURL(url), 30000)
  }

  const attachMermaidViewerButton = wrap => {
    let btn = wrap.querySelector('.mermaid-open-btn')
    if (!btn) {
      btn = document.createElement('button')
      btn.type = 'button'
      btn.className = 'mermaid-open-btn'
      wrap.appendChild(btn)
    }

    btn.innerHTML = '<i class="fa fa-search fa-fw" aria-hidden="true"></i>'

    if (!btn.__mermaidViewerBound) {
      btn.addEventListener('click', e => {
        e.preventDefault()
        e.stopPropagation()
        const svg = wrap.__mermaidOriginalSvg || wrap.querySelector('svg')
        if (!svg) return
        const initViewBox = wrap.__mermaidInitViewBox
        if (typeof svg === 'string') {
          openSvgInNewTab({ source: svg, initViewBox })
          return
        }
        openSvgInNewTab({ source: svg, initViewBox })
      })
      btn.__mermaidViewerBound = true
    }
  }

  // Zoom around a point (px, py) in the SVG viewport (in viewBox coordinates)
  const zoomAtPoint = (vb, factor, px, py) => {
    const w = vb[2] * factor
    const h = vb[3] * factor
    const nx = px - (px - vb[0]) * factor
    const ny = py - (py - vb[1]) * factor
    return [nx, ny, w, h]
  }

  const initMermaidGestures = wrap => {
    const svg = wrap.querySelector('svg')
    if (!svg) return

    // Ensure viewBox exists so gestures always work
    const initVb = getSvgViewBox(svg)
    wrap.__mermaidInitViewBox = initVb
    wrap.__mermaidCurViewBox = initVb.slice()
    setSvgViewBox(svg, initVb)

    // Avoid binding multiple times on themeChange/pjax
    if (wrap.__mermaidGestureBound) return
    wrap.__mermaidGestureBound = true

    // Helper: map client (viewport) coordinate -> viewBox coordinate
    const clientToViewBox = (clientX, clientY) => {
      const rect = svg.getBoundingClientRect()
      const vb = wrap.__mermaidCurViewBox || getSvgViewBox(svg)
      const x = vb[0] + (clientX - rect.left) * (vb[2] / rect.width)
      const y = vb[1] + (clientY - rect.top) * (vb[3] / rect.height)
      return { x, y, rect, vb }
    }

    const state = {
      pointers: new Map(),
      startVb: null,
      startDist: 0,
      startCenter: null
    }

    const clampVb = vb => {
      const init = wrap.__mermaidInitViewBox || vb
      const minW = init[2] * 0.1
      const maxW = init[2] * 10
      const minH = init[3] * 0.1
      const maxH = init[3] * 10
      vb[2] = clamp(vb[2], minW, maxW)
      vb[3] = clamp(vb[3], minH, maxH)
      return vb
    }

    const setCurVb = vb => {
      vb = clampVb(vb)
      wrap.__mermaidCurViewBox = vb
      setSvgViewBox(svg, vb)
    }

    const onPointerDown = e => {
      // Allow only primary button for mouse
      if (e.pointerType === 'mouse' && e.button !== 0) return
      svg.setPointerCapture(e.pointerId)
      state.pointers.set(e.pointerId, { x: e.clientX, y: e.clientY })

      if (state.pointers.size === 1) {
        state.startVb = (wrap.__mermaidCurViewBox || getSvgViewBox(svg)).slice()
      } else if (state.pointers.size === 2) {
        const pts = [...state.pointers.values()]
        const dx = pts[0].x - pts[1].x
        const dy = pts[0].y - pts[1].y
        state.startDist = Math.hypot(dx, dy)
        state.startVb = (wrap.__mermaidCurViewBox || getSvgViewBox(svg)).slice()
        state.startCenter = { x: (pts[0].x + pts[1].x) / 2, y: (pts[0].y + pts[1].y) / 2 }
      }
    }

    const onPointerMove = e => {
      if (!state.pointers.has(e.pointerId)) return
      state.pointers.set(e.pointerId, { x: e.clientX, y: e.clientY })

      // Pan with 1 pointer
      if (state.pointers.size === 1 && state.startVb) {
        const p = [...state.pointers.values()][0]
        const prev = { x: e.clientX - e.movementX, y: e.clientY - e.movementY }
        // movementX/Y unreliable on touch, compute from stored last position
        const last = wrap.__mermaidLastSinglePointer || p
        const dxClient = p.x - last.x
        const dyClient = p.y - last.y
        wrap.__mermaidLastSinglePointer = p

        const { rect } = clientToViewBox(p.x, p.y)
        const vb = (wrap.__mermaidCurViewBox || getSvgViewBox(svg)).slice()
        const dx = dxClient * (vb[2] / rect.width)
        const dy = dyClient * (vb[3] / rect.height)
        setCurVb([vb[0] - dx, vb[1] - dy, vb[2], vb[3]])
        return
      }

      // Pinch zoom with 2 pointers
      if (state.pointers.size === 2 && state.startVb && state.startDist > 0) {
        const pts = [...state.pointers.values()]
        const dx = pts[0].x - pts[1].x
        const dy = pts[0].y - pts[1].y
        const dist = Math.hypot(dx, dy)
        if (!dist) return
        const factor = state.startDist / dist // dist bigger => zoom in (viewBox smaller)

        const cx = (pts[0].x + pts[1].x) / 2
        const cy = (pts[0].y + pts[1].y) / 2
        const centerClient = { x: cx, y: cy }

        const pxy = clientToViewBox(centerClient.x, centerClient.y)
        const cpx = pxy.x
        const cpy = pxy.y

        const vb = zoomAtPoint(state.startVb, factor, cpx, cpy)
        setCurVb(vb)
      }
    }

    const onPointerUpOrCancel = e => {
      state.pointers.delete(e.pointerId)
      if (state.pointers.size === 0) {
        state.startVb = null
        state.startDist = 0
        state.startCenter = null
        wrap.__mermaidLastSinglePointer = null
      } else if (state.pointers.size === 1) {
        // reset single pointer baseline to avoid jump
        wrap.__mermaidLastSinglePointer = [...state.pointers.values()][0]
      }
    }

    // Wheel zoom (mouse/trackpad)
    const onWheel = e => {
      // ctrlKey on mac trackpad pinch; we treat both as zoom
      e.preventDefault()
      const delta = e.deltaY
      const zoomFactor = delta > 0 ? 1.1 : 0.9
      const { x, y } = clientToViewBox(e.clientX, e.clientY)
      const vb = (wrap.__mermaidCurViewBox || getSvgViewBox(svg)).slice()
      setCurVb(zoomAtPoint(vb, zoomFactor, x, y))
    }

    const onDblClick = () => {
      const init = wrap.__mermaidInitViewBox
      if (!init) return
      wrap.__mermaidCurViewBox = init.slice()
      setSvgViewBox(svg, init)
    }

    svg.addEventListener('pointerdown', onPointerDown)
    svg.addEventListener('pointermove', onPointerMove)
    svg.addEventListener('pointerup', onPointerUpOrCancel)
    svg.addEventListener('pointercancel', onPointerUpOrCancel)
    svg.addEventListener('wheel', onWheel, { passive: false })
    svg.addEventListener('dblclick', onDblClick)
  }

  const runMermaid = ele => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

    ele.forEach((item, index) => {
      const mermaidSrc = item.firstElementChild

      // Clear old render (themeChange/pjax will rerun)
      const oldSvg = item.querySelector('svg')
      if (oldSvg) oldSvg.remove()
      item.__mermaidGestureBound = false

      const config = mermaidSrc.dataset.config ? JSON.parse(mermaidSrc.dataset.config) : {}
      if (!config.theme) {
        config.theme = theme
      }
      const mermaidThemeConfig = `%%{init: ${JSON.stringify(config)}}%%\n`
      const mermaidID = `mermaid-${index}`
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)
      const renderMermaid = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
        if (true) initMermaidGestures(item)
        item.__mermaidOriginalSvg = svg
        if (true) attachMermaidViewerButton(item)
      }


      // mermaid v9 and v10 compatibility
      typeof renderFn === 'string' ? renderMermaid(renderFn) : renderFn.then(({ svg }) => renderMermaid(svg))
    })
  }

  const codeToMermaid = () => {
    const codeMermaidEle = document.querySelectorAll('pre > code.mermaid')
    if (codeMermaidEle.length === 0) return

    codeMermaidEle.forEach(ele => {
      const preEle = document.createElement('pre')
      preEle.className = 'mermaid-src'
      preEle.hidden = true
      preEle.textContent = ele.textContent
      const newEle = document.createElement('div')
      newEle.className = 'mermaid-wrap'
      newEle.appendChild(preEle)
      ele.parentNode.replaceWith(newEle)
    })
  }

  const loadMermaid = () => {
    if (true) codeToMermaid()
    const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
    if ($mermaid.length === 0) return

    const runMermaidFn = () => runMermaid($mermaid)
    btf.addGlobalFn('themeChange', runMermaidFn, 'mermaid')
    window.loadMermaid ? runMermaidFn() : btf.getScript('https://gcore.jsdelivr.net/npm/mermaid@11.12.0/dist/mermaid.min.js').then(runMermaidFn)
  }

  btf.addGlobalFn('encrypt', loadMermaid, 'mermaid')
  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script></div><script src="https://testingcf.jsdelivr.net/gh/mofan212/blog-static-resources@master/js/mine.min.js"></script><script src="/js/tip_portal.js"></script><script defer="defer" id="ribbon" src="https://testingcf.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="false"></script><script id="click-show-text" src="https://testingcf.jsdelivr.net/npm/butterfly-extsrc/dist/click-show-text.min.js" data-mobile="false" data-text="Azathoth,Yog-Sothoth,Shub-Niggurath,Nyarlathotep,Cthulhu,Hastur,Abhoth,Ghroth,Tsathoggua,Cthugha,Deep Ones,Dagon,Chaugnar Faugn,Mordiggian,Shoggoth,Old One,Mi-Go,Great Race of Yith,Flying Polyp,Hounds of Tindalos,Dhole" data-fontsize="15px" data-random="false" async="async"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div class="docsearch-wrap"><div id="docsearch" style="display:none"></div><link rel="stylesheet" href="https://testingcf.jsdelivr.net/npm/@docsearch/css/dist/style.min.css"/><script src="https://testingcf.jsdelivr.net/npm/@docsearch/js/dist/umd/index.min.js"></script><script>(() => {
  docsearch(Object.assign({
    appId: 'BAFEL7A6K1',
    apiKey: '89fcb5961984c5c054bf04149f345f38',
    indexName: 'mofan212io',
    container: '#docsearch',
    placeholder: 'è¾“å…¥å…³é”®å­—è¿›è¡Œæœç´¢',
  }, null))

  const handleClick = () => {
    document.querySelector('.DocSearch-Button').click()
  }

  const searchClickFn = () => {
    btf.addEventListenerPjax(document.querySelector('#search-button > .search'), 'click', handleClick)
  }

  searchClickFn()
  window.addEventListener('pjax:complete', searchClickFn)
})()</script></div></div></body></html>