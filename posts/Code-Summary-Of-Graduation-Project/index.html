<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>æ¯•ä¸šè®¾è®¡ä»£ç æ€»ç»“ | Mofan</title><meta name="author" content="é»˜çƒ¦,cy.mofan@foxmail.com"><meta name="copyright" content="é»˜çƒ¦"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="è®°å½•ä¸€ä¸‹æ¯•ä¸šè®¾è®¡ä¸­é‡åˆ°çš„å„ä¸ªé—®é¢˜å¹¶å¯¹è¿™ä¸ªè¿‡ç¨‹åšä¸ªæ€»ç»“ï¼Œä¹Ÿç®—æ˜¯è®°å½•é€å»çš„å¤§å­¦æ—¶å…‰ã€‚">
<meta property="og:type" content="article">
<meta property="og:title" content="æ¯•ä¸šè®¾è®¡ä»£ç æ€»ç»“">
<meta property="og:url" content="https://mofan212.github.io/posts/Code-Summary-Of-Graduation-Project/">
<meta property="og:site_name" content="Mofan">
<meta property="og:description" content="è®°å½•ä¸€ä¸‹æ¯•ä¸šè®¾è®¡ä¸­é‡åˆ°çš„å„ä¸ªé—®é¢˜å¹¶å¯¹è¿™ä¸ªè¿‡ç¨‹åšä¸ªæ€»ç»“ï¼Œä¹Ÿç®—æ˜¯è®°å½•é€å»çš„å¤§å­¦æ—¶å…‰ã€‚">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/ArticleCover/87.png">
<meta property="article:published_time" content="2021-06-26T16:00:00.000Z">
<meta property="article:modified_time" content="2021-07-30T16:00:00.000Z">
<meta property="article:author" content="é»˜çƒ¦">
<meta property="article:tag" content="Code-In-Practice">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/ArticleCover/87.png"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "æ¯•ä¸šè®¾è®¡ä»£ç æ€»ç»“",
  "url": "https://mofan212.github.io/posts/Code-Summary-Of-Graduation-Project/",
  "image": "https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/ArticleCover/87.png",
  "datePublished": "2021-06-26T16:00:00.000Z",
  "dateModified": "2021-07-30T16:00:00.000Z",
  "author": [
    {
      "@type": "Person",
      "name": "é»˜çƒ¦",
      "url": "https://mofan212.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/favicon.png"><link rel="canonical" href="https://mofan212.github.io/posts/Code-Summary-Of-Graduation-Project/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=5.5.3"><link rel="stylesheet" href="https://testingcf.jsdelivr.net/npm/@fortawesome/fontawesome-free@latest/css/all.min.css"><link rel="stylesheet" href="https://testingcf.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://testingcf.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          const mediaQueryDark = window.matchMedia('(prefers-color-scheme: dark)')
          const mediaQueryLight = window.matchMedia('(prefers-color-scheme: light)')

          if (theme === undefined) {
            if (mediaQueryLight.matches) activateLightMode()
            else if (mediaQueryDark.matches) activateDarkMode()
            else {
              const hour = new Date().getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            mediaQueryDark.addEventListener('change', () => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else {
            theme === 'light' ? activateLightMode() : activateDarkMode()
          }
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":true,"highlightMacStyle":true},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶å¤±è´¥',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'å¤©',
  dateSuffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: {"limitCount":150,"languages":{"author":"ä½œè€…: é»˜çƒ¦","link":"é“¾æ¥: ","source":"æ¥æº: Mofan","info":"è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"å·²åˆ‡æ¢ä¸ºç¹ä½“ä¸­æ–‡","cht_to_chs":"å·²åˆ‡æ¢ä¸ºç®€ä½“ä¸­æ–‡","day_to_night":"å·²åˆ‡æ¢ä¸ºæ·±è‰²æ¨¡å¼","night_to_day":"å·²åˆ‡æ¢ä¸ºæµ…è‰²æ¨¡å¼","bgLight":"#49b1f5","bgDark":"#121212","position":"bottom-left"},
  infinitegrid: {
    js: 'https://testingcf.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'åŠ è½½æ›´å¤š'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: true,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'æ¯•ä¸šè®¾è®¡ä»£ç æ€»ç»“',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="referrer" content="no-referrer-when-downgrade" /><link rel="stylesheet" href="https://testingcf.jsdelivr.net/gh/mofan212/blog-static-resources@master/css/myStyle.min.css"><link rel="stylesheet" href="https://npm.elemecdn.com/lxgw-wenkai-screen-webfont@1.7.0/style.css" /><link rel="stylesheet" href="https://gcore.jsdelivr.net/npm/jetbrains-mono@1.0.6/css/jetbrains-mono-nl.min.css" /><link rel="stylesheet" href="/css/custom.css"><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="Mofan" type="application/atom+xml">
</head><body><script>window.paceOptions = {
  restartOnPushState: false
}

btf.addGlobalFn('pjaxSend', () => {
  Pace.restart()
}, 'pace_restart')

</script><link rel="stylesheet" href="https://testingcf.jsdelivr.net/gh/mofan212/blog-static-resources/css/minimal.min.css"/><script src="https://testingcf.jsdelivr.net/npm/pace-js/pace.min.js"></script><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/loading.gif" data-lazy-src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/avatar.jpg" onerror="this.onerror=null;this.src='https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">174</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">54</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">37</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><span class="site-page group hide"><i class="fa-fw fas fa-book-reader"></i><span> æ–‡ç« </span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> å½’æ¡£</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/schedule/"><i class="fa-fw fas fa-list-alt"></i><span> è®¡åˆ’</span></a></div><div class="menus_item"><a class="site-page" href="/update/"><i class="fa-fw fas fa-tools"></i><span> ç»´æŠ¤</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> å‹é“¾</span></a></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fa fa-comments"></i><span> ç•™è¨€æ¿</span></a></div><div class="menus_item"><span class="site-page group hide"><i class="fa-fw fa fa-heart"></i><span> å…³äº</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/about/"><i class="fa-fw fa fa-sitemap"></i><span> å…³äºæœ¬ç«™</span></a></li><li><a class="site-page child" href="/mine/"><i class="fa-fw fa fa-id-card"></i><span> å…³äºæˆ‘</span></a></li><li><a class="site-page child" href="/reward/"><i class="fa-fw fa-solid fa-coins"></i><span> èµåŠ©</span></a></li><li><a class="site-page child" href="/milestones/"><i class="fa-fw fa-solid fa-monument"></i><span> é‡Œç¨‹ç¢‘</span></a></li></ul></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://www.travellings.cn/go.html"><i class="fa-fw fas fa-subway"></i><span> å¼€å¾€</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/post_top_img.png);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">Mofan</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> æœç´¢</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><span class="site-page group hide"><i class="fa-fw fas fa-book-reader"></i><span> æ–‡ç« </span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> å½’æ¡£</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/schedule/"><i class="fa-fw fas fa-list-alt"></i><span> è®¡åˆ’</span></a></div><div class="menus_item"><a class="site-page" href="/update/"><i class="fa-fw fas fa-tools"></i><span> ç»´æŠ¤</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> å‹é“¾</span></a></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fa fa-comments"></i><span> ç•™è¨€æ¿</span></a></div><div class="menus_item"><span class="site-page group hide"><i class="fa-fw fa fa-heart"></i><span> å…³äº</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/about/"><i class="fa-fw fa fa-sitemap"></i><span> å…³äºæœ¬ç«™</span></a></li><li><a class="site-page child" href="/mine/"><i class="fa-fw fa fa-id-card"></i><span> å…³äºæˆ‘</span></a></li><li><a class="site-page child" href="/reward/"><i class="fa-fw fa-solid fa-coins"></i><span> èµåŠ©</span></a></li><li><a class="site-page child" href="/milestones/"><i class="fa-fw fa-solid fa-monument"></i><span> é‡Œç¨‹ç¢‘</span></a></li></ul></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://www.travellings.cn/go.html"><i class="fa-fw fas fa-subway"></i><span> å¼€å¾€</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">æ¯•ä¸šè®¾è®¡ä»£ç æ€»ç»“</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2021-06-26T16:00:00.000Z" title="å‘è¡¨äº 2021-06-27 00:00:00">2021-06-27</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2021-07-30T16:00:00.000Z" title="æ›´æ–°äº 2021-07-31 00:00:00">2021-07-31</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Code-In-Practice/">Code-In-Practice</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">æ€»å­—æ•°:</span><span class="word-count">13.3k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»æ—¶é•¿:</span><span>57åˆ†é’Ÿ</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">æµè§ˆé‡:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><div id="post-outdate-notice" data="{&quot;limitDay&quot;:365,&quot;messagePrev&quot;:&quot;è·ç¦»æœ¬æ–‡ä¸Šæ¬¡æ›´æ–°å·²ç»è¿‡å»&quot;,&quot;messageNext&quot;:&quot;å¤©ï¼Œè¯·æ³¨æ„æ—¶æ•ˆæ€§ã€‚&quot;,&quot;postUpdate&quot;:&quot;2021-07-31 00:00:00&quot;}" hidden></div><p>å°é¢æ¥æºï¼šç”±åšä¸»ä¸ªäººç»˜åˆ¶ï¼Œå¦‚éœ€ä½¿ç”¨è¯·è”ç³»åšä¸»ã€‚</p>
<h1 id="0-å‰è¨€"><a class="header-anchor" href="#0-å‰è¨€"></a>0. å‰è¨€</h1>
<p>ä¸çŸ¥ä¸è§‰å¤§å­¦éƒ½è¦æ¯•ä¸šäº†ï¼Œç„¶è€Œè‡ªå·±è¿˜æ˜¯ä¸ªèœç‹— ğŸ¶ï¼Œå†™ä¸ªæ¯•ä¸šè®¾è®¡å‰ç«¯ä¸å’‹ä¼šå°±ç®—äº†ï¼Œåç«¯ä¹Ÿå†™å¾—èœ ğŸ¥¬ã€‚å›æœ›å››å¹´ï¼Œè¿™æ¯•ä¸šè®¾è®¡è¿˜æ˜¯æˆ‘çœŸæ­£å†™å®Œçš„ä¸€ä¸ªé¡¹ç›®ï¼ˆä»¥å‰çš„é¡¹ç›®è¦ä¹ˆåŠé€”è€ŒåºŸï¼Œè¦ä¹ˆä»…ä»…æ˜¯ä¸€ä¸ª demoï¼‰ã€‚</p>
<p>æ›¾å­æ›°ï¼šâ€œå¾æ—¥ä¸‰çœå¾èº«â€ï¼Œå®Œæˆäº†æ¯•ä¸šè®¾è®¡åè¿›è¡Œä¸€ä¸ªæ€»ç»“è¿˜æ˜¯å¾ˆæœ‰å¿…è¦çš„ã€‚</p>
<p>åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†ä»å‰ç«¯ä¸åç«¯è¿›è¡Œæ€»ç»“ï¼Œè™½è¯´æ˜¯æ€»ç»“ï¼Œä¹Ÿä»…ä»…æ˜¯è®°å½•ä¸€ä¸‹è‡ªå·±æ›¾ç»çš„çŸ¥è¯†ç›²ç‚¹ç½¢äº†ã€‚</p>
<p>åç«¯æŠ€æœ¯æ ˆï¼šSpringBoot + SpringSecurity + JWT + MyBatis-Plus + MapStruct + Hutoolï¼ˆé»˜è®¤å¼•å…¥ Lombokï¼‰</p>
<p>åç«¯æ•°æ®åº“ï¼šRedis + MySQL 8.0</p>
<p>å‰ç«¯æŠ€æœ¯æ ˆï¼šVue.js + Element-UI</p>
<hr>
<p>å…³äºåç«¯ JWT å’Œ SpringSecurity çš„ç›¸å…³ä½¿ç”¨ï¼Œå¯ä»¥å‚çœ‹ã€JWTçš„åŸºæœ¬ä½¿ç”¨ã€‘ä¸€æ–‡ã€‚</p>
<p>å…³äºåç«¯ MapStruct çš„ä½¿ç”¨ï¼Œå¯ä»¥å‚çœ‹ã€MapStructä½¿ç”¨æ‰‹å†Œã€‘ä¸€æ–‡ã€‚</p>
<p>å…³äºåç«¯ MyBatis-Plus çš„ä½¿ç”¨ï¼Œå¯ä»¥å‚çœ‹ã€MyBatisçš„â€œå¥½åŸºå‹â€â€”â€”MyBatisPlusã€‘ä¸€æ–‡ã€‚</p>
<h1 id="1-åç«¯-è‡ªå®šä¹‰ç±»"><a class="header-anchor" href="#1-åç«¯-è‡ªå®šä¹‰ç±»"></a>1. åç«¯ - è‡ªå®šä¹‰ç±»</h1>
<h2 id="1-1-JSR-303-å¼‚å¸¸ä¿¡æ¯ç±»"><a class="header-anchor" href="#1-1-JSR-303-å¼‚å¸¸ä¿¡æ¯ç±»"></a>1.1 JSR-303 å¼‚å¸¸ä¿¡æ¯ç±»</h2>
<p>JSR-303 å¼‚å¸¸ä¿¡æ¯ç±»ï¼Œåœ¨ä½¿ç”¨ SpringBoot è¿›è¡Œå…¨å±€å¼‚å¸¸å¤„ç†æ—¶ï¼Œé’ˆå¯¹äº§ç”Ÿçš„ <code>MethodArgumentNotValidException</code> å¼‚å¸¸è¿›è¡Œé”™è¯¯ä¿¡æ¯ç»„è£…ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Getter</span></span><br><span class="line"><span class="meta">@Setter</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JSR303ExceptionMessage</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é”™è¯¯å­—æ®µ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String field;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é”™è¯¯å¯¹è±¡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String objectName;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é”™è¯¯çš„å€¼</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Object rejectedValue;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é”™è¯¯ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String errorMsg;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="1-2-è‡ªå®šä¹‰ä¸šåŠ¡å¼‚å¸¸ç±»"><a class="header-anchor" href="#1-2-è‡ªå®šä¹‰ä¸šåŠ¡å¼‚å¸¸ç±»"></a>1.2 è‡ªå®šä¹‰ä¸šåŠ¡å¼‚å¸¸ç±»</h2>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è‡ªå®šä¹‰ä¸šåŠ¡å¼‚å¸¸ç±»ï¼Œç”¨äºåœ¨ä¸šåŠ¡å±‚æŠ›å‡ºå¼‚å¸¸</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BusinessException</span> <span class="keyword">extends</span> <span class="title class_">RuntimeException</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> <span class="number">5382880814065968592L</span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é»˜è®¤å¼‚å¸¸ç </span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">String</span> <span class="variable">code</span> <span class="operator">=</span> <span class="string">&quot;BOOT-001&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Set&lt;String&gt; errors = <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">BusinessException</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">BusinessException</span><span class="params">(String code)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.code = code;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">BusinessException</span><span class="params">(String code, Throwable cause)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(cause);</span><br><span class="line">        <span class="built_in">this</span>.code = code;</span><br><span class="line">        <span class="built_in">this</span>.errors.add(cause.getMessage());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> BusinessException <span class="title function_">addError</span><span class="params">(String msg)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.errors.add(msg);</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getMessage</span><span class="params">()</span> &#123;</span><br><span class="line">        String msg;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">this</span>.errors.isEmpty()) &#123;</span><br><span class="line">            msg = <span class="built_in">super</span>.getMessage();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>(<span class="built_in">this</span>.errors.size() * <span class="number">15</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (String message : <span class="built_in">this</span>.errors) &#123;</span><br><span class="line">                sb.append(message).append(<span class="string">&quot;,&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            sb.deleteCharAt(sb.length() - <span class="number">1</span>);</span><br><span class="line">            msg = sb.toString();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> msg == <span class="literal">null</span> ? <span class="built_in">this</span>.code() : msg;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">code</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.code;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">message</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.getMessage();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="1-3-ç»Ÿä¸€è¿”å›å€¼"><a class="header-anchor" href="#1-3-ç»Ÿä¸€è¿”å›å€¼"></a>1.3 ç»Ÿä¸€è¿”å›å€¼</h2>
<p>åç«¯ Service å±‚éƒ½å°†ç»Ÿä¸€è¿”å›ä¸€ä¸ªç±»å‹ï¼Œä¾¿äºåç»­æ“ä½œã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> mofan 2021/2/28</span></span><br><span class="line"><span class="comment"> * æ§åˆ¶å™¨ç»“æœä¿¡æ¯è¿”å›ç±»</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Result</span>&lt;T&gt; <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> <span class="number">5244827382777974660L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">SUCCESS_CODE</span> <span class="operator">=</span> <span class="string">&quot;BOOT-000&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String code;</span><br><span class="line">    <span class="keyword">private</span> String msg;</span><br><span class="line">    <span class="keyword">private</span> T data;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ˜¯å¦éœ€è¦æ‰“å°æ—¥å¿—çš„æ ‡å¿—</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> <span class="variable">log</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; Result&lt;T&gt; <span class="title function_">success</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Result</span>&lt;&gt;();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; Result&lt;T&gt; <span class="title function_">success</span><span class="params">(T data)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Result</span>&lt;&gt;(data);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; Result&lt;T&gt; <span class="title function_">error</span><span class="params">(String code, String msg)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Result</span>&lt;&gt;(code, msg);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Result</span><span class="params">(String code, String msg)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.code = code;</span><br><span class="line">        <span class="built_in">this</span>.msg = msg;</span><br><span class="line">        <span class="built_in">this</span>.data = <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Result</span><span class="params">(T data)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.code = SUCCESS_CODE;</span><br><span class="line">        <span class="built_in">this</span>.msg = ResultMsg.SUCCESS;</span><br><span class="line">        <span class="built_in">this</span>.data = data;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Result</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.code = SUCCESS_CODE;</span><br><span class="line">        <span class="built_in">this</span>.msg = ResultMsg.SUCCESS;</span><br><span class="line">        <span class="built_in">this</span>.data = <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getCode</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> code;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Result&lt;T&gt; <span class="title function_">setCode</span><span class="params">(String code)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.code = code;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getMsg</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> msg;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Result&lt;T&gt; <span class="title function_">setMsg</span><span class="params">(String msg)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.msg = msg;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> T <span class="title function_">getData</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> data;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setData</span><span class="params">(T data)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.data = data;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isLog</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.log;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Result&lt;T&gt; <span class="title function_">setLog</span><span class="params">(<span class="type">boolean</span> log)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.log = log;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="1-4-åˆ†é¡µè¯·æ±‚å¯¹è±¡"><a class="header-anchor" href="#1-4-åˆ†é¡µè¯·æ±‚å¯¹è±¡"></a>1.4 åˆ†é¡µè¯·æ±‚å¯¹è±¡</h2>
<p>ä¸ºæ–¹ä¾¿åœ¨æŸ¥è¯¢æ—¶è¿›è¡Œåˆ†é¡µæ“ä½œï¼Œè§„å®šå°†å‰ç«¯ä¼ é€’çš„åˆ†é¡µè¯·æ±‚è¿›è¡ŒåŒ…è£…ã€‚</p>
<p><mark>æ³¨æ„ï¼š</mark> åç«¯ä½¿ç”¨çš„æ•°æ®æŒä¹…å±‚æ¡†æ¶æ˜¯ Mybatis-Plusã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Getter</span></span><br><span class="line"><span class="meta">@Setter</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PageRequest</span>&lt;T&gt; &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å½“å‰é¡µæ•°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Integer currentPage;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é¡µé¢æ•°æ®å¤§å°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Integer pageSize;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¯·æ±‚æ•°æ®</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Map&lt;String, Object&gt; data;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ® PageRequest è·å– MyBatis-Plus çš„åˆ†é¡µå¯¹è±¡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> pageRequest å‰ç«¯ä¼ é€’çš„ PageRequest ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> &lt;T&gt; æ³›å‹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> MP çš„ Page åˆ†é¡µå¯¹è±¡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span>&lt;T&gt; Page&lt;T&gt; <span class="title function_">getPageInfo</span><span class="params">(PageRequest&lt;T&gt; pageRequest)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Page</span>&lt;&gt;(pageRequest.getCurrentPage(), pageRequest.getPageSize());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="1-5-æšä¸¾æ¥å£"><a class="header-anchor" href="#1-5-æšä¸¾æ¥å£"></a>1.5 æšä¸¾æ¥å£</h2>
<p>åç«¯ä¸­çš„å¤§å¤šæ•°æšä¸¾éƒ½éœ€è¦å®ç°è¿™ä¸ªæ¥å£å¹¶é‡å†™å…¶ä¸­çš„æ–¹æ³•ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> mofan 2021/2/1</span></span><br><span class="line"><span class="comment"> * æšä¸¾ä¿¡æ¯ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œæ¯ä¸ªæšä¸¾ç±»éƒ½åº”è¯¥å®ç°è¿™ä¸ªæ¥å£</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">EnumInfo</span> <span class="keyword">extends</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–æšä¸¾å€¼å¯¹åº”çš„ä»£ç </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> å¯¹åº”çš„ä»£ç </span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    String <span class="title function_">code</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–æšä¸¾å€¼å¯¹åº”çš„ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> å¯¹åº”çš„ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    String <span class="title function_">message</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="1-6-å®ä½“åŸºç±»"><a class="header-anchor" href="#1-6-å®ä½“åŸºç±»"></a>1.6 å®ä½“åŸºç±»</h2>
<p>åç«¯ä¸­ä½¿ç”¨åˆ°çš„ <strong>æ‰€æœ‰</strong> å®ä½“éƒ½éœ€è¦ç»§æ‰¿å®ä½“åŸºç±»ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> mofan 2021/2/1</span></span><br><span class="line"><span class="comment"> * å®ä½“åŸºç±»ï¼Œæ¯ä¸ªå®ä½“éƒ½éœ€è¦ç»§æ‰¿è¯¥ç±»</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">BaseEntity</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> <span class="number">6581451145034114785L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸»é”® é›ªèŠ±ç®—æ³•</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@TableId(type = IdType.ASSIGN_ID)</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ›å»ºæ—¶é—´</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@TableField(fill = FieldFill.INSERT)</span></span><br><span class="line">    <span class="keyword">private</span> Date createTime;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ›´æ–°æ—¶é—´</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@TableField(fill = FieldFill.INSERT_UPDATE)</span></span><br><span class="line">    <span class="keyword">private</span> Date updateTime;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ˜¯å¦è¢«åˆ é™¤ ä½¿ç”¨é€»è¾‘åˆ é™¤</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@TableField(fill = FieldFill.INSERT, value = &quot;is_deleted&quot;)</span></span><br><span class="line">    <span class="meta">@TableLogic</span></span><br><span class="line">    <span class="keyword">private</span> Integer deleted;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Integer <span class="title function_">getDeleted</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> deleted;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setDeleted</span><span class="params">(Integer deleted)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.deleted = deleted;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Long <span class="title function_">getId</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setId</span><span class="params">(Long id)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Date <span class="title function_">getCreateTime</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> createTime;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@JsonFormat(pattern = &quot;yyyy-MM-dd HH:mm:ss&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setCreateTime</span><span class="params">(Date createTime)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.createTime = createTime;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Date <span class="title function_">getUpdateTime</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> updateTime;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@JsonFormat(pattern = &quot;yyyy-MM-dd HH:mm:ss&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setUpdateTime</span><span class="params">(Date updateTime)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.updateTime = updateTime;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="1-7-æ•°æ®ä¼ è¾“å¯¹è±¡åŸºç±»"><a class="header-anchor" href="#1-7-æ•°æ®ä¼ è¾“å¯¹è±¡åŸºç±»"></a>1.7 æ•°æ®ä¼ è¾“å¯¹è±¡åŸºç±»</h2>
<p>åç«¯ä½¿ç”¨åˆ°çš„æ‰€æœ‰ DTOï¼ˆæ•°æ®ä¼ è¾“å¯¹è±¡ï¼‰éƒ½éœ€è¦ç»§æ‰¿æ•°æ®ä¼ è¾“å¯¹è±¡åŸºç±»ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> mofan 2021/2/1</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">BaseDto</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> -<span class="number">6349988895227283284L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸»é”®</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@JsonSerialize(using = ToStringSerializer.class)</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">BaseDto</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Long <span class="title function_">getId</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setId</span><span class="params">(Long id)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="2-åç«¯-SpringBoot"><a class="header-anchor" href="#2-åç«¯-SpringBoot"></a>2. åç«¯ - SpringBoot</h1>
<h2 id="2-1-ç»Ÿä¸€å¼‚å¸¸æ‹¦æˆª"><a class="header-anchor" href="#2-1-ç»Ÿä¸€å¼‚å¸¸æ‹¦æˆª"></a>2.1 ç»Ÿä¸€å¼‚å¸¸æ‹¦æˆª</h2>
<p>ä¸ºäº†æ›´å¥½åœ°å¤„ç†åç«¯ä»£ç ä¸­çš„å¼‚å¸¸ä¿¡æ¯ï¼Œå¯ä»¥ä½¿ç”¨ SpringBoot æä¾›çš„ç»Ÿä¸€å¼‚å¸¸æ‹¦æˆªã€‚</p>
<p>æ­¥éª¤ä¹Ÿå¾ˆç®€å•ï¼š</p>
<p>1ã€åˆ›å»ºä¸€ä¸ªå…¨å±€å¼‚å¸¸æ‹¦æˆªå™¨ç±»ï¼Œå‡è®¾å«ï¼š<code>GlobalExceptionInterceptor</code>ï¼›</p>
<p>2ã€åœ¨è¿™ä¸ªç±»ä¸Šä½¿ç”¨æ³¨è§£ï¼š<code>@ControllerAdvice</code>ï¼›</p>
<p>3ã€åœ¨è¿™ä¸ªç±»ä¸­ç¼–å†™å¤„ç†å„ä¸ªå¼‚å¸¸çš„æ–¹æ³•ï¼ˆé€šå¸¸å¤„ç†ä¸€ä¸ªå¼‚å¸¸ç¼–å†™ä¸€ä¸ªæ–¹æ³•ï¼‰ï¼Œå¹¶åœ¨æ–¹æ³•ä¸Šä½¿ç”¨æ³¨è§£ï¼š <code>@ExceptionHandler</code>ï¼Œè¿™ä¸ªæ³¨è§£çš„ value å±æ€§å€¼ä¸ºè¢«å¤„ç†çš„å¼‚å¸¸ç±»ã€‚</p>
<p>æ¯”å¦‚æˆ‘æ‰€ä½¿ç”¨çš„å…¨å±€å¼‚å¸¸æ‹¦æˆªå™¨ç±»æ˜¯è¿™æ ·çš„ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@ControllerAdvice</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GlobalExceptionInterceptor</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”¨äº DTO çš„ JSR303 æ ¡éªŒè¿”å›</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> e       å¼‚å¸¸</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> å¼‚å¸¸ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ExceptionHandler(value = MethodArgumentNotValidException.class)</span></span><br><span class="line">    <span class="keyword">public</span> Result&lt;JSR303ExceptionMessage&gt; <span class="title function_">jsr303ExceptionHandler</span><span class="params">(MethodArgumentNotValidException e)</span> &#123;</span><br><span class="line">        <span class="type">JSR303ExceptionMessage</span> <span class="variable">jsr303ExceptionMessage</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JSR303ExceptionMessage</span>();</span><br><span class="line">        <span class="type">FieldError</span> <span class="variable">fieldError</span> <span class="operator">=</span> Objects.requireNonNull(e.getBindingResult().getFieldError());</span><br><span class="line">        jsr303ExceptionMessage.setErrorMsg(fieldError.getDefaultMessage());</span><br><span class="line">        jsr303ExceptionMessage.setField(fieldError.getField());</span><br><span class="line">        jsr303ExceptionMessage.setObjectName(fieldError.getObjectName());</span><br><span class="line">        jsr303ExceptionMessage.setRejectedValue(fieldError.getRejectedValue());</span><br><span class="line"></span><br><span class="line">        Result&lt;JSR303ExceptionMessage&gt; result = <span class="keyword">new</span> <span class="title class_">Result</span>&lt;&gt;();</span><br><span class="line">        result.setCode(ErrorCode.JSR303_VERIFICATION_FAILED).setMsg(<span class="string">&quot;æäº¤çš„æ•°æ®é”™è¯¯&quot;</span>).setData(jsr303ExceptionMessage);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸šåŠ¡å±‚æŠ›å‡ºçš„å¼‚å¸¸ BusinessException</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> e å¼‚å¸¸ç±»å‹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> é”™è¯¯ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ExceptionHandler(value = BusinessException.class)</span></span><br><span class="line">    <span class="keyword">public</span> Result&lt;BusinessException&gt; <span class="title function_">businessExceptionHandler</span><span class="params">(BusinessException e)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Result.error(e.code(), e.message());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Excel è§£æå¼‚å¸¸</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> e å¼‚å¸¸ç±»å‹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> é”™è¯¯ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ExceptionHandler(value = ExcelAnalysisException.class)</span></span><br><span class="line">    <span class="keyword">public</span> Result&lt;ExcelAnalysisException&gt; <span class="title function_">excelAnalysisExceptionHandler</span><span class="params">(ExcelAnalysisException e)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Result.error(ErrorCode.EXCEL_ANALYSIS_ERROR, e.getMessage());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç»Ÿä¸€å¼‚å¸¸æ‹¦æˆªå‘ä¸ŠæŠ›å‡º AccessDeniedException å¼‚å¸¸ï¼Œç”±è‡ªå®šä¹‰ AccessDeniedHandler è¿›è¡Œå¤„ç†</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> e å¼‚å¸¸ç±»å‹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> AccessDeniedException è®¿é—®æ‹’ç»å¼‚å¸¸</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ExceptionHandler(value = AccessDeniedException.class)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">accessDeniedExceptionHandler</span><span class="params">(AccessDeniedException e)</span> <span class="keyword">throws</span> AccessDeniedException&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">AccessDeniedException</span>(<span class="string">&quot;æ²¡æœ‰è®¿é—®æƒé™&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸Šä¼ æ–‡ä»¶å°ºå¯¸è¿‡å¤§ï¼Œè¶…è¿‡é»˜è®¤ 10MB æˆ–ç»è¿‡é…ç½®çš„å¤§å°</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> e å¼‚å¸¸ç±»å‹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> é”™è¯¯ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ExceptionHandler(value = MaxUploadSizeExceededException.class)</span></span><br><span class="line">    <span class="keyword">public</span> Result&lt;MaxUploadSizeExceededException&gt; <span class="title function_">maxUploadSizeExceededException</span><span class="params">(MaxUploadSizeExceededException e)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Result.error(ErrorCode.MAX_UPLOAD_SIZE_EXCEEDED, <span class="string">&quot;ä¸Šä¼ æ–‡ä»¶å°ºå¯¸è¿‡å¤§&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ExceptionHandler(value = OSSException.class)</span></span><br><span class="line">    <span class="keyword">public</span> Result&lt;OSSException&gt; <span class="title function_">ossException</span><span class="params">(OSSException e)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Result.error(ErrorCode.UPLOAD_FILE_TO_OSS_ERROR, <span class="string">&quot;ä¸Šä¼ è‡³å®¢æˆ·ç«¯å¤±è´¥&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ExceptionHandler(value = ClientException.class)</span></span><br><span class="line">    <span class="keyword">public</span> Result&lt;ClientException&gt; <span class="title function_">clientException</span><span class="params">(ClientException e)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Result.error(ErrorCode.ALI_OSS_CLIENT_ERROR, <span class="string">&quot;æ–‡ä»¶å®¢æˆ·ç«¯å¼‚å¸¸ï¼Œè¯·è”ç³»ç³»ç»Ÿç®¡ç†å‘˜å¤„ç†ï¼&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å„ç§éå…·ä½“æŒ‡å®šå¼‚å¸¸çš„ç»Ÿä¸€å¤„ç†</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> e å¼‚å¸¸ç±»å‹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> é”™è¯¯ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ExceptionHandler(value = Exception.class)</span></span><br><span class="line">    <span class="keyword">public</span> Result&lt;Exception&gt; <span class="title function_">exceptionHandler</span><span class="params">(Exception e)</span> &#123;</span><br><span class="line">        log.error(e.getMessage());</span><br><span class="line">        <span class="keyword">return</span> Result.error(ErrorCode.UNKNOWN_ERROR, <span class="string">&quot;æœªçŸ¥çš„é”™è¯¯ï¼Œè¯·è”ç³»ç³»ç»Ÿç®¡ç†å‘˜å¤„ç†ï¼&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="2-2-JSR-303-æ ¡éªŒ"><a class="header-anchor" href="#2-2-JSR-303-æ ¡éªŒ"></a>2.2 JSR-303 æ ¡éªŒ</h2>
<p>å‰ç«¯ä¼ é€’æ•°æ®ä½œä¸ºåç«¯æ–¹æ³•çš„å…¥å‚æ—¶ï¼Œæˆ‘ä»¬éœ€è¦å¯¹è¿™äº›å‚æ•°è¿›è¡Œæ ¡éªŒï¼Œæ¯”æ–¹è¯´æ£€éªŒæ˜¯å¦éç©ºã€‚ä¸ºäº†ä½¿ä»£ç ç®€æ´è€Œä¸é‡‡å– <code>if - else</code> çš„æ–¹å¼è¿›è¡Œåˆ¤æ–­ï¼Œè€Œæ˜¯é‡‡ç”¨ JSR-303 æ£€éªŒã€‚</p>
<p>æ­¥éª¤ä¹Ÿå¾ˆç®€å•ï¼š</p>
<p>1ã€ä¸º Controller é‡Œæ–¹æ³•çš„å‚æ•°ä½¿ç”¨ <code>@Valid</code> æ³¨è§£ï¼›</p>
<p>2ã€åœ¨å‚æ•°å¯¹åº”çš„ç±»çš„å±æ€§ä¸Šä½¿ç”¨ JSR-303 æ³¨è§£ã€‚</p>
<p>æ¯”å¦‚ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PostMapping(&quot;submit&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Result&lt;Long&gt; <span class="title function_">saveOrUpdate</span><span class="params">(<span class="meta">@Valid</span> <span class="meta">@RequestBody</span> DeptDefinitionDto dto)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (dto.getId() == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> deptService.createDept(dto);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> deptService.updateDeptInfo(dto);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>DeptDefinitionDto</code> å¯¹åº”çš„éƒ¨åˆ†ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Getter</span></span><br><span class="line"><span class="meta">@Setter</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DeptDefinitionDto</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * éƒ¨é—¨åç§°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@NotNull(message = &quot;éƒ¨é—¨åç§°ä¸èƒ½ä¸ºç©º&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String deptName;</span><br><span class="line">    </span><br><span class="line">     <span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¼ çœŸç”µè¯</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@FaxNum(notNull = false)</span></span><br><span class="line">    <span class="keyword">private</span> String fax;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="2-3-è‡ªå®šä¹‰æ ¡éªŒæ³¨è§£"><a class="header-anchor" href="#2-3-è‡ªå®šä¹‰æ ¡éªŒæ³¨è§£"></a>2.3 è‡ªå®šä¹‰æ ¡éªŒæ³¨è§£</h2>
<p>åœ¨ç‰¹å®šçš„åœºæ™¯ä¸‹ï¼Œä½¿ç”¨ JSR-303 æä¾›çš„æ³¨è§£æ— æ³•å®Œæˆæˆ‘ä»¬çš„æ ¡éªŒéœ€æ±‚ï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦è‡ªå®šä¹‰æ³¨è§£ï¼Œæ¯”æ–¹è¯´å‰æ–‡ä¸­ <code>DeptDefinitionDto</code> ç±»ä¸­çš„ <code>@FaxNum</code> æ³¨è§£ã€‚</p>
<p>è‡ªå®šä¹‰æ³¨è§£çš„æ­¥éª¤ä¹Ÿå¾ˆç®€å•ï¼š</p>
<p>1ã€åˆ›å»ºè‡ªå®šä¹‰æ³¨è§£ï¼Œæ³¨è§£ä¸­è¦æœ‰å±æ€§ <code>message</code>ã€<code>groups</code> å’Œ <code>payload</code>ï¼Œè¿˜è¦åœ¨è‡ªå®šä¹‰çš„æ³¨è§£ä¸Šä½¿ç”¨æ³¨è§£ <code>@Constraint</code>ï¼Œå¹¶æŒ‡å®šå…¶ <code>validatedBy</code> å±æ€§å€¼ä¸ºè‡ªå®šä¹‰çš„çº¦æŸéªŒè¯å™¨ï¼ˆç¬¬äºŒæ­¥åˆ›å»ºï¼‰ã€‚</p>
<p>2ã€åˆ›å»ºè‡ªå®šä¹‰çš„çº¦æŸéªŒè¯å™¨ï¼Œè¿™ä¸ªç±»å®ç° <code>ConstraintValidator</code> æ¥å£ï¼Œè¿™ä¸ªæ¥å£çš„æ³›å‹ä¸ºï¼šè‡ªå®šä¹‰çš„æ³¨è§£å’Œéœ€è¦è¢«æ ¡éªŒçš„å‚æ•°ç±»å‹ã€‚</p>
<p>æ¯”å¦‚ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Constraint(validatedBy = FaxNumValidator.class)</span></span><br><span class="line"><span class="meta">@Target(&#123;ElementType.PARAMETER, ElementType.FIELD&#125;)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> FaxNum &#123;</span><br><span class="line">    String <span class="title function_">message</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;ä¼ çœŸç”µè¯å·ç æ ¼å¼é”™è¯¯&quot;</span>;</span><br><span class="line"></span><br><span class="line">    Class[] groups() <span class="keyword">default</span> &#123;&#125;;</span><br><span class="line"></span><br><span class="line">    Class[] payload() <span class="keyword">default</span> &#123;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ˜¯å¦è¿›è¡Œéç©ºéªŒè¯</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">notNull</span><span class="params">()</span> <span class="keyword">default</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è‡ªå®šä¹‰çº¦æŸéªŒè¯å™¨ <code>FaxNumValidator</code>ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FaxNumValidator</span> <span class="keyword">implements</span> <span class="title class_">ConstraintValidator</span>&lt;FaxNum, String&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">FAX_NUM_REG_EXP</span> <span class="operator">=</span> <span class="string">&quot;\\d&#123;3&#125;-\\d&#123;8&#125;|\\d&#123;4&#125;-\\d&#123;7&#125;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="variable">notNull</span> <span class="operator">=</span> <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æˆå‘˜å˜é‡åˆå§‹åŒ–</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">initialize</span><span class="params">(FaxNum constraintAnnotation)</span> &#123;</span><br><span class="line">        notNull = constraintAnnotation.notNull();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ£€éªŒè§„åˆ™</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isValid</span><span class="params">(String s, ConstraintValidatorContext constraintValidatorContext)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (s == <span class="literal">null</span> || <span class="string">&quot;&quot;</span>.equals(s)) &#123;</span><br><span class="line">            <span class="keyword">return</span> !notNull;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> s.matches(FAX_NUM_REG_EXP);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨ä¸Šè¿°ä»£ç ä¸­ä½¿ç”¨äº†æ­£åˆ™è¡¨è¾¾å¼è¿›è¡Œå†…å®¹éªŒè¯ï¼Œå¸¸ç”¨çš„æ­£åˆ™è¡¨è¾¾å¼å‚è€ƒï¼š<strong>æ­£åˆ™è¡¨è¾¾å¼åœ¨çº¿æµ‹è¯•</strong> <sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup></p>
<h2 id="2-4-æ–‡ä»¶ä¸Šä¼ é™åˆ¶"><a class="header-anchor" href="#2-4-æ–‡ä»¶ä¸Šä¼ é™åˆ¶"></a>2.4 æ–‡ä»¶ä¸Šä¼ é™åˆ¶</h2>
<p>åœ¨ä¸Šä¼ æ–‡ä»¶æ—¶ï¼ŒSpring é»˜è®¤å•ä¸ªæ–‡ä»¶æœ€å¤§ä¸º 1Mï¼Œå•æ¬¡è¯·æ±‚ä¸­æ–‡ä»¶å¤§å°åˆè®¡æœ€å¤§ä¸º 10Mï¼Œå¦‚æœæŸ¥è¿‡è¿™ä¸ªæ•°å€¼å°±ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚</p>
<p>å½“ç„¶è¿™äº›æ•°å€¼ä¹Ÿæ˜¯å¯ä»¥ä¿®æ”¹çš„ï¼Œåªéœ€è¦åœ¨é…ç½®æ–‡ä»¶è¿½åŠ ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">servlet:</span></span><br><span class="line">    <span class="attr">multipart:</span></span><br><span class="line">      <span class="comment"># å•ä¸ªæ–‡ä»¶æœ€å¤§å¤§å°</span></span><br><span class="line">      <span class="attr">max-file-size:</span> <span class="string">20MB</span></span><br><span class="line">      <span class="comment"># è¯·æ±‚ä¸­æ–‡ä»¶å¤§å°åˆè®¡æœ€å¤§</span></span><br><span class="line">      <span class="attr">max-request-size:</span> <span class="string">200MB</span></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">tomcat:</span></span><br><span class="line">    <span class="comment"># ä¸é™åˆ¶å†…åµŒ Tomcat æœ€å¤§ååé‡ï¼Œç”¨äºå…¨å±€å¼‚å¸¸å¤„ç†è¿›è¡Œæ•è·</span></span><br><span class="line">    <span class="attr">max-swallow-size:</span> <span class="number">-1</span></span><br></pre></td></tr></table></figure>
<p>å¹¶åœ¨å…¨å±€å¼‚å¸¸æ‹¦æˆªä¸­è¿½åŠ ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* ä¸Šä¼ æ–‡ä»¶å°ºå¯¸è¿‡å¤§ï¼Œè¶…è¿‡é»˜è®¤ 10MB æˆ–ç»è¿‡é…ç½®çš„å¤§å°</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> e å¼‚å¸¸ç±»å‹</span></span><br><span class="line"><span class="comment">* <span class="doctag">@return</span> é”™è¯¯ä¿¡æ¯</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@ExceptionHandler(value = MaxUploadSizeExceededException.class)</span></span><br><span class="line"><span class="keyword">public</span> Result&lt;MaxUploadSizeExceededException&gt; <span class="title function_">maxUploadSizeExceededException</span><span class="params">(MaxUploadSizeExceededException e)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> Result.error(ErrorCode.MAX_UPLOAD_SIZE_EXCEEDED, <span class="string">&quot;ä¸Šä¼ æ–‡ä»¶å°ºå¯¸è¿‡å¤§&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="3-åç«¯-é˜¿é‡Œäº‘-OSS"><a class="header-anchor" href="#3-åç«¯-é˜¿é‡Œäº‘-OSS"></a>3. åç«¯ - é˜¿é‡Œäº‘ OSS</h1>
<p>åœ¨æœ¬æ¬¡çš„é¡¹ç›®ä¸­ä½¿ç”¨åˆ°äº†é˜¿é‡Œäº‘ OSSï¼Œç”¨äºå­˜å‚¨éœ€è¦ä¸Šä¼ çš„æ–‡ä»¶ã€‚åœ¨æ­¤ä»‹ç»ä¸€ä¸‹åç«¯æ•´åˆé˜¿é‡Œäº‘ OSS çš„æ–¹æ³•ï¼Œé»˜è®¤å·²æ³¨å†Œé˜¿é‡Œäº‘ï¼Œå¹¶æˆåŠŸé…ç½® OSSï¼ˆè·å–åˆ°å…¬é’¥å’Œç§é’¥ï¼‰ã€‚</p>
<p>é¦–å…ˆéœ€è¦å¯¼å…¥ä¾èµ–ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.aliyun.oss<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>aliyun-sdk-oss<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.10.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>ç„¶ååœ¨é…ç½®æ–‡ä»¶ä¸­è¿½åŠ ä»¥ä¸‹é…ç½®ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é˜¿é‡Œossé…ç½®</span></span><br><span class="line"><span class="attr">oss:</span></span><br><span class="line">  <span class="attr">endpoint:</span> <span class="string">oss-cn-chengdu.aliyuncs.com</span>   <span class="comment"># ossåœ°åŸŸå</span></span><br><span class="line">  <span class="attr">accessKeyId:</span> <span class="string">xxxx</span>  <span class="comment"># å…¬é’¥</span></span><br><span class="line">  <span class="attr">accessKeySecret:</span> <span class="string">xxxx</span> <span class="comment"># ç§é’¥</span></span><br><span class="line">  <span class="attr">bucketName:</span> <span class="string">gsams-files</span>  <span class="comment"># bucketåç§°</span></span><br><span class="line">  <span class="attr">dirName:</span> <span class="string">exam-outline/</span>  <span class="comment"># æ–‡ä»¶ç›®å½•</span></span><br></pre></td></tr></table></figure>
<p><mark>æ³¨æ„ï¼š</mark> å¯¼å…¥çš„ä¾èµ–å¹¶ä¸æ˜¯ SpringBoot çš„ starterï¼Œä»…ä»…æ˜¯ OSS çš„ SDKï¼Œè¿™é‡Œç¼–å†™çš„é…ç½®æ–‡ä»¶ä»…ä»…æ˜¯ä¸ºäº†æ–¹ä¾¿ç®¡ç†ï¼Œå¦‚æœä¸å†™åœ¨é…ç½®æ–‡ä»¶ä¸­ï¼Œä¹Ÿå¯ä»¥ç¡¬ç¼–ç åœ¨ Java ä»£ç ä¸­ã€‚</p>
<p>è¯»å–è¿½åŠ çš„ OSS é…ç½®ä¿¡æ¯ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> mofan</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2021/6/2 13:43</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Getter</span></span><br><span class="line"><span class="meta">@Setter</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OssConstant</span> <span class="keyword">implements</span> <span class="title class_">InitializingBean</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ–‡ä»¶æœ€å¤§ä¸Šä¼ å¤§å°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">long</span> <span class="variable">FILE_MAX_SIZE</span> <span class="operator">=</span> <span class="number">1024</span> * <span class="number">1024</span> * <span class="number">10L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å›¾ç‰‡è¿‡æœŸæ—¶é—´ 100å¹´</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">long</span> <span class="variable">FILE_EXPIRATION_TIME</span> <span class="operator">=</span> <span class="number">1000L</span> * <span class="number">3600L</span> * <span class="number">24L</span> * <span class="number">365L</span> * <span class="number">100L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String END_POINT;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String ACCESS_KEY_ID;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String ACCESS_KEY_SECRET;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String BUCKET_NAME;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String DIR_NAME;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é˜¿é‡Œäº‘ oss ç«™ç‚¹</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;oss.endpoint&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String endpoint;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é˜¿é‡Œäº‘ oss å…¬é’¥</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;oss.accessKeyId&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String accessKeyId;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é˜¿é‡Œäº‘ oss ç§é’¥</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;oss.accessKeySecret&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String accessKeySecret;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é˜¿é‡Œäº‘ oss æ–‡ä»¶æ ¹ç›®å½•</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;oss.bucketName&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String bucketName;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ–‡ä»¶ç›®å½•</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;oss.dirName&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String dirName;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterPropertiesSet</span><span class="params">()</span> &#123;</span><br><span class="line">        END_POINT = endpoint;</span><br><span class="line">        ACCESS_KEY_ID = accessKeyId;</span><br><span class="line">        ACCESS_KEY_SECRET = accessKeySecret;</span><br><span class="line">        BUCKET_NAME = bucketName;</span><br><span class="line">        DIR_NAME = dirName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç¼–å†™ OSS çš„é…ç½®ç±»ï¼Œå°†è¯»å–åˆ°çš„é…ç½®ä¿¡æ¯æ³¨å…¥åˆ° Spring ä¸­ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> mofan</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2021/6/2 13:46</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OssConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> OSSClient <span class="title function_">ossClient</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">OSSClient</span>(</span><br><span class="line">                OssConstant.END_POINT,</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">DefaultCredentialProvider</span>(OssConstant.ACCESS_KEY_ID, OssConstant.ACCESS_KEY_SECRET),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">ClientConfiguration</span>());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æœ€åç¼–å†™å…·ä½“ Service æœåŠ¡ï¼ˆä»…ä»¥æ–‡ä»¶ä¸Šä¼ ä¸ºä¾‹ï¼‰ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> mofan</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2021/6/2 13:48</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OssService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> OSSClient ossClient;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸Šä¼  PDF æ–‡ä»¶è‡³é˜¿é‡Œäº‘ OSS</span></span><br><span class="line"><span class="comment">     * æ–‡ä»¶ä¸Šä¼ æˆåŠŸ,è¿”å›æ–‡ä»¶å®Œæ•´è®¿é—®è·¯å¾„</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> file ä¸Šä¼ æ–‡ä»¶</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> æ–‡ä»¶åœ°å€</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Result&lt;String&gt; <span class="title function_">uploadPdf</span><span class="params">(MultipartFile file)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (FileUtil.isNotPdfFile(file)) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;pdfæ–‡ä»¶ä¸Šä¼ å¤±è´¥&quot;</span>);</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.FILE_TYPE_ERROR).addError(<span class="string">&quot;ä¸Šä¼ æ–‡ä»¶ç±»å‹é”™è¯¯&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (file.getSize() &lt;= <span class="number">0</span> || file.getSize() &gt; OssConstant.FILE_MAX_SIZE) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.FILE_SIZE_TOO_LARGE).addError(<span class="string">&quot;å°ºå¯¸è¿‡å¤§&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// æ–‡ä»¶å…¨åç§°åŒ…æ‹¬åç¼€</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">oldName</span> <span class="operator">=</span> file.getOriginalFilename();</span><br><span class="line">        Assert.notNull(oldName, <span class="string">&quot;æ–‡ä»¶å…¨åç§°ä¸èƒ½ä¸ºç©º&quot;</span>);</span><br><span class="line">        <span class="comment">// æ–‡ä»¶åç¼€</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">suffix</span> <span class="operator">=</span> oldName.substring(oldName.lastIndexOf(<span class="string">&quot;.&quot;</span>) + <span class="number">1</span>);</span><br><span class="line">        <span class="comment">// æ–‡ä»¶åç§° ä¸åŒ…æ‹¬åç¼€</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">prefix</span> <span class="operator">=</span> oldName.substring(<span class="number">0</span>, oldName.lastIndexOf(<span class="string">&quot;.&quot;</span>));</span><br><span class="line">        <span class="comment">// æ–°æ–‡ä»¶åç§° æ–‡ä»¶ç›®å½•è·¯å¾„ + uuidï¼ˆä¸å¸¦ -ï¼‰ + æ—§æ–‡ä»¶å</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">fileName</span> <span class="operator">=</span> OssConstant.DIR_NAME + IdUtil.simpleUUID()</span><br><span class="line">                .replace(<span class="string">&quot;-&quot;</span>, <span class="string">&quot;&quot;</span>) + <span class="string">&quot;_&quot;</span> + oldName;</span><br><span class="line">        <span class="comment">// è·å–æ–‡ä»¶ç±»å‹</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">fileType</span> <span class="operator">=</span> contentType(suffix);</span><br><span class="line">        <span class="keyword">try</span> (<span class="type">InputStream</span> <span class="variable">inputStream</span> <span class="operator">=</span> file.getInputStream())&#123;</span><br><span class="line">            <span class="keyword">return</span> Result.success(putFile(inputStream, fileType, fileName));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.FILE_IO_ERROR).addError(<span class="string">&quot;PDFä¸Šä¼ å¤±è´¥&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸Šä¼ æ–‡ä»¶</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> input    æ–‡ä»¶è¾“å…¥æµ</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> fileType æ–‡ä»¶ç±»å‹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> fileName æ–‡ä»¶å</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> æ–‡ä»¶åœ°å€</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String <span class="title function_">putFile</span><span class="params">(InputStream input, String fileType, String fileName)</span> &#123;</span><br><span class="line">        <span class="comment">// åˆ›å»ºä¸Šä¼ Objectçš„Metadata</span></span><br><span class="line">        <span class="type">ObjectMetadata</span> <span class="variable">meta</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectMetadata</span>();</span><br><span class="line">        <span class="comment">// è®¾ç½®ä¸Šä¼ å†…å®¹ç±»å‹</span></span><br><span class="line">        meta.setContentType(fileType);</span><br><span class="line">        <span class="comment">//è¢«ä¸‹è½½æ—¶ç½‘é¡µçš„ç¼“å­˜è¡Œä¸º</span></span><br><span class="line">        meta.setCacheControl(<span class="string">&quot;no-cache&quot;</span>);</span><br><span class="line">        <span class="comment">//åˆ›å»ºä¸Šä¼ è¯·æ±‚</span></span><br><span class="line">        <span class="type">PutObjectRequest</span> <span class="variable">request</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PutObjectRequest</span>(OssConstant.BUCKET_NAME, fileName, input, meta);</span><br><span class="line">        <span class="comment">//ä¸Šä¼ æ–‡ä»¶</span></span><br><span class="line">        ossClient.putObject(request);</span><br><span class="line">        <span class="comment">// è¿”å›æ–‡ä»¶åœ°å€</span></span><br><span class="line">        <span class="keyword">return</span> getOssUrl(fileName);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ®æ–‡ä»¶åç”Ÿæˆæ–‡ä»¶çš„è®¿é—®åœ°å€</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> fileName æ–‡ä»¶å</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> æ–‡ä»¶æ‰€åœ¨ä½ç½®</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String <span class="title function_">getOssUrl</span><span class="params">(String fileName)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;https://&quot;</span> + OssConstant.BUCKET_NAME + <span class="string">&quot;.&quot;</span> + OssConstant.END_POINT + <span class="string">&quot;/&quot;</span> + fileName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ® url è·å– fileName</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> fileUrl æ–‡ä»¶ url</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> æ–‡ä»¶åç§°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String <span class="title function_">getFileName</span><span class="params">(String fileUrl)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">str</span> <span class="operator">=</span> <span class="string">&quot;aliyuncs.com/&quot;</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">beginIndex</span> <span class="operator">=</span> fileUrl.indexOf(str);</span><br><span class="line">        <span class="keyword">if</span> (beginIndex == -<span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> fileUrl.substring(beginIndex + str.length());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> fileUrls æ–‡ä»¶ url</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> &#123;<span class="doctag">@literal</span> List&lt;String&gt;&#125;  fileName é›†åˆ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;String&gt; <span class="title function_">getFileName</span><span class="params">(List&lt;String&gt; fileUrls)</span> &#123;</span><br><span class="line">        List&lt;String&gt; names = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (String url : fileUrls) &#123;</span><br><span class="line">            names.add(getFileName(url));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> names;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> fileType æ–‡ä»¶ç±»å‹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> æ–‡ä»¶çš„ contentType</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String <span class="title function_">contentType</span><span class="params">(String fileType)</span> &#123;</span><br><span class="line">        fileType = fileType.toLowerCase();</span><br><span class="line">        String contentType;</span><br><span class="line">        <span class="keyword">switch</span> (fileType) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;bmp&quot;</span>:</span><br><span class="line">                contentType = <span class="string">&quot;image/bmp&quot;</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;gif&quot;</span>:</span><br><span class="line">                contentType = <span class="string">&quot;image/gif&quot;</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;png&quot;</span>:</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;jpeg&quot;</span>:</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;jpg&quot;</span>:</span><br><span class="line">                contentType = <span class="string">&quot;image/jpeg&quot;</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;html&quot;</span>:</span><br><span class="line">                contentType = <span class="string">&quot;text/html&quot;</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;txt&quot;</span>:</span><br><span class="line">                contentType = <span class="string">&quot;text/plain&quot;</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;vsd&quot;</span>:</span><br><span class="line">                contentType = <span class="string">&quot;application/vnd.visio&quot;</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;pdf&quot;</span>:</span><br><span class="line">                contentType = <span class="string">&quot;application/pdf&quot;</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;ppt&quot;</span>:</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;pptx&quot;</span>:</span><br><span class="line">                contentType = <span class="string">&quot;application/vnd.ms-powerpoint&quot;</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;doc&quot;</span>:</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;docx&quot;</span>:</span><br><span class="line">                contentType = <span class="string">&quot;application/msword&quot;</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;xml&quot;</span>:</span><br><span class="line">                contentType = <span class="string">&quot;text/xml&quot;</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;mp4&quot;</span>:</span><br><span class="line">                contentType = <span class="string">&quot;video/mp4&quot;</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                contentType = <span class="string">&quot;application/octet-stream&quot;</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> contentType;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¦‚æœéœ€è¦ä½¿ç”¨ï¼Œæ¥æ”¶å‰ç«¯ä¼ é€’çš„ <code>MultipartFile</code> å³å¯ã€‚æ¯”å¦‚ï¼Œåœ¨ä¸Šä¼  PDFï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PostMapping(&quot;upload/pdf&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Result&lt;String&gt; <span class="title function_">uploadPdf</span><span class="params">(<span class="meta">@RequestParam(&quot;file&quot;)</span> MultipartFile file)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> ossService.uploadPdf(file);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="4-åç«¯-logback"><a class="header-anchor" href="#4-åç«¯-logback"></a>4.åç«¯ - logback</h1>
<p>åœ¨é¡¹ç›®ä¸­ï¼Œæœ‰æ—¶éœ€è¦æ‰“å°æ—¥å¿—ä¿¡æ¯å¹¶ä¿å­˜åˆ°æ—¥å¿—æ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ logback æ¥å®ç°è¿™ä¸ªåŠŸèƒ½ã€‚</p>
<p>ä¸ºäº†åœ¨ä¸åŒç¯å¢ƒä¸‹æ‰“å°ä¸åŒçš„æ—¥å¿—ä¿¡æ¯ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨å¤šç¯å¢ƒé…ç½®æ–‡ä»¶ã€‚</p>
<p>æ·»åŠ é…ç½®æ–‡ä»¶ï¼š<code>application-dev.yml</code>ï¼Œè¿™ä¸ªé…ç½®æ–‡ä»¶åœ¨å¼€å‘ç¯å¢ƒä¸‹ä½¿ç”¨ï¼Œå°†ç°é˜¶æ®µæ‰€æœ‰é…ç½®ä¿¡æ¯éƒ½ç§»åˆ°è¿™ä¸ªé…ç½®æ–‡ä»¶ä¸­ã€‚ä¿®æ”¹ <code>application.yml</code> ä¸ºï¼š</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">profiles:</span></span><br><span class="line">    <span class="comment"># å¯ç”¨ dev é…ç½®æ–‡ä»¶</span></span><br><span class="line">    <span class="attr">active:</span> <span class="string">dev</span></span><br></pre></td></tr></table></figure>
<p>ç„¶ååœ¨é¡¹ç›®çš„ <mark>resources</mark> ç›®å½•ä¸‹åˆ›å»º logback-spring.xml æ–‡ä»¶ï¼ˆåç§°ä¸èƒ½å˜ï¼Œå¿…é¡»æ˜¯è¿™ä¸ªï¼Œä¸”ä»…åœ¨ Spring ç¯å¢ƒä¸‹ç”Ÿæ•ˆï¼‰ï¼Œå¹¶æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>  <span class="attr">scan</span>=<span class="string">&quot;true&quot;</span> <span class="attr">scanPeriod</span>=<span class="string">&quot;10 seconds&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- æ—¥å¿—çº§åˆ«ä»ä½åˆ°é«˜åˆ†ä¸ºTRACE &lt; DEBUG &lt; INFO &lt; WARN &lt; ERROR &lt; FATALï¼Œå¦‚æœè®¾ç½®ä¸ºWARNï¼Œåˆ™ä½äºWARNçš„ä¿¡æ¯éƒ½ä¸ä¼šè¾“å‡º --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- scan:å½“æ­¤å±æ€§è®¾ç½®ä¸ºtrueæ—¶ï¼Œé…ç½®æ–‡ä»¶å¦‚æœå‘ç”Ÿæ”¹å˜ï¼Œå°†ä¼šè¢«é‡æ–°åŠ è½½ï¼Œé»˜è®¤å€¼ä¸ºtrue --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- scanPeriod:è®¾ç½®ç›‘æµ‹é…ç½®æ–‡ä»¶æ˜¯å¦æœ‰ä¿®æ”¹çš„æ—¶é—´é—´éš”ï¼Œå¦‚æœæ²¡æœ‰ç»™å‡ºæ—¶é—´å•ä½ï¼Œé»˜è®¤å•ä½æ˜¯æ¯«ç§’ã€‚å½“scanä¸ºtrueæ—¶ï¼Œæ­¤å±æ€§ç”Ÿæ•ˆã€‚é»˜è®¤çš„æ—¶é—´é—´éš”ä¸º1åˆ†é’Ÿã€‚ --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- de<span class="doctag">bug:</span>å½“æ­¤å±æ€§è®¾ç½®ä¸ºtrueæ—¶ï¼Œå°†æ‰“å°å‡ºlogbackå†…éƒ¨æ—¥å¿—ä¿¡æ¯ï¼Œå®æ—¶æŸ¥çœ‹logbackè¿è¡ŒçŠ¶æ€ã€‚é»˜è®¤å€¼ä¸ºfalseã€‚ --&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">contextName</span>&gt;</span>logback<span class="tag">&lt;/<span class="name">contextName</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- nameçš„å€¼æ˜¯å˜é‡çš„åç§°ï¼Œvalueçš„å€¼æ—¶å˜é‡å®šä¹‰çš„å€¼ã€‚é€šè¿‡å®šä¹‰çš„å€¼ä¼šè¢«æ’å…¥åˆ°loggerä¸Šä¸‹æ–‡ä¸­ã€‚å®šä¹‰å˜é‡åï¼Œå¯ä»¥ä½¿â€œ$&#123;&#125;â€æ¥ä½¿ç”¨å˜é‡ã€‚ --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--æ—¥å¿—æ–‡ä»¶å­˜æ”¾ä½ç½®ï¼Œé¡¹ç›®åŒçº§ç›®å½•çš„logsç›®å½•ä¸‹å­˜æ”¾æ—¥å¿—æ–‡ä»¶--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;log.path&quot;</span> <span class="attr">value</span>=<span class="string">&quot;../logs&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- å½©è‰²æ—¥å¿— --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- é…ç½®æ ¼å¼å˜é‡ï¼šCONSOLE_LOG_PATTERN å½©è‰²æ—¥å¿—æ ¼å¼ --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- magenta:æ´‹çº¢ --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- boldMagenta:ç²—çº¢--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- cyan:é’è‰² --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- white:ç™½è‰² --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- magenta:æ´‹çº¢ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;CONSOLE_LOG_PATTERN&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">value</span>=<span class="string">&quot;%yellow(%date&#123;yyyy-MM-dd HH:mm:ss&#125;) |%highlight(%-5level) |%blue(%thread) |%blue(%file:%line) |%green(%logger) |%cyan(%msg%n)&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--è¾“å‡ºåˆ°æ§åˆ¶å°--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">&quot;CONSOLE&quot;</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.ConsoleAppender&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--æ­¤æ—¥å¿—appenderæ˜¯ä¸ºå¼€å‘ä½¿ç”¨ï¼Œåªé…ç½®æœ€åº•çº§åˆ«ï¼Œæ§åˆ¶å°è¾“å‡ºçš„æ—¥å¿—çº§åˆ«æ˜¯å¤§äºæˆ–ç­‰äºæ­¤çº§åˆ«çš„æ—¥å¿—ä¿¡æ¯--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- ä¾‹å¦‚ï¼šå¦‚æœæ­¤å¤„é…ç½®äº†INFOçº§åˆ«ï¼Œåˆ™åé¢å…¶ä»–ä½ç½®å³ä½¿é…ç½®äº†DEBUGçº§åˆ«çš„æ—¥å¿—ï¼Œä¹Ÿä¸ä¼šè¢«è¾“å‡º --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.classic.filter.ThresholdFilter&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">level</span>&gt;</span>INFO<span class="tag">&lt;/<span class="name">level</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">encoder</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">Pattern</span>&gt;</span>$&#123;CONSOLE_LOG_PATTERN&#125;<span class="tag">&lt;/<span class="name">Pattern</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- è®¾ç½®å­—ç¬¦é›† --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">charset</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">charset</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">encoder</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--è¾“å‡ºåˆ°æ–‡ä»¶--&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- æ—¶é—´æ»šåŠ¨è¾“å‡º levelä¸º INFO æ—¥å¿— --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">&quot;INFO_FILE&quot;</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- æ­£åœ¨è®°å½•çš„æ—¥å¿—æ–‡ä»¶çš„è·¯å¾„åŠæ–‡ä»¶å --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">file</span>&gt;</span>$&#123;log.path&#125;/log_info.log<span class="tag">&lt;/<span class="name">file</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--æ—¥å¿—æ–‡ä»¶è¾“å‡ºæ ¼å¼--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">encoder</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">pattern</span>&gt;</span>%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125; [%thread] %-5level %logger&#123;50&#125; - %msg%n<span class="tag">&lt;/<span class="name">pattern</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">charset</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">charset</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">encoder</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- æ—¥å¿—è®°å½•å™¨çš„æ»šåŠ¨ç­–ç•¥ï¼ŒæŒ‰æ—¥æœŸï¼ŒæŒ‰å¤§å°è®°å½• --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">rollingPolicy</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- æ¯å¤©æ—¥å¿—å½’æ¡£è·¯å¾„ä»¥åŠæ ¼å¼ --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">fileNamePattern</span>&gt;</span>$&#123;log.path&#125;/info/log-info-%d&#123;yyyy-MM-dd&#125;.%i.log<span class="tag">&lt;/<span class="name">fileNamePattern</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">timeBasedFileNamingAndTriggeringPolicy</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">maxFileSize</span>&gt;</span>100MB<span class="tag">&lt;/<span class="name">maxFileSize</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">timeBasedFileNamingAndTriggeringPolicy</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--æ—¥å¿—æ–‡ä»¶ä¿ç•™å¤©æ•°--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">maxHistory</span>&gt;</span>15<span class="tag">&lt;/<span class="name">maxHistory</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">rollingPolicy</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- æ­¤æ—¥å¿—æ–‡ä»¶åªè®°å½•infoçº§åˆ«çš„ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.classic.filter.LevelFilter&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">level</span>&gt;</span>INFO<span class="tag">&lt;/<span class="name">level</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">onMatch</span>&gt;</span>ACCEPT<span class="tag">&lt;/<span class="name">onMatch</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">onMismatch</span>&gt;</span>DENY<span class="tag">&lt;/<span class="name">onMismatch</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- æ—¶é—´æ»šåŠ¨è¾“å‡º levelä¸º WARN æ—¥å¿— --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">&quot;WARN_FILE&quot;</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- æ­£åœ¨è®°å½•çš„æ—¥å¿—æ–‡ä»¶çš„è·¯å¾„åŠæ–‡ä»¶å --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">file</span>&gt;</span>$&#123;log.path&#125;/log_warn.log<span class="tag">&lt;/<span class="name">file</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--æ—¥å¿—æ–‡ä»¶è¾“å‡ºæ ¼å¼--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">encoder</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">pattern</span>&gt;</span>%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125; [%thread] %-5level %logger&#123;50&#125; - %msg%n<span class="tag">&lt;/<span class="name">pattern</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">charset</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">charset</span>&gt;</span> <span class="comment">&lt;!-- æ­¤å¤„è®¾ç½®å­—ç¬¦é›† --&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">encoder</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- æ—¥å¿—è®°å½•å™¨çš„æ»šåŠ¨ç­–ç•¥ï¼ŒæŒ‰æ—¥æœŸï¼ŒæŒ‰å¤§å°è®°å½• --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">rollingPolicy</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">fileNamePattern</span>&gt;</span>$&#123;log.path&#125;/warn/log-warn-%d&#123;yyyy-MM-dd&#125;.%i.log<span class="tag">&lt;/<span class="name">fileNamePattern</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">timeBasedFileNamingAndTriggeringPolicy</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">maxFileSize</span>&gt;</span>100MB<span class="tag">&lt;/<span class="name">maxFileSize</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">timeBasedFileNamingAndTriggeringPolicy</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--æ—¥å¿—æ–‡ä»¶ä¿ç•™å¤©æ•°--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">maxHistory</span>&gt;</span>15<span class="tag">&lt;/<span class="name">maxHistory</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">rollingPolicy</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- æ­¤æ—¥å¿—æ–‡ä»¶åªè®°å½•warnçº§åˆ«çš„ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.classic.filter.LevelFilter&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">level</span>&gt;</span>warn<span class="tag">&lt;/<span class="name">level</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">onMatch</span>&gt;</span>ACCEPT<span class="tag">&lt;/<span class="name">onMatch</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">onMismatch</span>&gt;</span>DENY<span class="tag">&lt;/<span class="name">onMismatch</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- æ—¶é—´æ»šåŠ¨è¾“å‡º levelä¸º ERROR æ—¥å¿— --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">&quot;ERROR_FILE&quot;</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- æ­£åœ¨è®°å½•çš„æ—¥å¿—æ–‡ä»¶çš„è·¯å¾„åŠæ–‡ä»¶å --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">file</span>&gt;</span>$&#123;log.path&#125;/log_error.log<span class="tag">&lt;/<span class="name">file</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--æ—¥å¿—æ–‡ä»¶è¾“å‡ºæ ¼å¼--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">encoder</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">pattern</span>&gt;</span>%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125; [%thread] %-5level %logger&#123;50&#125; - %msg%n<span class="tag">&lt;/<span class="name">pattern</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">charset</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">charset</span>&gt;</span> <span class="comment">&lt;!-- æ­¤å¤„è®¾ç½®å­—ç¬¦é›† --&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">encoder</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- æ—¥å¿—è®°å½•å™¨çš„æ»šåŠ¨ç­–ç•¥ï¼ŒæŒ‰æ—¥æœŸï¼ŒæŒ‰å¤§å°è®°å½• --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">rollingPolicy</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">fileNamePattern</span>&gt;</span>$&#123;log.path&#125;/error/log-error-%d&#123;yyyy-MM-dd&#125;.%i.log<span class="tag">&lt;/<span class="name">fileNamePattern</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">timeBasedFileNamingAndTriggeringPolicy</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">maxFileSize</span>&gt;</span>100MB<span class="tag">&lt;/<span class="name">maxFileSize</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">timeBasedFileNamingAndTriggeringPolicy</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--æ—¥å¿—æ–‡ä»¶ä¿ç•™å¤©æ•°--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">maxHistory</span>&gt;</span>15<span class="tag">&lt;/<span class="name">maxHistory</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">rollingPolicy</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- æ­¤æ—¥å¿—æ–‡ä»¶åªè®°å½•ERRORçº§åˆ«çš„ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.classic.filter.LevelFilter&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">level</span>&gt;</span>ERROR<span class="tag">&lt;/<span class="name">level</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">onMatch</span>&gt;</span>ACCEPT<span class="tag">&lt;/<span class="name">onMatch</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">onMismatch</span>&gt;</span>DENY<span class="tag">&lt;/<span class="name">onMismatch</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">        &lt;logger&gt;ç”¨æ¥è®¾ç½®æŸä¸€ä¸ªåŒ…æˆ–è€…å…·ä½“çš„æŸä¸€ä¸ªç±»çš„æ—¥å¿—æ‰“å°çº§åˆ«ã€ä»¥åŠæŒ‡å®š&lt;appender&gt;ã€‚</span></span><br><span class="line"><span class="comment">        å®ƒå°†ä¼šè¦†ç›–rootçš„è¾“å‡ºçº§åˆ«ã€‚</span></span><br><span class="line"><span class="comment">        &lt;logger&gt;ä»…æœ‰ä¸€ä¸ªnameå±æ€§ï¼Œ</span></span><br><span class="line"><span class="comment">        ä¸€ä¸ªå¯é€‰çš„levelå’Œä¸€ä¸ªå¯é€‰çš„addtivityå±æ€§ã€‚</span></span><br><span class="line"><span class="comment">        name:ç”¨æ¥æŒ‡å®šå—æ­¤loggerçº¦æŸçš„æŸä¸€ä¸ªåŒ…æˆ–è€…å…·ä½“çš„æŸä¸€ä¸ªç±»ã€‚</span></span><br><span class="line"><span class="comment">        level:ç”¨æ¥è®¾ç½®æ‰“å°çº§åˆ«ï¼Œå¤§å°å†™æ— å…³ï¼šTRACE, DEBUG, INFO, WARN, ERROR, ALL å’Œ OFFï¼Œ</span></span><br><span class="line"><span class="comment">              å¦‚æœæœªè®¾ç½®æ­¤å±æ€§ï¼Œé‚£ä¹ˆå½“å‰loggerå°†ä¼šç»§æ‰¿ä¸Šçº§çš„çº§åˆ«ã€‚</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">        ä½¿ç”¨mybatisçš„æ—¶å€™ï¼Œsqlè¯­å¥æ˜¯debugä¸‹æ‰ä¼šæ‰“å°ï¼Œè€Œè¿™é‡Œæˆ‘ä»¬åªé…ç½®äº†infoï¼Œæ‰€ä»¥æƒ³è¦æŸ¥çœ‹sqlè¯­å¥çš„è¯ï¼Œæœ‰ä»¥ä¸‹ä¸¤ç§æ“ä½œï¼š</span></span><br><span class="line"><span class="comment">        ç¬¬ä¸€ç§æŠŠ&lt;root level=&quot;INFO&quot;&gt;æ”¹æˆ&lt;root level=&quot;DEBUG&quot;&gt;è¿™æ ·å°±ä¼šæ‰“å°sqlï¼Œä¸è¿‡è¿™æ ·æ—¥å¿—é‚£è¾¹ä¼šå‡ºç°å¾ˆå¤šå…¶ä»–æ¶ˆæ¯</span></span><br><span class="line"><span class="comment">        ç¬¬äºŒç§å°±æ˜¯å•ç‹¬ç»™mapperä¸‹ç›®å½•é…ç½®DEBUGæ¨¡å¼ï¼Œä»£ç å¦‚ä¸‹ï¼Œè¿™æ ·é…ç½®sqlè¯­å¥ä¼šæ‰“å°ï¼Œå…¶ä»–è¿˜æ˜¯æ­£å¸¸DEBUGçº§åˆ«ï¼š</span></span><br><span class="line"><span class="comment">     --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--å¼€å‘ç¯å¢ƒ:æ‰“å°æ§åˆ¶å°--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">springProfile</span> <span class="attr">name</span>=<span class="string">&quot;dev&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--å¯ä»¥è¾“å‡ºé¡¹ç›®ä¸­çš„debugæ—¥å¿—ï¼ŒåŒ…æ‹¬mybatisçš„sqlæ—¥å¿—--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--æŒ‡å®š indi.mofan åŒ…ä¸‹çš„æ—¥å¿—è¾“å‡ºçº§åˆ«ä¸º info--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">logger</span> <span class="attr">name</span>=<span class="string">&quot;indi.mofan&quot;</span> <span class="attr">level</span>=<span class="string">&quot;INFO&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">            rootèŠ‚ç‚¹æ˜¯å¿…é€‰èŠ‚ç‚¹ï¼Œç”¨æ¥æŒ‡å®šæœ€åŸºç¡€çš„æ—¥å¿—è¾“å‡ºçº§åˆ«ï¼Œåªæœ‰ä¸€ä¸ªlevelå±æ€§</span></span><br><span class="line"><span class="comment">            level:ç”¨æ¥è®¾ç½®æ‰“å°çº§åˆ«ï¼Œå¤§å°å†™æ— å…³ï¼šTRACE, DEBUG, INFO, WARN, ERROR, ALL å’Œ OFFï¼Œé»˜è®¤æ˜¯DEBUG</span></span><br><span class="line"><span class="comment">            å¯ä»¥åŒ…å«é›¶ä¸ªæˆ–å¤šä¸ªappenderå…ƒç´ ã€‚</span></span><br><span class="line"><span class="comment">        --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">root</span> <span class="attr">level</span>=<span class="string">&quot;INFO&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;CONSOLE&quot;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;INFO_FILE&quot;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;WARN_FILE&quot;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;ERROR_FILE&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">springProfile</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--ç”Ÿäº§ç¯å¢ƒ:è¾“å‡ºåˆ°æ–‡ä»¶--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--    &lt;springProfile name=&quot;pro&quot;&gt;--&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--        &amp;lt;!&amp;ndash;å¯ä»¥è¾“å‡ºé¡¹ç›®ä¸­çš„debugæ—¥å¿—ï¼ŒåŒ…æ‹¬mybatisçš„sqlæ—¥å¿—&amp;ndash;&amp;gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        &lt;logger name=&quot;indi.mofan&quot; level=&quot;WARN&quot; /&gt;--&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--        &lt;root level=&quot;INFO&quot;&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--            &lt;appender-ref ref=&quot;ERROR_FILE&quot; /&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--            &lt;appender-ref ref=&quot;WARN_FILE&quot; /&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        &lt;/root&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--    &lt;/springProfile&gt;--&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>å¦‚æœéœ€è¦ä½¿ç”¨ä¸Šè¿°æ—¥å¿—é…ç½®ï¼Œéœ€è¦ä¿®æ”¹çš„åœ°æ–¹æœ‰ï¼š</p>
<p>1ã€æ—¥å¿—çš„å­˜æ”¾åœ°å€ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;log.path&quot;</span> <span class="attr">value</span>=<span class="string">&quot;../logs&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<p>2ã€æŒ‡å®šè‡ªå·±é¡¹ç›®çš„åŒ…è·¯å¾„ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">logger</span> <span class="attr">name</span>=<span class="string">&quot;indi.mofan&quot;</span> <span class="attr">level</span>=<span class="string">&quot;INFO&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<p>å®Œæˆä»¥ä¸Šæ­¥éª¤åï¼Œæˆ‘ä»¬å°±å¯ä»¥æ„‰å¿«åœ°ä½¿ç”¨ Lombok æä¾›çš„ <code>@Slf4j</code> æ³¨è§£è¾“å‡ºæ—¥å¿—äº†ã€‚ ğŸ‰</p>
<h1 id="5-åç«¯-åˆ‡é¢"><a class="header-anchor" href="#5-åç«¯-åˆ‡é¢"></a>5. åç«¯ - åˆ‡é¢</h1>
<p>æ—¥å¿—é™¤äº†è¾“å‡ºåˆ°æ—¥å¿—æ–‡ä»¶ä¸­ä¹‹å¤–ï¼Œä¹Ÿå¯ä»¥ä¿å­˜åˆ°æ•°æ®åº“ã€‚</p>
<p>é’ˆå¯¹å°†æ—¥å¿—ä¿å­˜åˆ°æ•°æ®åº“è¿™ä¸ªéœ€æ±‚ï¼Œå¯ä»¥ä½¿ç”¨ <strong>åˆ‡é¢</strong> æ¥è§£å†³ã€‚</p>
<p>å¯¼å…¥ä¾èµ–ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--    åˆ‡é¢ æ—¥å¿—ä½¿ç”¨    --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.aspectj<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>aspectjweaver<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.9.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>ç¼–å†™æ—¥å¿—åˆ‡é¢æœåŠ¡ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LogAspect</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> LogService logService;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> CurrentUser currentUser;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é…ç½®åˆ‡å…¥ç‚¹</span></span><br><span class="line"><span class="comment">     * ..è¡¨ç¤ºåŒ…åŠå­åŒ… è¯¥æ–¹æ³•ä»£è¡¨ controller å±‚çš„æ‰€æœ‰æ–¹æ³•</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Pointcut(&quot;execution(public * indi.mofan.controller..*.*(..))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">controllerMethod</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ–¹æ³•æ‰§è¡Œå</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> object æ–¹æ³•è¿”å›ç»“æœé›†</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@SuppressWarnings(&quot;unchecked&quot;)</span></span><br><span class="line">    <span class="meta">@AfterReturning(returning = &quot;object&quot;, pointcut = &quot;controllerMethod()&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">logResultInfo</span><span class="params">(Object object)</span> &#123;</span><br><span class="line">        Result&lt;Object&gt; result = (Result&lt;Object&gt;) object;</span><br><span class="line">        <span class="keyword">if</span> (result.isLog() &amp;&amp; Result.SUCCESS_CODE.equals(result.getCode())) &#123;</span><br><span class="line">            <span class="type">UserInfo</span> <span class="variable">currentUser</span> <span class="operator">=</span> <span class="built_in">this</span>.currentUser.getCurrentUser();</span><br><span class="line">            <span class="type">LogInfoDefinitionDto</span> <span class="variable">dto</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">LogInfoDefinitionDto</span>();</span><br><span class="line">            dto.setUserAccount(currentUser.getUserAccount());</span><br><span class="line">            dto.setUserType(currentUser.getUserType().code());</span><br><span class="line">            dto.setAction(result.getMsg());</span><br><span class="line">            logService.createOneLog(dto);</span><br><span class="line">            log.info(<span class="string">&quot;ç”¨æˆ·ç±»å‹ï¼š&#123;&#125; - æ‰§è¡Œè´¦å·ï¼š&#123;&#125; - æ‰€åšæ“ä½œï¼š&#123;&#125;&quot;</span>, dto.getUserType(), dto.getUserAccount(), dto.getAction());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é€šè¿‡ä¸Šè¿°ä»£ç å¯ä»¥çœ‹åˆ°ï¼Œåœ¨æ–¹æ³•æ‰§è¡Œåæ‰æ‰§è¡Œé…ç½®çš„åˆ‡é¢ï¼Œç”±äºç»Ÿä¸€äº†è¿”å›å€¼ï¼ˆå‚çœ‹ ã€1.3 ç»Ÿä¸€è¿”å›å€¼ã€‘ï¼‰ï¼Œé…ç½®èµ·æ¥ä¹Ÿå˜å¾—ç®€å•ã€‚</p>
<h1 id="6-åç«¯-é…ç½®æ–‡ä»¶åŠ å¯†"><a class="header-anchor" href="#6-åç«¯-é…ç½®æ–‡ä»¶åŠ å¯†"></a>6. åç«¯ - é…ç½®æ–‡ä»¶åŠ å¯†</h1>
<p>åœ¨åç«¯çš„é…ç½®æ–‡ä»¶ä¸­å¾€å¾€æœ‰å¾ˆå¤šæ•æ„Ÿä¿¡æ¯ï¼Œæ¯”å¦‚å„ç§æ•°æ®åº“å¯†ç ã€å„ç§å¯†é’¥ç­‰ï¼Œå¦‚æœå°†è¿™äº›ä¿¡æ¯è¿›è¡Œæ˜æ–‡æ˜¾ç¤ºï¼Œå°±æœ‰å¯èƒ½è®©ä¸æ³•åˆ†å­æœ‰å¯ä¹˜ä¹‹æœºã€‚</p>
<p>å› æ­¤ï¼Œæœ€å¥½èƒ½å¯¹è¿™äº›ä¿¡æ¯è¿›è¡ŒåŠ å¯†ã€‚</p>
<p>å¯¼å…¥ä¾èµ–ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.github.ulisesbocchio<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jasypt-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.0.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>é…ç½®æ–‡ä»¶ä¸­å¢åŠ é…ç½®ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">jasypt:</span></span><br><span class="line">  <span class="attr">encryptor:</span></span><br><span class="line">      <span class="comment"># privateKey</span></span><br><span class="line">    <span class="attr">password:</span> <span class="number">12345</span></span><br></pre></td></tr></table></figure>
<p>ç„¶åç¼–å†™ä¸€ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> mofan</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2021/4/23 15:40</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JasyptEncryptorTest</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> StringEncryptor encryptor;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testEncrypt</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">final</span> <span class="type">String</span> <span class="variable">originPwd</span> <span class="operator">=</span> <span class="string">&quot;123456&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">encryptedPwd</span> <span class="operator">=</span> encryptor.encrypt(originPwd);</span><br><span class="line">        Assertions.assertEquals(originPwd, encryptor.decrypt(encryptedPwd));</span><br><span class="line">        System.out.println(<span class="string">&quot;æœªåŠ å¯†æ•°æ®ï¼š&quot;</span> + originPwd);</span><br><span class="line">        System.out.println(<span class="string">&quot;åŠ å¯†åçš„æ•°æ®ï¼š&quot;</span> + encryptedPwd);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿è¡Œåï¼Œæµ‹è¯•é€šè¿‡ï¼Œæ§åˆ¶å°æ‰“å°å‡ºï¼š</p>
<pre>
æœªåŠ å¯†æ•°æ®ï¼š123456
åŠ å¯†åçš„æ•°æ®ï¼šecqo2ZfOXI3OMMYqNHTePr/uyZHhCyKNFUU4xXjXkoUPpcNDeuZAdX7jhYIQQYWd
</pre>
<p>ä¸Šè¿°ä»£ç æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿ</p>
<p>å°±æ˜¯ä½¿ç”¨å¯†é’¥ 12345ï¼ˆprivateKeyï¼‰å¯¹åŸå§‹å¯†ç  123456ï¼ˆoriginPwdï¼‰è¿›è¡ŒåŠ å¯†ï¼Œæœ€ç»ˆæ‰“å°å‡ºåŠ å¯†å‰å’ŒåŠ å¯†åçš„æ•°æ®ï¼Œå› æ­¤å¯†é’¥æ˜¯ç»ä¸èƒ½æš´éœ²çš„ï¼Œ<mark>åœ¨å®é™…ä½¿ç”¨æ—¶ï¼Œä¸èƒ½ç›´æ¥å°†æ˜æ–‡å¯†é’¥å¡«å†™åœ¨é…ç½®æ–‡ä»¶ä¸­</mark>ã€‚</p>
<p>é‚£ä¹ˆé—®é¢˜åˆæ¥äº†ï¼Œæ€ä¹ˆä½¿ç”¨åŠ å¯†åçš„æ•°æ®å‘¢ï¼Ÿ</p>
<p>åªéœ€è¦å°†é…ç½®æ–‡ä»¶ä¸­éœ€è¦è¿›è¡ŒåŠ å¯†çš„æ•°æ®æ›¿æ¢åå³å¯ï¼Œä½†æ˜¯éœ€è¦åŠ ä¸Š <strong>åŠ å¯†å‰åç¼€</strong>ã€‚</p>
<p>æ¯”å¦‚ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">datasource:</span></span><br><span class="line">  <span class="attr">username:</span> <span class="string">root</span></span><br><span class="line">  <span class="attr">password:</span> <span class="string">ENC(ecqo2ZfOXI3OMMYqNHTePr/uyZHhCyKNFUU4xXjXkoUPpcNDeuZAdX7jhYIQQYWd)</span></span><br></pre></td></tr></table></figure>
<p>æ›¿æ¢å¹¶ç§»é™¤é…ç½®æ–‡ä»¶ä¸­çš„æ˜æ–‡å¯†é’¥åè‚¯å®šæ˜¯æ— æ³•å¯åŠ¨é¡¹ç›®çš„ï¼Œå› ä¸ºå¹¶æ²¡æœ‰å‘ŠçŸ¥ç¨‹åºæ‰€ä½¿ç”¨çš„å¯†é’¥ã€‚é‚£æ€ä¹ˆæï¼Ÿ</p>
<p>æ–¹å¼æœ‰ä¸‰ï¼š</p>
<p>1ã€å°†å¯†é’¥ç›´æ¥ä½œä¸ºç¨‹åºå¯åŠ¨æ—¶çš„ <strong>å‘½ä»¤è¡Œå‚æ•°</strong>ï¼š</p>
<pre>
java -jar yourprojectname.jar --jasypt.encryptor.password=12345
</pre>
<p>2ã€å°†å¯†é’¥ä½œä¸ºç¨‹åºå¯åŠ¨æ—¶çš„ <strong>åº”ç”¨ç¯å¢ƒå˜é‡</strong>ï¼š</p>
<pre>
java -Djasypt.encryptor.password=12345 -jar yourprojectname.jar
</pre>
<p>3ã€å°†å¯†é’¥é…ç½®ä¸º <strong>ç³»ç»Ÿçš„ç¯å¢ƒå˜é‡</strong>ï¼š</p>
<p>æ¯”å¦‚æˆ‘ä»¬æå‰è®¾ç½®ç³»ç»Ÿç¯å¢ƒå˜é‡ï¼šJASYPT_ENCRYPTOR_PASSWORD = 12345ï¼Œé‚£ä¹ˆåœ¨ SpringBoot çš„é…ç½®æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹é…ç½®å³å¯ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">jasypt:</span></span><br><span class="line">  <span class="attr">encryptor:</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">$&#123;JASYPT_ENCRYPTOR_PASSWORD:&#125;</span></span><br></pre></td></tr></table></figure>
<p>å¦‚æœä½¿ç”¨ IDEA ä½œä¸ºåç«¯å¼€å‘å·¥å…·ï¼Œåªéœ€è¦åœ¨è™šæ‹Ÿæœºå¯åŠ¨å‚æ•°è¿½åŠ ä»¥ä¸‹å†…å®¹å³å¯ï¼š</p>
<pre>
-Djasypt.encryptor.password=12345
</pre>
<p>å¦‚ï¼š</p>
<p><img src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/loading.gif" data-lazy-src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/SummaryImages/%E6%B7%BB%E5%8A%A0%E5%AF%86%E9%92%A5%E5%88%B0%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%90%AF%E5%8A%A8%E5%8F%82%E6%95%B0.png" alt="æ·»åŠ å¯†é’¥åˆ°è™šæ‹Ÿæœºå¯åŠ¨å‚æ•°"></p>
<h2 id="6-1-è‡ªå®šä¹‰åŠ å¯†å‰åç¼€"><a class="header-anchor" href="#6-1-è‡ªå®šä¹‰åŠ å¯†å‰åç¼€"></a>6.1 è‡ªå®šä¹‰åŠ å¯†å‰åç¼€</h2>
<p>jasypt é»˜è®¤çš„åŠ å¯†å‰åç¼€æ˜¯ <code>ENC()</code>ï¼Œé‚£ä¹ˆæœ‰æ²¡æœ‰ä»€ä¹ˆåŠæ³•å¯ä»¥è‡ªå®šä¹‰å‘¢ï¼Ÿæ¯”å¦‚æ”¹æˆ <code>MOFAN()</code>ã€‚</p>
<p>åªéœ€è¦åœ¨é…ç½®æ–‡ä»¶è¿½åŠ ä»¥ä¸‹å†…å®¹å³å¯ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">jasypt:</span></span><br><span class="line">  <span class="attr">encryptor:</span></span><br><span class="line">    <span class="attr">property:</span></span><br><span class="line">      <span class="attr">prefix:</span> <span class="string">MOFAN(</span></span><br><span class="line">      <span class="attr">suffix:</span> <span class="string">)</span></span><br></pre></td></tr></table></figure>
<h2 id="6-2-æ›´å¤šè‡ªå®šä¹‰"><a class="header-anchor" href="#6-2-æ›´å¤šè‡ªå®šä¹‰"></a>6.2 æ›´å¤šè‡ªå®šä¹‰</h2>
<p>é»˜è®¤æƒ…å†µä¸‹ jasypt é‡‡ç”¨çš„åŠ å¯†ç®—æ³•ä¸º <code>PBEWITHHMACSHA512ANDAES_256</code>ï¼Œè¿™äº›é»˜è®¤ä¿¡æ¯éƒ½åœ¨ <code>JasyptEncryptorConfigurationProperties </code> ç±»ä¸­ï¼Œæˆ‘ä»¬å‰å¾€è¿™ä¸ªç±»æŸ¥çœ‹ï¼š</p>
<img src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/loading.gif" data-lazy-src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/SummaryImages/JasyptEncryptorConfigurationProperties.png" alt="JasyptEncryptorConfigurationProperties" style="zoom:33%;" />
<p>å› æ­¤ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦è‡ªå®šä¹‰æ›´å¤šçš„å†…å®¹ï¼Œåªéœ€è¦åœ¨é…ç½®æ–‡ä»¶ä¸­è¿›è¡Œä¿®æ”¹å³å¯ã€‚</p>
<h1 id="7-åç«¯-å·¥å…·ç±»"><a class="header-anchor" href="#7-åç«¯-å·¥å…·ç±»"></a>7. åç«¯ - å·¥å…·ç±»</h1>
<h2 id="7-1-Hutool"><a class="header-anchor" href="#7-1-Hutool"></a>7.1 Hutool</h2>
<p>åœ¨è¯´å·¥å…·ç±»ä¹‹å‰ï¼Œå°±ä¸å¾—ä¸ä»‹ç»ä¸€ä¸ªéå¸¸å¥½ç”¨çš„ Java å·¥å…·åŒ…ç±»åº“ â€”â€” Hutoolï¼Œè¿™ä¸ªç±»åº“æ˜¯ç”±å›½äººå¼€å‘çš„ï¼Œå› æ­¤å‚è€ƒæ–‡æ¡£å’Œ API æ–‡æ¡£éƒ½æ˜¯ä¸­æ–‡çš„ï¼Œååˆ†å‹å¥½ã€‚</p>
<p>ä½ å°±åœ¨æ­¤åœ°ä¸è¦èµ°åŠ¨ï¼Œæˆ‘æŠŠå‚è€ƒæ–‡æ¡£<sup class="footnote-ref"><a href="#fn2" id="fnref2">[2]</a></sup>å’Œ API æ–‡æ¡£<sup class="footnote-ref"><a href="#fn3" id="fnref3">[3]</a></sup>çš„é“¾æ¥éƒ½æ”¾åœ¨è¿™é‡Œã€‚</p>
<p>ä½¿ç”¨ Hutool ä¹Ÿå¾ˆç®€å•ï¼Œåªéœ€è¦å¯¼å…¥ä¾èµ–å°±å¯ä»¥äº†ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>cn.hutool<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hutool-all<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>Latest Version<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>Hutool æ˜¯å¤šæ¨¡å—å¼€å‘çš„ï¼Œå½“ç„¶é™¤äº†ä¸Šè¿°è¿™ç§æ–¹å¼å¤–ï¼Œä¹Ÿå¯ä»¥æŒ‰éœ€å¯¼å…¥è‡ªå·±éœ€è¦çš„æ¨¡å—ã€‚</p>
<p>è‡³äº Hutool çš„ä½¿ç”¨æ–¹å¼å°±æŸ¥é˜…å‚è€ƒæ–‡æ¡£å’Œ API æ–‡æ¡£å§ï¼Œååˆ†è¯¦ç»†ã€‚</p>
<h2 id="7-2-ä½¿ç”¨çš„å·¥å…·ç±»"><a class="header-anchor" href="#7-2-ä½¿ç”¨çš„å·¥å…·ç±»"></a>7.2 ä½¿ç”¨çš„å·¥å…·ç±»</h2>
<blockquote>
<p>ObjectUtil</p>
</blockquote>
<p>ObjectUtilï¼šå¯¹è±¡åˆ¤ç©ºã€Map éç©ºè¿‡æ»¤ã€Map key å€¼è½¬æ¢ã€Map value æ•´åˆã€‚</p>
<p>ä¸è¦åæ§½è¿™ä¸ªå‘½åï¼Œæˆ‘è‡ªå·±éƒ½æƒ³åæ§½ï¼Œæˆ–è®¸å« MapUtil æˆ–è€… CollectionUtil ä¼šå¥½ç‚¹ï¼ŸğŸ¤”</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> mofan</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2021/3/12 11:04</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ObjectUtil</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ£€æŸ¥å¯¹è±¡éç©º, æ£€æŸ¥å­—ç¬¦ä¸²æ˜¯å¦ä¸ºéç©ºå­—ç¬¦ä¸²</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> object è¢«æ£€æµ‹çš„å¯¹è±¡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> Boolean</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">checkValue</span><span class="params">(Object object)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (object <span class="keyword">instanceof</span> String &amp;&amp; <span class="string">&quot;&quot;</span>.equals((((String) object).trim()))) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span> != object;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¿‡æ»¤ Map ä¸­ Value ä¸º null æˆ–ç©ºå­—ç¬¦ä¸²çš„æ•°æ®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> data Map é›†åˆ</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> è¿‡æ»¤å¾—åˆ°çš„ Map é›†åˆ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Map&lt;String, Object&gt; <span class="title function_">filterEmptyStringValue</span><span class="params">(Map&lt;String, Object&gt; data)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> data.entrySet().stream()</span><br><span class="line">                .filter(entry -&gt; checkValue(entry.getValue()))</span><br><span class="line">                .collect(Collectors.toMap(</span><br><span class="line">                        (e) -&gt; (String) e.getKey(),</span><br><span class="line">                        Map.Entry::getValue</span><br><span class="line">                ));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å°† Map ä¸­é©¼å³°å‘½åçš„ Key è½¬æ¢ä¸ºä¸‹åˆ’çº¿å‘½å</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> data Map é›†åˆ</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> è½¬æ¢åå¾—åˆ°çš„ Map é›†åˆ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Map&lt;String, Object&gt; <span class="title function_">toUnderLineCaseKey</span><span class="params">(Map&lt;String, Object&gt; data)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> data.entrySet().stream()</span><br><span class="line">                .collect(Collectors.toMap((e) -&gt; StrUtil.toUnderlineCase(e.getKey()), Map.Entry::getValue));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å°† Map ä¸­é©¼å³°å‘½åçš„ Key è½¬æ¢ä¸ºä¸‹åˆ’çº¿å‘½åï¼Œå¹¶è¿‡æ»¤ Value</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> data Map é›†åˆ</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> è½¬æ¢åå¾—åˆ°çš„ Map é›†åˆ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Map&lt;String, Object&gt; <span class="title function_">toUnderLineCaseKeyAndFilterValue</span><span class="params">(Map&lt;String, Object&gt; data)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> toUnderLineCaseKey(filterEmptyStringValue(data));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å°† Map çš„ value å­˜å…¥ List ä¸­å¹¶è¿”å›</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> map åŸ Map é›†åˆ</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> å¾—åˆ°çš„ List é›†åˆ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;K, V&gt; List&lt;V&gt; <span class="title function_">getMapValueList</span><span class="params">(Map&lt;K, V&gt; map)</span> &#123;</span><br><span class="line">        Collection&lt;V&gt; values = map.values();</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;(values);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>NumberUtil</p>
</blockquote>
<p>NumberUtilï¼šdouble è½¬ intã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> mofan</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2021/5/27 16:52</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">NumberUtil</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * double è½¬ int</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> d double ç±»å‹çš„æ•°å€¼</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> è½¬æ¢åå¾—åˆ°çš„ int ç±»å‹æ•°å€¼</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">doubleToInt</span><span class="params">(<span class="type">double</span> d)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Integer.parseInt(<span class="keyword">new</span> <span class="title class_">DecimalFormat</span>(<span class="string">&quot;0&quot;</span>).format(d));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>FileUtil</p>
</blockquote>
<p>FileUtilï¼šåˆ¤æ–­ MultipartFile æ˜¯å¦ä¸º Excelã€åˆ¤æ–­ MultipartFile æ˜¯å¦ä¸º PDFã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> mofan</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2021/3/15 20:49</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FileUtil</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">FILE_ZIP</span> <span class="operator">=</span> <span class="string">&quot;zip&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">FILE_XLS</span> <span class="operator">=</span> <span class="string">&quot;.xls&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">FILE_XLSX</span> <span class="operator">=</span> <span class="string">&quot;.xlsx&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">FILE_PDF</span> <span class="operator">=</span> <span class="string">&quot;.pdf&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ¤æ–­ä¸Šä¼ çš„æ–‡ä»¶æ˜¯å¦æ˜¯ Excel ç±»å‹çš„</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> file MultipartFile å®ä¾‹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> åˆ¤æ–­ç»“æœ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">isNotExcelFile</span><span class="params">(MultipartFile file)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (file == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">String</span> <span class="variable">filename</span> <span class="operator">=</span> file.getOriginalFilename();</span><br><span class="line">        <span class="type">String</span> <span class="variable">fileType</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">if</span> (filename != <span class="literal">null</span>) &#123;</span><br><span class="line">            fileType = filename.substring(filename.lastIndexOf(<span class="string">&quot;.&quot;</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å…ˆåˆ¤æ–­åç¼€å</span></span><br><span class="line">        <span class="keyword">if</span> (FILE_XLS.equalsIgnoreCase(fileType) || FILE_XLSX.equalsIgnoreCase(fileType)) &#123;</span><br><span class="line">            String type;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                type = FileTypeUtil.getType(file.getInputStream());</span><br><span class="line">                <span class="comment">// æ ¹æ®é¦–éƒ¨å­—èŠ‚åˆ¤æ–­æ–‡ä»¶ç±»å‹</span></span><br><span class="line">                <span class="keyword">if</span> (FILE_ZIP.contains(type) || FILE_XLS.contains(type)) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ¤æ–­ä¸Šä¼ çš„æ–‡ä»¶æ˜¯å¦æ˜¯ PDF ç±»å‹çš„</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> file MultipartFile å®ä¾‹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> åˆ¤æ–­ç»“æœ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">isNotPdfFile</span><span class="params">(MultipartFile file)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (file == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">String</span> <span class="variable">filename</span> <span class="operator">=</span> file.getOriginalFilename();</span><br><span class="line">        <span class="type">String</span> <span class="variable">fileType</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">if</span> (filename != <span class="literal">null</span>) &#123;</span><br><span class="line">            fileType = filename.substring(filename.lastIndexOf(<span class="string">&quot;.&quot;</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å…ˆåˆ¤æ–­åç¼€å</span></span><br><span class="line">        <span class="keyword">if</span> (FILE_PDF.equalsIgnoreCase(fileType)) &#123;</span><br><span class="line">            String type;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>DateUtil</p>
</blockquote>
<p>DateUtilï¼šä» <code>yyyy-MM-dd HH:mm:ss</code> å­—ç¬¦ä¸²ä¸­è·å–ä¿¡æ¯ã€è·å–å½“å‰å¹´ä»½ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> mofan</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2021/4/30 22:16</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DateUtil</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å°† yyyy-MM-dd HH:mm:ss å­—ç¬¦ä¸²æ ¼å¼çš„æ—¶é—´è½¬æ¢ä¸º yyyy-MM-dd HH:mm å­—ç¬¦ä¸²æ ¼å¼</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> date åŸæ—¶é—´å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> yyyy-MM-dd HH:mm å­—ç¬¦ä¸²æ ¼å¼</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">getHmDateStr</span><span class="params">(String date)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (date == <span class="literal">null</span> || <span class="string">&quot;&quot;</span>.equals(date)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> date.lastIndexOf(<span class="string">&quot;:&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> date.substring(<span class="number">0</span>, i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å– yyyy-MM-dd HH:mm:ss å­—ç¬¦ä¸²æ ¼å¼çš„æ—¶é—´ä¸­çš„å¹´ä»½ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> date åŸæ—¶é—´å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> å¹´ä»½ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">getYear</span><span class="params">(String date)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (date == <span class="literal">null</span> || <span class="string">&quot;&quot;</span>.equals(date)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> date.indexOf(<span class="string">&quot;-&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> date.substring(<span class="number">0</span>, i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–å½“å‰å­—ç¬¦ä¸²ç±»å‹çš„å¹´ä»½</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> å­—ç¬¦ä¸²ç±»å‹çš„å¹´ä»½ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">getThisYear</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> String.valueOf(LocalDate.now().getYear());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>AssertUtil</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> mofan</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2021/5/6 14:01</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AssertUtil</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ–­è¨€æŸä¸ªå¯¹è±¡ä¸ä¸º &lt;code&gt;null&lt;/code&gt;</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> o å¯¹è±¡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> message é”™è¯¯ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">dataNotNull</span><span class="params">(Object o, String message)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (o == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.DATA_IS_NULL).addError(message);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ–­è¨€æŠ›å‡ºäº† BusinessException å¼‚å¸¸</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> condition æ¡ä»¶ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> code ErrorCode ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> msg é”™è¯¯ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">throwBusinessException</span><span class="params">(<span class="type">boolean</span> condition, String code, String msg)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (condition) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(code).addError(msg);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="8-åç«¯-å…¶ä»–"><a class="header-anchor" href="#8-åç«¯-å…¶ä»–"></a>8. åç«¯ - å…¶ä»–</h1>
<h2 id="8-1-DateTimeFormat-ä¸-JsonFormat-çš„åŒºåˆ«"><a class="header-anchor" href="#8-1-DateTimeFormat-ä¸-JsonFormat-çš„åŒºåˆ«"></a>8.1 <code>@DateTimeFormat</code> ä¸ <code>@JsonFormat</code> çš„åŒºåˆ«</h2>
<p>ä¸€èˆ¬éƒ½æ˜¯ä½¿ç”¨ <code>@DateTimeFormat</code> æŠŠä¼ ç»™åå°çš„æ—¶é—´å­—ç¬¦ä¸²è½¬æˆ <code>Date</code>ï¼Œä½¿ç”¨ <code>@JsonFormat</code> æŠŠåå°ä¼ å‡ºçš„ <code>Date</code> è½¬æˆæ—¶é—´å­—ç¬¦ä¸²ã€‚</p>
<p>ä½†æ˜¯ <code>@DateTimeFormat</code> åªä¼šåœ¨ç±»ä¼¼ <code>@RequestParam</code> çš„è¯·æ±‚å‚æ•°ï¼ˆurlæ‹¼æ¥çš„å‚æ•°æ‰ç”Ÿæ•ˆï¼Œå¦‚æœæ˜¯æ”¾åˆ°RequestBodyä¸­çš„form-dataæ˜¯æ— æ•ˆçš„ï¼‰ä¸Šç”Ÿæ•ˆï¼Œå³ï¼š<code>@DateTimeFormat</code> æ”¾åˆ° <code>@RequestBody</code> ä¸‹æ˜¯æ— æ•ˆçš„ã€‚</p>
<p>åœ¨ <code>@RequestBody</code> ä¸­åˆ™å¯ä»¥ä½¿ç”¨ <code>@JsonFormat</code> æŠŠä¼ ç»™åå°çš„æ—¶é—´å­—ç¬¦ä¸²è½¬æˆDateï¼Œä¹Ÿå°±æ˜¯è¯´ <code>@JsonFormat</code> å…¶å®æ—¢å¯ä»¥æŠŠä¼ ç»™åå°çš„æ—¶é—´å­—ç¬¦ä¸²è½¬æˆDateä¹Ÿå¯ä»¥æŠŠåå°ä¼ å‡ºçš„ <code>Date</code> è½¬æˆæ—¶é—´å­—ç¬¦ä¸²ã€‚</p>
<h2 id="8-2-Excel-çš„å¯¼å‡º"><a class="header-anchor" href="#8-2-Excel-çš„å¯¼å‡º"></a>8.2 Excel çš„å¯¼å‡º</h2>
<p>åœ¨æ­¤ä»¥è”ç³»æ–¹å¼çš„å¯¼å‡ºä¸ºä¾‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> Result&lt;Void&gt; <span class="title function_">exportContact</span><span class="params">(HttpServletResponse response)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        response.setContentType(<span class="string">&quot;application/vnd.openxmlformats-officedocument.spreadsheetml.sheet&quot;</span>);</span><br><span class="line">        response.setCharacterEncoding(<span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line">        <span class="comment">// è¿™é‡Œ URLEncoder.encode å¯ä»¥é˜²æ­¢ä¸­æ–‡ä¹±ç </span></span><br><span class="line">        <span class="type">String</span> <span class="variable">fileName</span> <span class="operator">=</span> java.net.URLEncoder.encode(<span class="string">&quot;è”ç³»æ–¹å¼&quot;</span>, <span class="string">&quot;UTF-8&quot;</span>)</span><br><span class="line">                .replaceAll(<span class="string">&quot;\\+&quot;</span>, <span class="string">&quot;%20&quot;</span>);</span><br><span class="line">        response.setHeader(<span class="string">&quot;Content-Disposition&quot;</span>, <span class="string">&quot;attachment;filename*=utf-8&#x27;&#x27;&quot;</span> + fileName + <span class="string">&quot;.xlsx&quot;</span>);</span><br><span class="line">        <span class="comment">// è·å–éœ€è¦å¯¼å‡ºè”ç³»æ–¹å¼ä¿¡æ¯</span></span><br><span class="line">        List&lt;ContactExportDto&gt; list = <span class="built_in">this</span>.getContactExportDtoList();</span><br><span class="line">        AssertUtil.throwBusinessException(list.size() == <span class="number">0</span>, ErrorCode.EMPTY_CONTACT_INFO, <span class="string">&quot;æš‚æ— å¯å¯¼å‡ºçš„è”ç³»æ–¹å¼ä¿¡æ¯&quot;</span>);</span><br><span class="line">        <span class="comment">// è¿™é‡Œéœ€è¦è®¾ç½®ä¸å…³é—­æµ</span></span><br><span class="line">        EasyExcel.write(response.getOutputStream(), ContactExportDto.class).autoCloseStream(Boolean.FALSE).sheet()</span><br><span class="line">                .doWrite(list);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        ExcelExportResponse.exportFailedResponse(response, e);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> Result.success();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Excel å¯¼å‡ºå¤±è´¥çš„å“åº”ä¿¡æ¯ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> mofan</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2021/5/29 18:10</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ExcelExportResponse</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Excel å¯¼å‡ºå¤±è´¥å“åº”</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> response å“åº”ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> e æŠ›å‡ºçš„å¼‚å¸¸</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IOException IO å¼‚å¸¸</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">exportFailedResponse</span><span class="params">(HttpServletResponse response, Exception e)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="comment">// é‡ç½®response</span></span><br><span class="line">        response.reset();</span><br><span class="line">        response.setContentType(<span class="string">&quot;application/json&quot;</span>);</span><br><span class="line">        response.setCharacterEncoding(<span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line">        Result&lt;Object&gt; result = <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">if</span> (e <span class="keyword">instanceof</span> BusinessException) &#123;</span><br><span class="line">            log.error(((BusinessException) e).code() + <span class="string">&quot; : &quot;</span> + e.getMessage());</span><br><span class="line">            result = <span class="keyword">new</span> <span class="title class_">Result</span>&lt;&gt;(((BusinessException) e).code(), e.getMessage());</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">defaultMessage</span> <span class="operator">=</span> <span class="string">&quot;Excelå¯¼å‡ºå¤±è´¥&quot;</span>;</span><br><span class="line">            log.error(ErrorCode.EXCEL_EXPORT_ERROR + <span class="string">&quot; : &quot;</span> + defaultMessage);</span><br><span class="line">            result = <span class="keyword">new</span> <span class="title class_">Result</span>&lt;&gt;(ErrorCode.EXCEL_EXPORT_ERROR, defaultMessage);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å†æ¬¡è®¾ç½®è·¨åŸŸï¼Œå¦åˆ™å‰ç«¯å‡ºç°è·¨åŸŸ</span></span><br><span class="line">        response.setHeader(<span class="string">&quot;Access-Control-Allow-Origin&quot;</span>, <span class="string">&quot;*&quot;</span>);</span><br><span class="line">        response.getWriter().print(<span class="keyword">new</span> <span class="title class_">ObjectMapper</span>().writeValueAsString(result));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="9-å‰ç«¯-JS-çš„å°è£…"><a class="header-anchor" href="#9-å‰ç«¯-JS-çš„å°è£…"></a>9. å‰ç«¯ - JS çš„å°è£…</h1>
<h2 id="9-1-http-js"><a class="header-anchor" href="#9-1-http-js"></a>9.1 http.js</h2>
<p>ç”±äºåç«¯ä½¿ç”¨äº† JWT å’Œ SpringSecurityï¼Œè¦æ±‚å‰ç«¯å‘é€çš„è¯·æ±‚éƒ½è¦åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ ä¸Š Tokenï¼Œå› æ­¤éœ€è¦å¯¹å‰ç«¯ä½¿ç”¨çš„ Axios è¿›è¡Œé…ç½®ï¼Œæ¯”å¦‚æ·»åŠ æ‹¦æˆªå™¨ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">&#x27;../router&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Vue</span> <span class="keyword">from</span> <span class="string">&#x27;../main&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Axios ç›¸å…³é…ç½®</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ–°å¼€ä¸€ä¸ªæ–‡ä»¶è¿›è¡Œé…ç½®</span></span><br><span class="line"><span class="comment"> * é˜²æ­¢åœ¨åˆ·æ–°é¡µé¢åï¼ŒAxios æ‹¦æˆªå™¨ä¸ç”Ÿæ•ˆ</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// é…ç½® axios è¯·æ±‚åŸºç¡€ URL</span></span><br><span class="line">axios.<span class="property">defaults</span>.<span class="property">baseURL</span> = <span class="string">&#x27;http://127.0.0.1:9090&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// axios æ‹¦æˆªå™¨ï¼Œä¸ºæ¯æ¬¡è¯·æ±‚æ·»åŠ  Token</span></span><br><span class="line">axios.<span class="property">interceptors</span>.<span class="property">request</span>.<span class="title function_">use</span>(<span class="function"><span class="params">config</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span>(config.<span class="property">url</span> === <span class="string">&#x27;/auth/login&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> config;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// è¿™é‡Œçš„configåŒ…å«æ¯æ¬¡è¯·æ±‚çš„å†…å®¹</span></span><br><span class="line">  <span class="keyword">const</span> token = <span class="variable language_">window</span>.<span class="property">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">&quot;token&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> (token != <span class="literal">null</span> &amp;&amp; token != <span class="string">&#x27;&#x27;</span>) &#123;</span><br><span class="line">    <span class="comment">// æ·»åŠ headers</span></span><br><span class="line">    config.<span class="property">headers</span>[<span class="string">&#x27;Authorization&#x27;</span>] = token;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123; &#125;</span><br><span class="line">  <span class="keyword">return</span> config;</span><br><span class="line">&#125;, <span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(err);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// å¼‚æ­¥è¯·æ±‚åï¼Œåˆ¤æ–­tokenæ˜¯å¦è¿‡æœŸ</span></span><br><span class="line">axios.<span class="property">interceptors</span>.<span class="property">response</span>.<span class="title function_">use</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// åˆ¤æ–­å½“å‰ç”¨æˆ·ç™»å½•çŠ¶æ€</span></span><br><span class="line">  <span class="title function_">verifyUserLoginStatus</span>(res);</span><br><span class="line">  <span class="keyword">return</span> res;</span><br><span class="line">&#125;, <span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(err);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> axios;</span><br></pre></td></tr></table></figure>
<h2 id="9-2-tools-js"><a class="header-anchor" href="#9-2-tools-js"></a>9.2 tools.js</h2>
<p>ä¸ºäº†æ›´å¥½åœ°ä½¿ç”¨ Element-UI ä¸­çš„ Messageï¼ˆæ¶ˆæ¯æç¤ºï¼‰ç»„ä»¶ï¼Œåœ¨è¿™é‡Œå¯¹è¿™ä¸ªç»„ä»¶çš„ä½¿ç”¨è¿›è¡Œç®€å•çš„å°è£…ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Element æ¶ˆæ¯æç¤ºç»„ä»¶</span></span><br><span class="line"><span class="comment"> * type å¯ä¾›çš„å–å€¼: success/warning/info/error</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">showMsg</span>(<span class="params">_this, msg, type, duration</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (duration == <span class="literal">null</span>) &#123;</span><br><span class="line">    duration = <span class="number">1500</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (msg == <span class="literal">null</span>) <span class="keyword">return</span>;</span><br><span class="line">  _this.$message(&#123;</span><br><span class="line">    <span class="attr">message</span>: msg,</span><br><span class="line">    <span class="attr">type</span>: type,</span><br><span class="line">    <span class="attr">duration</span>: duration</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Tools</span> = &#123;</span><br><span class="line">  showMsg</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Tools</span>;</span><br></pre></td></tr></table></figure>
<h2 id="9-3-file-js"><a class="header-anchor" href="#9-3-file-js"></a>9.3 file.js</h2>
<p>å¯¹äºæ–‡ä»¶çš„ä¸Šä¼ æ¥è¯´ï¼Œé™¤äº†åœ¨åç«¯è¿›è¡Œç±»å‹æ ¡éªŒå¤–ï¼Œè¿˜éœ€è¦åœ¨å‰ç«¯å¯¹æ–‡ä»¶ç±»å‹è¿›è¡Œæ ¡éªŒã€‚è¿™é‡Œåªå¯¹ Excelã€PDF ç±»å‹çš„æ–‡ä»¶è¿›è¡Œäº†ç±»å‹æ ¡éªŒï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Tools</span> <span class="keyword">from</span> <span class="string">&#x27;./tools&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ ¡éªŒå½“å‰æ–‡ä»¶æ˜¯å¦æ˜¯ Excel æ–‡ä»¶</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">verifyExcelTypeAndSize</span>(<span class="params">_this, file</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> fileType = <span class="title function_">getFileType</span>(file);</span><br><span class="line">  <span class="keyword">let</span> isExcel = (fileType === <span class="string">&quot;xls&quot;</span>) || (fileType === <span class="string">&quot;xlsx&quot;</span>);</span><br><span class="line">  <span class="keyword">let</span> isLt5M = file.<span class="property">size</span> / <span class="number">1024</span> / <span class="number">1024</span> &lt; <span class="number">5</span>;</span><br><span class="line">  <span class="keyword">if</span> (!isExcel) &#123;</span><br><span class="line">    <span class="title class_">Tools</span>.<span class="title function_">showMsg</span>(_this, <span class="string">&quot;ä¸Šä¼ æ–‡ä»¶åªèƒ½æ˜¯Excelæ–‡ä»¶æ ¼å¼&quot;</span>, <span class="string">&quot;error&quot;</span>, <span class="number">4000</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (!isLt5M) &#123;</span><br><span class="line">    <span class="title class_">Tools</span>.<span class="title function_">showMsg</span>(_this, <span class="string">&quot;ä¸Šä¼ æ–‡ä»¶å¤§å°ä¸è¶…è¿‡5M&quot;</span>, <span class="string">&quot;error&quot;</span>, <span class="number">4000</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ ¡éªŒå½“å‰æ–‡ä»¶æ˜¯å¦æ˜¯ pdf æ–‡ä»¶</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"> <span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">verifyPdfTypeAndSize</span>(<span class="params">_this, file</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> fileType = <span class="title function_">getFileType</span>(file);</span><br><span class="line">  <span class="keyword">let</span> isExcel = (fileType === <span class="string">&quot;pdf&quot;</span>);</span><br><span class="line">  <span class="keyword">let</span> isLt10M = file.<span class="property">size</span> / <span class="number">1024</span> / <span class="number">1024</span> &lt; <span class="number">10</span>;</span><br><span class="line">  <span class="keyword">if</span> (!isExcel) &#123;</span><br><span class="line">    <span class="title class_">Tools</span>.<span class="title function_">showMsg</span>(_this, <span class="string">&quot;ä¸Šä¼ æ–‡ä»¶åªèƒ½æ˜¯PDFæ–‡ä»¶æ ¼å¼&quot;</span>, <span class="string">&quot;error&quot;</span>, <span class="number">4000</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (!isLt10M) &#123;</span><br><span class="line">    <span class="title class_">Tools</span>.<span class="title function_">showMsg</span>(_this, <span class="string">&quot;ä¸Šä¼ æ–‡ä»¶å¤§å°ä¸è¶…è¿‡10M&quot;</span>, <span class="string">&quot;error&quot;</span>, <span class="number">4000</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ ¹æ® File ç±»è·å–æ–‡ä»¶ç±»å‹</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">*</span>&#125; file  File ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> &#123;<span class="type">*</span>&#125; æ–‡ä»¶ç±»å‹</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getFileType</span>(<span class="params">file</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> fileName = file.<span class="property">name</span>;</span><br><span class="line">  <span class="keyword">let</span> startIndex = fileName.<span class="title function_">lastIndexOf</span>(<span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">  <span class="keyword">if</span>(startIndex != -<span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> fileName.<span class="title function_">substring</span>(startIndex + <span class="number">1</span>, fileName.<span class="property">length</span>).<span class="title function_">toLowerCase</span>();</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="9-4-date-js"><a class="header-anchor" href="#9-4-date-js"></a>9.4 date.js</h2>
<p>å°† JS ä¸­ Date ç±»å‹çš„æ ¼å¼è½¬æ¢æˆ <code>yyyy-MM-dd HH:mm:ss</code> æ ¼å¼ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å°†å­—ç¬¦ä¸²æ—¥æœŸè½¬æ¢ä¸º yyyy-MM-dd HH:mm:ss æ ¼å¼</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@export</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">*</span>&#125; <span class="variable">date</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> &#123;<span class="type">*</span>&#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">renderTime</span>(<span class="params">date</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span>(date != <span class="literal">null</span> &amp;&amp; date != <span class="string">&#x27;&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> dateJson = <span class="keyword">new</span> <span class="title class_">Date</span>(date).<span class="title function_">toJSON</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Date</span>(+<span class="keyword">new</span> <span class="title class_">Date</span>(dateJson) + <span class="number">8</span> * <span class="number">3600</span> * <span class="number">1000</span>).<span class="title function_">toISOString</span>().<span class="title function_">replace</span>(<span class="regexp">/T/g</span>, <span class="string">&#x27; &#x27;</span>).<span class="title function_">replace</span>(<span class="regexp">/\.[\d]&#123;3&#125;Z/</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨æµè§ˆå™¨ä¸­çš„ä½¿ç”¨ç»“æœï¼š</p>
<p><img src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/loading.gif" data-lazy-src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/SummaryImages/date.js%E4%BD%BF%E7%94%A8%E7%A4%BA%E4%BE%8B.png" alt="date.jsä½¿ç”¨ç¤ºä¾‹"></p>
<h2 id="9-5-request-js"><a class="header-anchor" href="#9-5-request-js"></a>9.5 request.js</h2>
<p>åœ¨è¿›è¡Œåˆ é™¤ç­‰æ•æ„Ÿæ“ä½œæ—¶ï¼Œå‰ç«¯åº”å½“æ˜¾ç¤ºç¡®è®¤æ¡†ï¼Œå½“ç”¨æˆ·ç‚¹å‡»â€œç¡®å®šâ€åæ‰è¿›è¡Œæ•æ„Ÿæ“ä½œã€‚</p>
<p>é€šè¿‡ç‚¹å‡»æŒ‰é’®å®ç° Excel çš„ä¸‹è½½æ—¶ï¼Œåªéœ€è¦æ”¹å˜è¯·æ±‚åœ°å€å³å¯ï¼Œå› æ­¤ä¹Ÿå¯¹ Excel çš„ä¸‹è½½è¿›è¡Œå°è£…ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Tools</span> <span class="keyword">from</span> <span class="string">&quot;../utils/tools&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ•æ„Ÿæ“ä½œ</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">*</span>&#125; _this Vue å®ä¾‹</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">*</span>&#125; warningMsg é”™è¯¯ä¿¡æ¯</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">*</span>&#125; func è¿›è¡Œçš„æ•æ„Ÿæ“ä½œæ–¹æ³•</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">sensitiveOperation</span>(<span class="params">_this, warningMsg, func</span>) &#123;</span><br><span class="line">  _this.$confirm(warningMsg, <span class="string">&quot;æç¤º&quot;</span>, &#123;</span><br><span class="line">      <span class="attr">confirmButtonText</span>: <span class="string">&quot;ç¡®å®š&quot;</span>,</span><br><span class="line">      <span class="attr">concelButtonText</span>: <span class="string">&quot;å–æ¶ˆ&quot;</span>,</span><br><span class="line">      <span class="attr">type</span>: <span class="string">&quot;warning&quot;</span>,</span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">func</span>()</span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="title function_">catch</span>(<span class="function">() =&gt;</span> &#123;&#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å¯¼å‡º Excel æ–¹æ³•</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">*</span>&#125; _this Vue å®ä¾‹</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">*</span>&#125; url è¯·æ±‚è·¯å¾„</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">exportExcel</span>(<span class="params">_this, url</span>) &#123;</span><br><span class="line">  axios</span><br><span class="line">    .<span class="title function_">get</span>(url, &#123;</span><br><span class="line">      <span class="attr">responseType</span>: <span class="string">&quot;blob&quot;</span></span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">let</span> type = res.<span class="property">data</span>.<span class="property">type</span>;</span><br><span class="line">      <span class="keyword">const</span> relType = [</span><br><span class="line">        <span class="string">&quot;application/vnd.ms-excel&quot;</span>,</span><br><span class="line">        <span class="string">&quot;application/vnd.openxmlformats-officedocument.spreadsheetml.sheet&quot;</span>,</span><br><span class="line">      ];</span><br><span class="line">      <span class="comment">// Excel ä¸‹è½½å¤±è´¥æ—¶ --&gt; æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯</span></span><br><span class="line">      <span class="keyword">if</span> (type.<span class="title function_">includes</span>(<span class="string">&quot;application/json&quot;</span>)) &#123;</span><br><span class="line">        <span class="keyword">let</span> reader = <span class="keyword">new</span> <span class="title class_">FileReader</span>();</span><br><span class="line">        reader.<span class="property">onload</span> = <span class="keyword">function</span> (<span class="params">event</span>) &#123;</span><br><span class="line">          <span class="keyword">let</span> errorResult = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(reader.<span class="property">result</span>); <span class="comment">// é”™è¯¯ä¿¡æ¯</span></span><br><span class="line">          <span class="keyword">let</span> msg = <span class="title class_">Tools</span>.<span class="title function_">errMsg</span>(errorResult.<span class="property">code</span>, errorResult.<span class="property">msg</span>);</span><br><span class="line">          <span class="title class_">Tools</span>.<span class="title function_">showMsg</span>(_this, msg, <span class="string">&quot;error&quot;</span>, <span class="number">3000</span>);</span><br><span class="line">        &#125;;</span><br><span class="line">        reader.<span class="title function_">readAsText</span>(res.<span class="property">data</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// Excel å¯¼å‡ºæˆåŠŸ</span></span><br><span class="line">      <span class="keyword">if</span> (relType.<span class="title function_">includes</span>(type)) &#123;</span><br><span class="line">        <span class="keyword">let</span> blob = <span class="keyword">new</span> <span class="title class_">Blob</span>([res.<span class="property">data</span>]);</span><br><span class="line">        <span class="keyword">let</span> downloadElement = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;a&quot;</span>);</span><br><span class="line">        <span class="keyword">let</span> href = <span class="variable language_">window</span>.<span class="property">URL</span>.<span class="title function_">createObjectURL</span>(blob); <span class="comment">//åˆ›å»ºä¸‹è½½çš„é“¾æ¥</span></span><br><span class="line">        downloadElement.<span class="property">href</span> = href;</span><br><span class="line">        <span class="keyword">let</span> contentDisposition = res.<span class="property">headers</span>[<span class="string">&quot;content-disposition&quot;</span>];</span><br><span class="line">        <span class="keyword">let</span> fileName = <span class="string">&quot;undefine.xlsx&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span> (contentDisposition) &#123;</span><br><span class="line">          fileName = <span class="variable language_">window</span>.<span class="built_in">decodeURI</span>(</span><br><span class="line">            res.<span class="property">headers</span>[<span class="string">&quot;content-disposition&quot;</span>].<span class="title function_">split</span>(<span class="string">&quot;&#x27;&#x27;&quot;</span>)[<span class="number">1</span>],</span><br><span class="line">            <span class="string">&quot;UTF-8&quot;</span></span><br><span class="line">          );</span><br><span class="line">        &#125;</span><br><span class="line">        downloadElement.<span class="property">download</span> = fileName;</span><br><span class="line">        <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(downloadElement);</span><br><span class="line">        downloadElement.<span class="title function_">click</span>(); <span class="comment">//ç‚¹å‡»ä¸‹è½½</span></span><br><span class="line">        <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">removeChild</span>(downloadElement); <span class="comment">//ä¸‹è½½å®Œæˆç§»é™¤å…ƒç´ </span></span><br><span class="line">        <span class="variable language_">window</span>.<span class="property">URL</span>.<span class="title function_">revokeObjectURL</span>(href); <span class="comment">//é‡Šæ”¾æ‰blobå¯¹è±¡</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="title function_">catch</span>(<span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="title class_">Tools</span>.<span class="title function_">showMsg</span>(<span class="variable language_">this</span>, <span class="string">&quot;Excelå¯¼å‡ºå¤±è´¥ï¼&quot;</span>, <span class="string">&quot;error&quot;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="9-6-validate-js"><a class="header-anchor" href="#9-6-validate-js"></a>9.6 validate.js</h2>
<p>ä½¿ç”¨ Element-UI æäº¤ Dialog ç»„ä»¶ä¸­çš„è¡¨å•æ•°æ®æ—¶ï¼Œéœ€è¦å¯¹è¡¨å•ä¸­çš„æ•°æ®æœ‰æ•ˆæ€§è¿›è¡Œæ ¡éªŒï¼Œæ¯”å¦‚å¯¹ç”µè¯å·ç æ ¼å¼ã€é‚®ç®±æ ¼å¼è¿›è¡Œæ ¡éªŒã€‚å¦‚æœæ ¡éªŒä¸é€šè¿‡ï¼Œåº”å½“åœ¨æ‰€åœ¨ä½ç½®æ˜¾ç¤ºæç¤ºä¿¡æ¯ï¼Œå½“å…³é—­ Dialog æ—¶ï¼Œè¿˜éœ€è¦æ¸…ç©ºæ ¡éªŒä¿¡æ¯ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * éªŒè¯å¹¶æäº¤è¡¨å•ä¿¡æ¯</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">formValidate</span>(<span class="params">_this, refName, errMsg, func</span>) &#123;</span><br><span class="line">  _this.<span class="property">$refs</span>[refName].<span class="title function_">validate</span>(<span class="function">(<span class="params">valid</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (valid) &#123;</span><br><span class="line">      <span class="title function_">func</span>()</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      _this.$message(&#123;</span><br><span class="line">        <span class="attr">message</span>: errMsg,</span><br><span class="line">        <span class="attr">type</span>: <span class="string">&quot;error&quot;</span>,</span><br><span class="line">        <span class="attr">duration</span>: <span class="number">3000</span>,</span><br><span class="line">      &#125;);</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ¸…ç©ºè¡¨å•éªŒè¯ä¿¡æ¯</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">resetForm</span>(<span class="params">_this, refName</span>) &#123;</span><br><span class="line">  _this.<span class="property">$refs</span>[refName].<span class="title function_">resetFields</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç”¨æˆ·å¯†ç éªŒè¯</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">passwordValidate</span> = (<span class="params">rule, value, callback, errMsg</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> passwordReg = <span class="regexp">/^[a-zA-Z]\w&#123;4,15&#125;$/</span>;</span><br><span class="line">  <span class="keyword">if</span> (!value) &#123;</span><br><span class="line">    <span class="keyword">if</span> (errMsg != <span class="literal">null</span> &amp;&amp; errMsg != <span class="string">&#x27;&#x27;</span> &amp;&amp; errMsg != <span class="literal">undefined</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="title function_">callback</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(errMsg))</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">callback</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;å¯†ç ä¸èƒ½ä¸ºç©º&#x27;</span>))</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (passwordReg.<span class="title function_">test</span>(value)) &#123;</span><br><span class="line">      <span class="title function_">callback</span>()</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="title function_">callback</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;ä»¥å­—æ¯å¼€å¤´ï¼Œé•¿åº¦åœ¨5~16ä¹‹é—´ï¼Œåªèƒ½åŒ…å«å­—æ¯ã€æ•°å­—å’Œä¸‹åˆ’çº¿&#x27;</span>))</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, <span class="number">100</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç”¨æˆ·è´¦å·éªŒè¯</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">accountValidate</span> = (<span class="params">rule, value, callback</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> accountReg = <span class="regexp">/^[a-zA-Z0-9][a-zA-Z0-9_]&#123;4,15&#125;$/</span>;</span><br><span class="line">  <span class="keyword">if</span> (!value) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">callback</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;è´¦å·ä¸èƒ½ä¸ºç©º&#x27;</span>))</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (accountReg.<span class="title function_">test</span>(value)) &#123;</span><br><span class="line">      <span class="title function_">callback</span>()</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="title function_">callback</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;ä»¥å­—æ¯æˆ–æ•°å­—å¼€å¤´ï¼Œé•¿åº¦åœ¨5~16ä¹‹é—´ï¼Œå…è®¸å­—æ¯ã€æ•°å­—å’Œä¸‹åˆ’çº¿&#x27;</span>))</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, <span class="number">100</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç”µè¯å·ç éªŒè¯</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">phoneNumValidate</span> = (<span class="params">rule, value, callback, notNull</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> phoneReg = <span class="regexp">/^(13[0-9]|14[5|7]|15[0|1|2|3|4|5|6|7|8|9]|18[0|1|2|3|5|6|7|8|9])\d&#123;8&#125;$/</span>;</span><br><span class="line">  <span class="keyword">if</span> (!value) &#123;</span><br><span class="line">    <span class="keyword">if</span> (notNull) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="title function_">callback</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;ç”µè¯å·ç ä¸èƒ½ä¸ºç©º&#x27;</span>))</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">callback</span>()</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="title class_">Number</span>.<span class="title function_">isInteger</span>(+value)) &#123;</span><br><span class="line">      <span class="title function_">callback</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;è¯·è¾“å…¥æ•°å­—å€¼&#x27;</span>))</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (phoneReg.<span class="title function_">test</span>(value)) &#123;</span><br><span class="line">        <span class="title function_">callback</span>()</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="title function_">callback</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;ç”µè¯å·ç æ ¼å¼ä¸æ­£ç¡®&#x27;</span>))</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, <span class="number">100</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ä¼ çœŸç”µè¯å·ç éªŒè¯</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">faxNumValidate</span> = (<span class="params">rule, value, callback, notNull</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> faxReg = <span class="regexp">/\d&#123;3&#125;-\d&#123;8&#125;|\d&#123;4&#125;-\d&#123;7&#125;/</span>;</span><br><span class="line">  <span class="keyword">if</span> (!value) &#123;</span><br><span class="line">    <span class="keyword">if</span> (notNull) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="title function_">callback</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;ä¼ çœŸç”µè¯å·ç ä¸èƒ½ä¸ºç©º&#x27;</span>))</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">callback</span>()</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (faxReg.<span class="title function_">test</span>(value)) &#123;</span><br><span class="line">      <span class="title function_">callback</span>()</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="title function_">callback</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;è¯·è¾“å…¥æ­£ç¡®æ ¼å¼çš„ä¼ çœŸç”µè¯å·ç &#x27;</span>))</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, <span class="number">100</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * é‚®ç®±éªŒè¯</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">emailValidate</span> = (<span class="params">rule, value, callback, notNull</span>) =&gt; &#123;</span><br><span class="line">  <span class="comment">// å¦ä¸€ä¸ªé‚®ç®±æ­£åˆ™ ^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$</span></span><br><span class="line">  <span class="keyword">const</span> mailReg = <span class="regexp">/^[A-Za-z\d]+([-_.][A-Za-z\d]+)*@([A-Za-z\d]+[-.])+[A-Za-z\d]&#123;2,4&#125;$/</span>;</span><br><span class="line">  <span class="keyword">if</span> (!value) &#123;</span><br><span class="line">    <span class="keyword">if</span> (notNull) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="title function_">callback</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;é‚®ç®±ä¸èƒ½ä¸ºç©º&#x27;</span>))</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">callback</span>()</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (mailReg.<span class="title function_">test</span>(value)) &#123;</span><br><span class="line">      <span class="title function_">callback</span>()</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="title function_">callback</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;è¯·è¾“å…¥æ­£ç¡®æ ¼å¼çš„é‚®ç®±&#x27;</span>))</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, <span class="number">100</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * èº«ä»½è¯éªŒè¯</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">identityNumValidate</span> = (<span class="params">rule, value, callback, notNull</span>) =&gt; &#123;</span><br><span class="line">  <span class="comment">// èº«ä»½è¯æ­£åˆ™ (^\d&#123;15&#125;$)|(^\d&#123;18&#125;$)|(^\d&#123;17&#125;(\d|X|x)$)</span></span><br><span class="line">  <span class="keyword">const</span> mailReg = <span class="regexp">/(^\d&#123;15&#125;$)|(^\d&#123;18&#125;$)|(^\d&#123;17&#125;(\d|X|x)$)/</span>;</span><br><span class="line">  <span class="keyword">if</span> (!value) &#123;</span><br><span class="line">    <span class="keyword">if</span> (notNull) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="title function_">callback</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;èº«ä»½è¯å·ç ä¸èƒ½ä¸ºç©º&#x27;</span>))</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">callback</span>()</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (mailReg.<span class="title function_">test</span>(value)) &#123;</span><br><span class="line">      <span class="title function_">callback</span>()</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="title function_">callback</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;è¯·è¾“å…¥æ­£ç¡®æ ¼å¼çš„èº«ä»½è¯å·ç &#x27;</span>))</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, <span class="number">100</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="9-7-index-js"><a class="header-anchor" href="#9-7-index-js"></a>9.7 index.js</h2>
<p>è·¯ç”±å‰ç½®å®ˆå«ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å…¨å±€å‰ç½®å®ˆå«</span></span><br><span class="line">router.<span class="title function_">beforeEach</span>(<span class="function">(<span class="params">to, <span class="keyword">from</span>, next</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">   *  to å°†è¦è®¿é—®çš„è·¯å¾„</span></span><br><span class="line"><span class="comment">   * from ä»å“ªä¸ªè·¯å¾„è·³è½¬è€Œæ¥</span></span><br><span class="line"><span class="comment">   * next  ä¸€ä¸ªå‡½æ•°ï¼Œè¡¨ç¤ºæ”¾è¡Œ</span></span><br><span class="line"><span class="comment">   * next() æ”¾è¡Œ next(&#x27;/xxx&#x27;) å¼ºåˆ¶è·³è½¬</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="comment">// ç•Œé¢ Title</span></span><br><span class="line">  <span class="keyword">if</span> (to.<span class="property">meta</span>.<span class="property">title</span>) &#123;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">title</span> = to.<span class="property">meta</span>.<span class="property">title</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (to.<span class="property">path</span> === <span class="string">&#x27;/&#x27;</span>) <span class="keyword">return</span> <span class="title function_">next</span>();</span><br><span class="line">  <span class="comment">// è·å– token ä¿¡æ¯</span></span><br><span class="line">  <span class="keyword">const</span> token = <span class="variable language_">window</span>.<span class="property">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">&#x27;token&#x27;</span>);</span><br><span class="line">  <span class="keyword">if</span> (token === <span class="literal">null</span> || token === <span class="string">&#x27;&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">next</span>(<span class="string">&#x27;/&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">next</span>();</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h1 id="10-Element-UI-çš„ä½¿ç”¨"><a class="header-anchor" href="#10-Element-UI-çš„ä½¿ç”¨"></a>10. Element-UI çš„ä½¿ç”¨</h1>
<h2 id="10-1-åœ¨è¡¨å•æŒ‡å®šå­—æ®µä¸‹æç¤ºé”™è¯¯ä¿¡æ¯"><a class="header-anchor" href="#10-1-åœ¨è¡¨å•æŒ‡å®šå­—æ®µä¸‹æç¤ºé”™è¯¯ä¿¡æ¯"></a>10.1 åœ¨è¡¨å•æŒ‡å®šå­—æ®µä¸‹æç¤ºé”™è¯¯ä¿¡æ¯</h2>
<p>æ¯”å¦‚ï¼Œåœ¨ä¸Šä¼ è€ƒè¯•ç§‘ç›®ä¿¡æ¯æ—¶ï¼Œå¯¹è€ƒè¯•ç§‘ç›®ç±»å‹è¿›è¡Œæ ¡éªŒï¼Œå¹¶ä¸”è€ƒè¯•ç§‘ç›®ç±»å‹å­—æ®µæ‰€åœ¨çš„è¾“å…¥æ¡†ç±»å‹ä¸ºä¸‹æ‹‰æ¡†ã€‚</p>
<p>å…ˆåœ¨ <code>data</code> ä¸­æŒ‡å®šé”™è¯¯ä¿¡æ¯ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">data</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="comment">// é”™è¯¯ä¿¡æ¯</span></span><br><span class="line">      <span class="attr">examTypeError</span>: <span class="literal">null</span>,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶ååœ¨ <code>el-form-item</code> ç»„ä»¶ä¸Šä½¿ç”¨ <code>error</code> å±æ€§ï¼Œç»‘å®šé”™è¯¯ä¿¡æ¯ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;el-form-item :error=&quot;examTypeError&quot;&gt;</span><br><span class="line">    &lt;el-select</span><br><span class="line">       @blur=&quot;selectValueValidate&quot;</span><br><span class="line">       @change=&quot;selectValueValidate&quot;</span><br><span class="line">    &gt;&lt;/el-select&gt;</span><br><span class="line">&lt;/el-form-item&gt;</span><br></pre></td></tr></table></figure>
<p>ç”±äºä½¿ç”¨ Element-UI è‡ªå¸¦çš„æ ¡éªŒå¯¹ Select ç»„ä»¶è¿›è¡Œæ ¡éªŒæ—¶æ— æ³•å‡†ç¡®åœ°æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯ï¼Œå› æ­¤åœ¨æ­¤ä½¿ç”¨äº‹ä»¶çš„æ–¹å¼è¿›è¡Œæ ¡éªŒï¼Œå¹¶æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯ã€‚</p>
<p>æœ€åç¼–å†™é”™è¯¯æ ¡éªŒæ–¹æ³•å³å¯ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">selectValueValidate</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">subjectForm</span>.<span class="property">examType</span> == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">examTypeError</span> = <span class="title class_">Math</span>.<span class="title function_">random</span>().<span class="title function_">toString</span>();</span><br><span class="line">        <span class="variable language_">this</span>.$nextTick(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">examTypeError</span> = <span class="string">&quot;è€ƒè¯•ç§‘ç›®ç±»å‹ä¸èƒ½ä¸ºç©º&quot;</span>;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>&lt;el-form-item&gt;</code> çš„ <code>error</code> å±æ€§ç›‘å¬çš„æ˜¯ <code>watch</code> æ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯ä¸¤æ¬¡é‡å¤çš„é”™è¯¯æ“ä½œï¼Œæç¤ºçš„é”™è¯¯ä¿¡æ¯ä¸€è‡´ï¼Œå°±ä¸ä¼šè§¦å‘ watch æ–¹æ³•ã€‚</p>
<p>Element-UI è¡¨å•ç»„ä»¶è§„å®šä¸€æ—¦è¡¨å•éªŒè¯é€šè¿‡å°±ä¼šæ¸…é™¤åŸæ¥çš„é”™è¯¯æç¤ºä¿¡æ¯ï¼Œè¿™æ ·å°±å¯¼è‡´äº†åœ¨è¿›è¡Œç¬¬äºŒæ¬¡éªŒè¯æ—¶åŸæ¥çš„é”™è¯¯ä¿¡æ¯è¢«æ¸…é™¤äº†ï¼Œè€Œä¸¤æ¬¡é”™è¯¯ä¿¡æ¯åˆä¸€è‡´æ²¡æ³•è§¦å‘ <code>watch</code> æ–¹æ³•ï¼Œæ‰€ä»¥ä¹Ÿä¸ä¼šé‡æ–°æ¸²æŸ“å‡ºæ–°çš„é”™è¯¯ä¿¡æ¯å‡ºæ¥ã€‚</p>
<p>è§£å†³æ–¹æ³•å¾ˆç®€å•ï¼šä½¿ç”¨ <code>$nextTick</code> æ¥ä¿®å¤è¿™ä¸ªé—®é¢˜ã€‚</p>
<p><code>vm.$nextTick</code> å¯ä»¥å°†å›è°ƒå»¶è¿Ÿåˆ°ä¸‹æ¬¡ DOM æ›´æ–°å¾ªç¯ä¹‹åæ‰§è¡Œã€‚åœ¨ä¿®æ”¹æ•°æ®ä¹‹åç«‹å³ä½¿ç”¨å®ƒï¼Œç„¶åç­‰å¾… DOM æ›´æ–°ã€‚æˆ‘ä»¬çŸ¥é“é”™è¯¯æç¤ºä¸æ˜¾ç¤ºçš„æ ¹æœ¬åŸå› æ˜¯ watch æ–¹æ³•æ²¡æœ‰è¢«è§¦å‘ã€‚é‚£å¦‚æœæˆ‘æ¯æ¬¡ç»™é”™è¯¯èµ‹å€¼ä¸€ä¸ªéšæœºå€¼ï¼Œç„¶åä½¿ç”¨ <code>$nextTick</code> åœ¨ DOM è¢«æ›´æ–°ä¹‹åå°†éšæœºå€¼æ”¹æˆæˆ‘ä»¬éœ€è¦çš„é”™è¯¯ä¿¡æ¯å°±å¯ä»¥äº†ã€‚</p>
<h2 id="10-2-el-select-è®¾ç½®-multiple-åå‡ºç°çš„é—®é¢˜"><a class="header-anchor" href="#10-2-el-select-è®¾ç½®-multiple-åå‡ºç°çš„é—®é¢˜"></a>10.2 el-select è®¾ç½® multiple åå‡ºç°çš„é—®é¢˜</h2>
<p>è®¾ç½® <code>&lt;el-select&gt;</code> çš„ <code>multiple</code> å±æ€§ï¼Œå¹¶ä¸ºè¯¥ç»„ä»¶ç»‘å®š Element UI çš„è¡¨å•éªŒè¯åï¼Œä¼šå‡ºç° <strong>ä¸€è¿›ç•Œé¢å°±æ ¡éªŒå¤±è´¥çš„é”™è¯¯æç¤ºä¿¡æ¯</strong>ï¼Œä¸ºè§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥åœ¨å½“å‰æ‰€åœ¨ Vue çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°ä¸­æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">created</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// é˜²æ­¢å‡ºç°ä¸€è¿›ç•Œé¢å°±æ ¡éªŒé”™è¯¯çš„æƒ…å†µ</span></span><br><span class="line">    <span class="variable language_">this</span>.$set(<span class="variable language_">this</span>.<span class="property">userForm</span>, <span class="string">&quot;roleList&quot;</span>, []);</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­ï¼Œ<code>this.userForm</code> æ˜¯ data åŸŸä¸­çš„è¡¨å•æ•°æ®ï¼Œå¦‚ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">data</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">userForm</span>: &#123;&#125;,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è€Œ <code>roleList</code> æ˜¯åœ¨ä½¿ç”¨æ ¡éªŒæ—¶ï¼ŒElement UI <code>&lt;el-select&gt;</code> ç»„ä»¶æ‰€åœ¨çš„ <code>&lt;el-form-item&gt;</code> ç»„ä»¶ç»‘å®šçš„ <code>prop</code> çš„å€¼ï¼Œå¦‚ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;el-form-item prop=&quot;roleList&quot;&gt;</span><br><span class="line">    &lt;el-select v-model=&quot;userForm.roleList&quot; multiple &gt;</span><br><span class="line">        &lt;!----&gt;</span><br><span class="line">    &lt;/el-select&gt;</span><br><span class="line">&lt;/el-form-item&gt;</span><br></pre></td></tr></table></figure>
<p>å½“ <code>&lt;el-select&gt;</code> ç»„ä»¶è¢«è®¾ç½®äº† <code>multiple</code> å±æ€§åï¼Œå…¶ç»‘å®šçš„æ•°æ®ç±»å‹å°†ä¼šå˜ä¸ºä¸€ä¸ªæ•°ç»„ï¼Œå› æ­¤éœ€è¦å°†å…¶è®¾ç½®ä¸º <code>[]</code>ã€‚</p>
<p>è€Œå‡ºç°è¿™ç§é—®é¢˜çš„åŸå› ä¹Ÿå¾ˆç®€å•ï¼Œå½“ <code>&lt;el-select&gt;</code> ç»„ä»¶è¢«è®¾ç½®äº† <code>multiple</code> å±æ€§åï¼Œåˆæ¬¡è¿›å…¥è¿™ä¸ªè¿™ä»¶çš„æ‰€åœ¨çš„é¡µé¢æ—¶ï¼Œå°†ä¼šè‡ªåŠ¨è§¦å‘ <code>&lt;el-select&gt;</code> ç»„ä»¶çš„ <code>change</code> äº‹ä»¶ï¼Œè€Œç”±äºæˆ‘ä»¬ <code>data</code> åŸŸä¸­è¡¨å•æ•°æ®åˆå§‹åŒ–ä¸º <code>userForm: &#123;&#125;</code>ï¼ŒElement UI å°±ä¼šè®¤å®šå€¼ç¼ºå¤±ï¼Œå¹¶æ˜¾ç¤ºæ ¡éªŒå¤±è´¥çš„é”™è¯¯æç¤ºä¿¡æ¯ã€‚</p>
<blockquote>
<p>è¡¥å……</p>
</blockquote>
<p>è€Œæˆ‘åœ¨ä½¿ç”¨æ—¶ï¼Œæ˜¯åœ¨ Element UI dialog å¯¹è¯æ¡†ä¸­ä½¿ç”¨äº† <code>&lt;el-select&gt;</code> ç»„ä»¶ï¼Œå¹¶ä¸”å°†è¿™ä¸ªå¯¹è¯æ¡†å†™åœ¨äº†å¦ä¸€ä¸ª <code>vue</code> æ–‡ä»¶ä¸­ã€‚</p>
<p>ä¸ºäº†åœ¨ç¬¬äºŒæ¬¡æ‰“å¼€ dialog æ—¶ï¼Œå°†ç»‘å®šæ•°æ®å’Œæ ¡éªŒä¿¡æ¯æ¸…ç©ºï¼Œå› æ­¤ä¸º <code>&lt;el-dialog&gt;</code> ç»„ä»¶ç»‘å®šäº† <code>close</code> æ–¹æ³•ï¼Œä½¿å…¶åœ¨å…³é—­ dialog æ—¶ï¼Œå¯ä»¥æ¸…ç©ºç»‘å®šæ•°æ®å’Œæ ¡éªŒä¿¡æ¯æ¸…ç©ºã€‚å¦‚ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;el-dialog @close=&quot;closeSaveOrUpdateDialog&quot;&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">closeSaveOrUpdateDialog</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">userForm</span> = &#123;&#125;;</span><br><span class="line">    <span class="title function_">resetForm</span>(<span class="variable language_">this</span>, <span class="string">&quot;userForm&quot;</span>);</span><br><span class="line">    <span class="comment">// é˜²æ­¢å‡ºç°ä¸€è¿›ç•Œé¢å°±æ ¡éªŒé”™è¯¯çš„æƒ…å†µ</span></span><br><span class="line">    <span class="variable language_">this</span>.$set(<span class="variable language_">this</span>.<span class="property">userForm</span>, <span class="string">&quot;roleList&quot;</span>, []);</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<p>æ³¨æ„ï¼Œç”±äºè¿™é‡Œç›´æ¥å°† <code>this.userForm</code> è®¾ç½®ä¸º <code>&#123;&#125;</code>ï¼Œåˆå‡ºç°äº†å‰é¢çš„é—®é¢˜ï¼Œ<strong>å› æ­¤åœ¨è¿™æ–¹æ³•æœ€åä¹Ÿè¦è®¾ç½®ä¸€ä¸‹ã€‚</strong></p>
<p>å¦åˆ™å°±ä¼šå‡ºç°ä»¥ä¸‹æƒ…å†µï¼šç¬¬ä¸€æ¬¡æ‰“å¼€ dialog ä¸ä¼šè§¦å‘å¼‚å¸¸æ ¡éªŒï¼Œå•¥éƒ½ä¸å¹²ï¼Œå†æ¬¡æ‰“å¼€æ—¶å°±åˆä¼šè§¦å‘å¼‚å¸¸æ ¡éªŒã€‚</p>
<hr>
<p>å¦‚æœ <code>&lt;el-select&gt;</code> ç»„ä»¶è¢«è®¾ç½®äº† <code>multiple</code> å±æ€§åï¼Œå‡ºç°äº†æ•°æ®æ— æ³•å›æ˜¾ï¼Œæˆ–æ•°æ®æ— æ³•ç¼–è¾‘çš„æƒ…å†µï¼Œå¯ä»¥ä¸º <code>&lt;el-select&gt;</code> ç»„ä»¶ç»‘å®š <code>change</code> äº‹ä»¶ï¼Œå¹¶åœ¨è¿™ä¸ªäº‹ä»¶ç»‘å®šçš„æ–¹æ³•ä¸­æ‰§è¡Œï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">changeSelect</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.$forceUpdate()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™æ˜¯å› ä¸ºç”±äºä¸€äº›åµŒå¥—ç‰¹åˆ«æ·±çš„æ•°æ®ï¼Œå¯¼è‡´æ•°æ®æ›´æ–°äº†ï¼Œä½†æ˜¯é¡µé¢å´æ²¡æœ‰é‡æ–°æ¸²æŸ“ï¼Œéœ€è¦ä½¿ç”¨ <code>this.$forceUpdate()</code> è¿«ä½¿ Vue å®ä¾‹é‡æ–°æ¸²æŸ“ã€‚</p>
<blockquote>
<p>ç»éªŒä¹‹è°ˆ</p>
</blockquote>
<p>é’ˆå¯¹é¡µé¢ä¸Š data åŸŸä¸­åŒä¸€æ•°æ®çš„ç»‘å®šï¼Œæœ€å¥½ä½¿ç”¨ä¸€æ¬¡è¯·æ±‚å®Œæˆï¼Œè€Œä¸æ˜¯å‘åå°å‘é€å¤šæ¬¡è¯·æ±‚ã€‚</p>
<p>æ¯”å¦‚ï¼Œdata åŸŸä¸­æœ‰ä¸€å¦‚ä¸‹æ•°æ®ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">data</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">userForm</span>: &#123;&#125;,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¾ˆæ˜æ˜¾ï¼Œ<code>userForm</code> æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡ä¸­å¯èƒ½æœ‰å¤šä¸ªå±æ€§ï¼Œå½“æˆ‘ä»¬å‘åå°å‘é€è¯·æ±‚ï¼Œä¸ºè¿™ä¸ªå¯¹è±¡ç»‘å®šæ•°æ®æ—¶ï¼Œæœ€å¥½æ˜¯åœ¨ä¸€æ¬¡è¯·æ±‚å®Œæˆåå°±ä¸ºè¿™ä¸ªå¯¹è±¡ç»‘å®šæ•°æ®ã€‚è€Œä¸æ˜¯å…ˆå‘é€ä¸€æ¬¡è¯·æ±‚ï¼Œç»‘å®šè¯¥å¯¹è±¡ä¸­ Aã€B å±æ€§çš„å€¼ï¼Œå†å‘é€ä¸€æ¬¡è¯·æ±‚ç»‘å®šè¯¥å¯¹è±¡ä¸­ C å±æ€§çš„å€¼ã€‚</p>
<h1 id="11-å‰ç«¯-å…¶ä»–"><a class="header-anchor" href="#11-å‰ç«¯-å…¶ä»–"></a>11. å‰ç«¯ - å…¶ä»–</h1>
<h2 id="11-1-åç«¯-ID-å¼‚å¸¸"><a class="header-anchor" href="#11-1-åç«¯-ID-å¼‚å¸¸"></a>11.1 åç«¯ ID å¼‚å¸¸</h2>
<p>ç”±äº JS çš„ç²¾åº¦æ‰€é™ï¼Œå½“åç«¯çš„ ID ä¿¡æ¯ï¼ˆ<code>Long</code> ç±»å‹ï¼‰ä¼ é€’åˆ°å‰ç«¯æ—¶ä¼šå‡ºç°ç²¾åº¦ç¼ºå¤±ï¼Œå› æ­¤åç«¯åº”å½“å°† <code>Long</code> ç±»å‹çš„ ID ä¿¡æ¯è½¬æ¢æˆå­—ç¬¦ä¸²ä¼ é€’ç»™å‰ç«¯ã€‚</p>
<p>é’ˆå¯¹è¿™ç§æƒ…å†µï¼Œåç«¯å¯ä»¥åœ¨è¡¨ç¤º ID çš„å­—æ®µä¸Šä½¿ç”¨ Jackson çš„æ³¨è§£ï¼Œå¦‚ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* ä¸»é”®</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@JsonSerialize(using = ToStringSerializer.class)</span></span><br><span class="line"><span class="keyword">private</span> Long id;</span><br></pre></td></tr></table></figure>
<h2 id="11-2-Token-ä¿¡æ¯çš„å­˜å‚¨"><a class="header-anchor" href="#11-2-Token-ä¿¡æ¯çš„å­˜å‚¨"></a>11.2 Token ä¿¡æ¯çš„å­˜å‚¨</h2>
<p>ç”¨æˆ·æˆåŠŸç™»å½•åï¼Œåç«¯ä¼šå°†å½“å‰ç”¨æˆ·çš„ Token ä¿¡æ¯å­˜å‚¨åœ¨å“åº”å¤´ä¸­ï¼Œå‰ç«¯åº”å½“æ‹¿åˆ°è¿™ä¸ª Token ä¿¡æ¯ï¼Œå¹¶åœ¨æ¯æ¬¡å‘åç«¯å‘é€è¯·æ±‚æ—¶æºå¸¦è¿™ä¸ª Token ä¿¡æ¯ç”¨äºç”¨æˆ·éªŒè¯ã€‚</p>
<p>è·å–å“åº”å¤´ä¸­ Token ä¿¡æ¯çš„æ–¹å¼ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">window</span>.<span class="property">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&quot;token&quot;</span>, res.<span class="property">headers</span>.<span class="property">authorization</span>);</span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­ï¼Œ<code>res</code> ä¸º Axios è¯·æ±‚å‘é€æˆåŠŸåçš„å“åº”ä½“ã€‚</p>
<p>åœ¨è¿™é‡Œï¼Œæˆ‘å°† Token ä¿¡æ¯å­˜å‚¨åˆ° <code>localStorage</code> ä¸­ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥å­˜å‚¨åˆ° <code>sessionStorage</code> ä¸­ï¼Œè¿™ä¸¤è€…ä¸ <code>cookie</code> çš„åŒºåˆ«<sup class="footnote-ref"><a href="#fn4" id="fnref4">[4]</a></sup>å¦‚ä¸‹ï¼š</p>
<p>1ã€cookie æ•°æ®å§‹ç»ˆåœ¨åŒæºçš„ http è¯·æ±‚ä¸­æºå¸¦ï¼ˆå³ä½¿ä¸éœ€è¦ï¼‰ï¼Œå³ cookie åœ¨æµè§ˆå™¨å’ŒæœåŠ¡å™¨é—´æ¥å›ä¼ é€’ï¼Œè€Œ sessionStorage å’Œ localStorage ä¸ä¼šè‡ªåŠ¨æŠŠæ•°æ®å‘é€ç»™æœåŠ¡å™¨ï¼Œä»…åœ¨æœ¬åœ°ä¿å­˜ã€‚cookie æ•°æ®è¿˜æœ‰è·¯å¾„ï¼ˆpathï¼‰çš„æ¦‚å¿µï¼Œå¯ä»¥é™åˆ¶ cookie åªå±äºæŸä¸ªè·¯å¾„ä¸‹</p>
<p>2ã€å­˜å‚¨å¤§å°é™åˆ¶ä¹Ÿä¸åŒã€‚cookie æ•°æ®ä¸èƒ½è¶…è¿‡ 4Kï¼ŒåŒæ—¶å› ä¸ºæ¯æ¬¡ http è¯·æ±‚éƒ½ä¼šæºå¸¦ cookieï¼Œæ‰€ä»¥ cookie åªé€‚åˆä¿å­˜å¾ˆå°çš„æ•°æ®ï¼Œå¦‚ä¼šè¯æ ‡è¯†ã€‚sessionStorage å’Œ localStorage è™½ç„¶ä¹Ÿæœ‰å­˜å‚¨å¤§å°çš„é™åˆ¶ï¼Œä½†æ¯” cookie å¤§å¾—å¤šï¼Œå¯ä»¥è¾¾åˆ° 5M æˆ–æ›´å¤§</p>
<p>3ã€æ•°æ®æœ‰æ•ˆæœŸä¸åŒã€‚sessionStorage ä»…åœ¨å½“å‰æµè§ˆå™¨çª—å£å…³é—­ä¹‹å‰æœ‰æ•ˆï¼›localStorage å§‹ç»ˆæœ‰æ•ˆï¼Œçª—å£æˆ–æµè§ˆå™¨å…³é—­ä¹Ÿä¸€ç›´ä¿å­˜ï¼Œå› æ­¤ç”¨ä½œæŒä¹…æ•°æ®ï¼›cookie åªåœ¨è®¾ç½®çš„ cookie è¿‡æœŸæ—¶é—´ä¹‹å‰æœ‰æ•ˆï¼Œå³ä½¿çª—å£å…³é—­æˆ–æµè§ˆå™¨å…³é—­</p>
<p>4ã€ä½œç”¨åŸŸä¸åŒã€‚sessionStorage ä¸åœ¨ä¸åŒçš„æµè§ˆå™¨çª—å£ä¸­å…±äº«ï¼Œå³ä½¿æ˜¯åŒä¸€ä¸ªé¡µé¢ï¼›localstorage åœ¨æ‰€æœ‰åŒæºçª—å£ä¸­éƒ½æ˜¯å…±äº«çš„ï¼›cookie ä¹Ÿæ˜¯åœ¨æ‰€æœ‰åŒæºçª—å£ä¸­éƒ½æ˜¯å…±äº«çš„</p>
<p>5ã€web Storage æ”¯æŒäº‹ä»¶é€šçŸ¥æœºåˆ¶ï¼Œå¯ä»¥å°†æ•°æ®æ›´æ–°çš„é€šçŸ¥å‘é€ç»™ç›‘å¬è€…</p>
<p>6ã€web Storage çš„ api æ¥å£ä½¿ç”¨æ›´æ–¹ä¾¿</p>
<p><code>localStorage</code> çš„ä½¿ç”¨æ–¹å¼å¾ˆç®€å•ï¼Œå‚è€ƒã€localStorage ä½¿ç”¨æ€»ç»“ã€‘<sup class="footnote-ref"><a href="#fn5" id="fnref5">[5]</a></sup>ä¸€æ–‡ã€‚</p>
<h1 id="12-ç»“è¯­"><a class="header-anchor" href="#12-ç»“è¯­"></a>12. ç»“è¯­</h1>
<p>ä»¥ä¸Šå°±æ˜¯æˆ‘æœ¬æ¬¡æ¯•ä¸šè®¾è®¡ä¸€ä¸ªç®€å•çš„æ€»ç»“ï¼Œç”±äºä»£ç é‡æ¯”è¾ƒå¤§ï¼Œå¯èƒ½æœ‰äº›åœ°æ–¹å¹¶ä¸å®Œå–„ï¼Œå¦‚æœæœ‰ä¸å®Œå–„çš„åœ°æ–¹åç»­å†è¡¥å……å§ã€‚</p>
<p>å›æœ›æ•´ä¸ªè¿‡ç¨‹ï¼Œå…¶å®è¿™æ¬¡æ¯•ä¸šè®¾è®¡åœ¨æŠ€æœ¯é¢†åŸŸä¸Šå¹¶ä¸éš¾ï¼Œéš¾çš„æ˜¯æŸäº›åŠŸèƒ½çš„å®ç°é€»è¾‘ã€‚çºµè§‚æ•´ä¸ªåç«¯ä»£ç ï¼Œç”±äºæˆ‘åˆæœŸçš„è®¾è®¡é—®é¢˜ï¼Œé€ æˆäº†å¾ˆå¤šä»£ç å†—ä½™ï¼ˆå½“ç„¶ï¼Œè¿™ä¸ªé—®é¢˜åœ¨å‰ç«¯ä¸Šæ›´ä¸ºä¸¥é‡ï¼‰ï¼Œå› æ­¤åœ¨ä»£ç çš„è®¾è®¡ä¸æ•´æ´æ–¹é¢è¿˜éœ€è¦æ›´å¤šçš„å­¦ä¹ ã€‚</p>
<p>ä½†åº†å¹¸çš„æ˜¯ï¼Œå› ä¸ºæœ¬æ¬¡æ¯•ä¸šè®¾è®¡æ˜¯ä» 0 å¼€å§‹ï¼ˆæ— è®ºå‰ç«¯è¿˜æ˜¯åç«¯ï¼‰ï¼Œä»å¯è¡Œæ€§åˆ†æä¸€æ­¥æ­¥èµ°åˆ°æµ‹è¯•ï¼Œåœ¨è¿™æœŸé—´è¿˜æ˜¯å­¦åˆ°äº†å¾ˆå¤šä¸œè¥¿ï¼Œä¹Ÿæ²¡æ‰è´¹æˆ‘ä¸¤ä¸ªæœˆçš„å®ä¹ å·¥èµ„ã€‚</p>
<p>ä»æœ¬æ–‡çš„å°é¢å¯ä»¥çœ‹å‡ºï¼Œæˆ‘å°†æˆ‘çš„æŒ‡å¯¼è€å¸ˆå§“åæ·»åŠ äº†ä¸Šå»ï¼ˆè™½ç„¶ä½ å¹¶ä¸è®¤è¯†ï¼Œä½†è¿™æ²¡æœ‰å…³ç³»ï¼‰ï¼Œå†æ¬¡å‘éƒ­è€å¸ˆè¡¨ç¤ºç”±è¡·çš„æ„Ÿè°¢ã€‚æœ¬æ¬¡æ¯•ä¸šè®¾è®¡çš„é€‰é¢˜æ˜¯ç”±æˆ‘çš„æŒ‡å¯¼è€å¸ˆæ‰€ç»™å®šçš„ï¼Œæ„Ÿè°¢éƒ­è€å¸ˆåœ¨ç³»ç»Ÿå‰æœŸè®¾è®¡æ—¶ç»™äºˆæˆ‘ä¼—å¤šçš„å®è´µæ„è§ä¸å‚è€ƒï¼ŒæŒ‡å¯¼æˆ‘åˆ†æã€è®¾è®¡ã€å®ç°æ•´ä¸ªç³»ç»Ÿã€‚åœ¨è®ºæ–‡æ’°å†™æ–¹é¢å°½å¿ƒå°½è´£çš„ä¸ºæˆ‘è®²è§£æ’°å†™è§„èŒƒä¸æ³¨æ„äº‹é¡¹ï¼Œå¹¶å¯¹æˆ‘çš„è®ºæ–‡è¿›è¡Œäº†ä»”ç»†ã€åå¤çš„æ£€æŸ¥ï¼Œå‡†ç¡®å¾—ç»™å‡ºä¿®æ”¹æ„è§ï¼Œæ­£æ˜¯å› ä¸ºæœ‰éƒ­è€å¸ˆçš„å¸®åŠ©ï¼Œç³»ç»Ÿä¸è®ºæ–‡æ‰å¾—ä»¥é¡ºåˆ©å®Œæˆã€‚</p>
<p>æˆ‘è¿˜å°†æˆ‘å¤§å­¦å››å¹´æ‰€åœ¨çš„ç­çº§ä¹Ÿæ·»åŠ äº†ä¸Šå»ï¼Œä»¥æ­¤çºªå¿µæˆ‘é€å»çš„å¤§å­¦æ—¶å…‰ã€‚</p>
<hr class="footnotes-sep">
<section class="footnotes">
<ol class="footnotes-list">
<li id="fn1" class="footnote-item"><p>èœé¸Ÿå·¥å…· æ­£åˆ™è¡¨è¾¾å¼ åœ¨çº¿æµ‹è¯•ï¼š<a target="_blank" rel="noopener" href="https://c.runoob.com/front-end/854">é“¾æ¥</a> <a href="#fnref1" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn2" class="footnote-item"><p>Hutool å‚è€ƒæ–‡æ¡£ï¼š<a target="_blank" rel="noopener" href="https://hutool.cn/docs/#/">é“¾æ¥</a> <a href="#fnref2" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn3" class="footnote-item"><p>Hutool API æ–‡æ¡£ï¼š<a target="_blank" rel="noopener" href="https://apidoc.gitee.com/dromara/hutool/">é“¾æ¥</a> <a href="#fnref3" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn4" class="footnote-item"><p>Cookieã€sessionå’ŒlocalStorageã€ä»¥åŠsessionStorageä¹‹é—´çš„åŒºåˆ«ï¼š<a target="_blank" rel="noopener" href="https://www.cnblogs.com/lishiyuan/p/10273991.html">é“¾æ¥</a> <a href="#fnref4" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn5" class="footnote-item"><p>localStorageä½¿ç”¨æ€»ç»“ï¼š<a target="_blank" rel="noopener" href="https://www.cnblogs.com/st-leslie/p/5617130">é“¾æ¥</a> <a href="#fnref5" class="footnote-backref">â†©ï¸</a></p>
</li>
</ol>
</section>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="https://mofan212.github.io">é»˜çƒ¦</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="https://mofan212.github.io/posts/Code-Summary-Of-Graduation-Project/">https://mofan212.github.io/posts/Code-Summary-Of-Graduation-Project/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥æº <a href="https://mofan212.github.io" target="_blank">Mofan</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Code-In-Practice/">Code-In-Practice</a></div><div class="post-share"><div class="social-share" data-image="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/ArticleCover/87.png" data-sites="wechat,qq,weibo,facebook,x"></div><link rel="stylesheet" href="https://testingcf.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://testingcf.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i>èµåŠ©</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/AliPay.png" target="_blank"><img class="post-qr-code-img" src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/loading.gif" data-lazy-src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/AliPay.png" alt="æ”¯ä»˜å®"/></a><div class="post-qr-code-desc">æ”¯ä»˜å®</div></li><li class="reward-item"><a href="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/WeChatPay.png" target="_blank"><img class="post-qr-code-img" src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/loading.gif" data-lazy-src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/WeChatPay.png" alt="å¾®ä¿¡"/></a><div class="post-qr-code-desc">å¾®ä¿¡</div></li></ul></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/posts/Basic-Use-Of-Json-Web-Token/" title="JWT çš„åŸºæœ¬ä½¿ç”¨"><img class="cover" src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/loading.gif" data-lazy-src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/ArticleCover/86.png" onerror="onerror=null;src='https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">ä¸Šä¸€ç¯‡</div><div class="info-item-2">JWT çš„åŸºæœ¬ä½¿ç”¨</div></div><div class="info-2"><div class="info-item-1">æœ¬æ–‡ä»‹ç»äº† JWT çš„ç»“æ„ä»¥åŠä¸ Spring Securityã€Redis çš„ç®€å•æ•´åˆã€‚</div></div></div></a><a class="pagination-related" href="/posts/Design-Pattern-Factory-Pattern/" title="ã€è®¾è®¡æ¨¡å¼ã€‘å·¥å‚æ¨¡å¼"><img class="cover" src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/loading.gif" data-lazy-src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/ArticleCover/88.png" onerror="onerror=null;src='https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">ä¸‹ä¸€ç¯‡</div><div class="info-item-2">ã€è®¾è®¡æ¨¡å¼ã€‘å·¥å‚æ¨¡å¼</div></div><div class="info-2"><div class="info-item-1">æœ¬æ–‡ä¸»è¦å¯¹ Java è®¾è®¡æ¨¡å¼ä¸­çš„å·¥å‚æ¨¡å¼è¿›è¡Œäº†ä»‹ç»ã€‚</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>ç›¸å…³æ¨è</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/posts/Record-A-Test/" title="ã€éšç¬”ã€‘è®°ä¸€æ¬¡å…¥èŒæµ‹è¯•"><img class="cover" src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/loading.gif" data-lazy-src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/ArticleCover/71.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2020-12-03</div><div class="info-item-2">ã€éšç¬”ã€‘è®°ä¸€æ¬¡å…¥èŒæµ‹è¯•</div></div><div class="info-2"><div class="info-item-1">è™šå¿ƒå­¦ä¹ ï¼ŒåŠ æ²¹åŠªåŠ›ã€‚è‡ªå·±è¦èµ°çš„è·¯è¿˜æœ‰å¾ˆè¿œï¼Œè¦å­¦ä¹ çš„çŸ¥è¯†è¿˜æœ‰å¾ˆå¤šã€‚</div></div></div></a><a class="pagination-related" href="/posts/Ways-To-Eliminate-Bugs-1/" title="è‡­è™«æ²»ç†æ–¹æ¡ˆï¼ˆä¸€ï¼‰"><img class="cover" src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/loading.gif" data-lazy-src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/ArticleCover/70.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2020-12-02</div><div class="info-item-2">è‡­è™«æ²»ç†æ–¹æ¡ˆï¼ˆä¸€ï¼‰</div></div><div class="info-2"><div class="info-item-1">æœ¬æ–‡ä½œä¸ºæ—¥å¸¸å­¦ä¹ å·¥ä½œæ€»ç»“ï¼Œä¸»è¦ç”¨äºè®°å½•é‡åˆ°çš„å„ç§é¡½å›ºâ€œè‡­è™«â€ã€‚</div></div></div></a><a class="pagination-related" href="/posts/Implement-Dubbo-Default-Service/" title="å®ç° Dubbo é»˜è®¤æœåŠ¡"><img class="cover" src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/loading.gif" data-lazy-src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/ArticleCover/160.webp" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-04-20</div><div class="info-item-2">å®ç° Dubbo é»˜è®¤æœåŠ¡</div></div><div class="info-2"><div class="info-item-1">æ€»ç»“å·¥ä½œä¸å­¦ä¹ ä¸­é˜…è¯»æºç çš„åŒºåˆ«ã€‚</div></div></div></a><a class="pagination-related" href="/posts/Using-Lambda-Expressions-To-Refactor-Backtracking/" title="ä½¿ç”¨ Lambda è¡¨è¾¾å¼é‡æ„æˆå›æº¯"><img class="cover" src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/loading.gif" data-lazy-src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/ArticleCover/143.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2023-11-12</div><div class="info-item-2">ä½¿ç”¨ Lambda è¡¨è¾¾å¼é‡æ„æˆå›æº¯</div></div><div class="info-2"><div class="info-item-1">ä½¿ç”¨ Lambda è¡¨è¾¾å¼ä¸ºä»£ç é‡æ„æä¾›æ–°æ€è·¯ã€‚</div></div></div></a><a class="pagination-related" href="/posts/Java-Lambda-In-Action/" title="Java Lambda In Action"><img class="cover" src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/loading.gif" data-lazy-src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/ArticleCover/159.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-03-19</div><div class="info-item-2">Java Lambda In Action</div></div><div class="info-2"><div class="info-item-1">è®²è§£ä¸ä¸€æ ·çš„ Lambda è¡¨è¾¾å¼ç”¨æ³•ï¼Œå¸Œæœ›èƒ½ç»™ä½ å¸¦æ¥ä¸€äº›å¯å‘ã€‚</div></div></div></a><a class="pagination-related" href="/posts/Reduce-Functions/" title="Reduce Functions"><img class="cover" src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/loading.gif" data-lazy-src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/ArticleCover/137.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2023-08-27</div><div class="info-item-2">Reduce Functions</div></div><div class="info-2"><div class="info-item-1">Stream å°±æ˜¯ Lambda è¡¨è¾¾å¼çš„å…¨éƒ¨ï¼Ÿæˆ–è®¸æœ¬æ–‡å¯ä»¥ç»™ä½ ä¸€ç‚¹å¯å‘ã€‚</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/loading.gif" data-lazy-src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/avatar.jpg" onerror="this.onerror=null;this.src='https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">é»˜çƒ¦</div><div class="author-info-description">å½©ç¬”çš„æ‰“æ€ªå‡çº§ä¹‹è·¯...</div><div class="site-data"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">174</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">54</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">37</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/mofan212"><i class="fab fa-github"></i><span>follow me</span></a><div class="card-info-social-icons"><a class="social-icon" href="mailto:cy.mofan@foxmail.com" target="_blank" title="é‚®ç®±"><i class="fas fa-envelope"></i></a><a class="social-icon" href="/atom.xml" target="_blank" title="RSS"><i class="fa fa-rss"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>å…¬å‘Š</span></div><div class="announcement_content">æœ¬ç«™æ‰€æœ‰åšæ–‡å‡æ˜¯åšä¸»çš„å­¦ä¹ ç¬”è®°ä¸ä¸ªäººç†è§£ã€‚<strong><font style="color:red">é™¤ç‰¹åˆ«æ³¨æ˜å¤–ï¼Œ</font>å¦‚éœ€è½¬è½½ï¼Œè¯·åœ¨æ–‡ç« å¤´éƒ¨é†’ç›®å¤„é™„å¸¦åŸæ–‡é“¾æ¥å¹¶<a href="./mine/" style="color:#49B1F5;text-decoration:underline">å‘ŠçŸ¥æˆ‘</a></strong>ä½ å°†è½¬è½½ã€‚ğŸ˜Š</br><strong><font style="color:red">ä¸¥ç¦æœªéµå¾ªè§„èŒƒçš„è½¬è½½ã€‚</font></strong>ğŸ˜¡</br><strong>æ­»å»çš„è¯„è®ºç³»ç»Ÿå¤æ´»å•¦ï¼æ¬¢è¿åˆ°ç•™è¨€æ¿ç•…æ‰€æ¬²è¨€ï¼</strong>å½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨æ›´é«˜æ•ˆçš„<a target="_blank" href="https://space.bilibili.com/23658864/dynamic" style="color:#49B1F5;text-decoration:underline"> å“”å“©å“”å“©ç§ä¿¡ </a>æˆ–<a href="mailto:cy.mofan@foxmail.com" style="color:#49B1F5;text-decoration:underline" target="_blank">é‚®ç®±</a>ã€‚ ğŸ˜‰</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#0-%E5%89%8D%E8%A8%80"><span class="toc-text">0. å‰è¨€</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#1-%E5%90%8E%E7%AB%AF-%E8%87%AA%E5%AE%9A%E4%B9%89%E7%B1%BB"><span class="toc-text">1. åç«¯ - è‡ªå®šä¹‰ç±»</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-1-JSR-303-%E5%BC%82%E5%B8%B8%E4%BF%A1%E6%81%AF%E7%B1%BB"><span class="toc-text">1.1 JSR-303 å¼‚å¸¸ä¿¡æ¯ç±»</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-2-%E8%87%AA%E5%AE%9A%E4%B9%89%E4%B8%9A%E5%8A%A1%E5%BC%82%E5%B8%B8%E7%B1%BB"><span class="toc-text">1.2 è‡ªå®šä¹‰ä¸šåŠ¡å¼‚å¸¸ç±»</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-3-%E7%BB%9F%E4%B8%80%E8%BF%94%E5%9B%9E%E5%80%BC"><span class="toc-text">1.3 ç»Ÿä¸€è¿”å›å€¼</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-4-%E5%88%86%E9%A1%B5%E8%AF%B7%E6%B1%82%E5%AF%B9%E8%B1%A1"><span class="toc-text">1.4 åˆ†é¡µè¯·æ±‚å¯¹è±¡</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-5-%E6%9E%9A%E4%B8%BE%E6%8E%A5%E5%8F%A3"><span class="toc-text">1.5 æšä¸¾æ¥å£</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-6-%E5%AE%9E%E4%BD%93%E5%9F%BA%E7%B1%BB"><span class="toc-text">1.6 å®ä½“åŸºç±»</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-7-%E6%95%B0%E6%8D%AE%E4%BC%A0%E8%BE%93%E5%AF%B9%E8%B1%A1%E5%9F%BA%E7%B1%BB"><span class="toc-text">1.7 æ•°æ®ä¼ è¾“å¯¹è±¡åŸºç±»</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-%E5%90%8E%E7%AB%AF-SpringBoot"><span class="toc-text">2. åç«¯ - SpringBoot</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#2-1-%E7%BB%9F%E4%B8%80%E5%BC%82%E5%B8%B8%E6%8B%A6%E6%88%AA"><span class="toc-text">2.1 ç»Ÿä¸€å¼‚å¸¸æ‹¦æˆª</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-2-JSR-303-%E6%A0%A1%E9%AA%8C"><span class="toc-text">2.2 JSR-303 æ ¡éªŒ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-3-%E8%87%AA%E5%AE%9A%E4%B9%89%E6%A0%A1%E9%AA%8C%E6%B3%A8%E8%A7%A3"><span class="toc-text">2.3 è‡ªå®šä¹‰æ ¡éªŒæ³¨è§£</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-4-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E9%99%90%E5%88%B6"><span class="toc-text">2.4 æ–‡ä»¶ä¸Šä¼ é™åˆ¶</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3-%E5%90%8E%E7%AB%AF-%E9%98%BF%E9%87%8C%E4%BA%91-OSS"><span class="toc-text">3. åç«¯ - é˜¿é‡Œäº‘ OSS</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#4-%E5%90%8E%E7%AB%AF-logback"><span class="toc-text">4.åç«¯ - logback</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#5-%E5%90%8E%E7%AB%AF-%E5%88%87%E9%9D%A2"><span class="toc-text">5. åç«¯ - åˆ‡é¢</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#6-%E5%90%8E%E7%AB%AF-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E5%8A%A0%E5%AF%86"><span class="toc-text">6. åç«¯ - é…ç½®æ–‡ä»¶åŠ å¯†</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#6-1-%E8%87%AA%E5%AE%9A%E4%B9%89%E5%8A%A0%E5%AF%86%E5%89%8D%E5%90%8E%E7%BC%80"><span class="toc-text">6.1 è‡ªå®šä¹‰åŠ å¯†å‰åç¼€</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-2-%E6%9B%B4%E5%A4%9A%E8%87%AA%E5%AE%9A%E4%B9%89"><span class="toc-text">6.2 æ›´å¤šè‡ªå®šä¹‰</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#7-%E5%90%8E%E7%AB%AF-%E5%B7%A5%E5%85%B7%E7%B1%BB"><span class="toc-text">7. åç«¯ - å·¥å…·ç±»</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#7-1-Hutool"><span class="toc-text">7.1 Hutool</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-2-%E4%BD%BF%E7%94%A8%E7%9A%84%E5%B7%A5%E5%85%B7%E7%B1%BB"><span class="toc-text">7.2 ä½¿ç”¨çš„å·¥å…·ç±»</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#8-%E5%90%8E%E7%AB%AF-%E5%85%B6%E4%BB%96"><span class="toc-text">8. åç«¯ - å…¶ä»–</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#8-1-DateTimeFormat-%E4%B8%8E-JsonFormat-%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-text">8.1 @DateTimeFormat ä¸ @JsonFormat çš„åŒºåˆ«</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-2-Excel-%E7%9A%84%E5%AF%BC%E5%87%BA"><span class="toc-text">8.2 Excel çš„å¯¼å‡º</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#9-%E5%89%8D%E7%AB%AF-JS-%E7%9A%84%E5%B0%81%E8%A3%85"><span class="toc-text">9. å‰ç«¯ - JS çš„å°è£…</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#9-1-http-js"><span class="toc-text">9.1 http.js</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-2-tools-js"><span class="toc-text">9.2 tools.js</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-3-file-js"><span class="toc-text">9.3 file.js</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-4-date-js"><span class="toc-text">9.4 date.js</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-5-request-js"><span class="toc-text">9.5 request.js</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-6-validate-js"><span class="toc-text">9.6 validate.js</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-7-index-js"><span class="toc-text">9.7 index.js</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#10-Element-UI-%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-text">10. Element-UI çš„ä½¿ç”¨</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#10-1-%E5%9C%A8%E8%A1%A8%E5%8D%95%E6%8C%87%E5%AE%9A%E5%AD%97%E6%AE%B5%E4%B8%8B%E6%8F%90%E7%A4%BA%E9%94%99%E8%AF%AF%E4%BF%A1%E6%81%AF"><span class="toc-text">10.1 åœ¨è¡¨å•æŒ‡å®šå­—æ®µä¸‹æç¤ºé”™è¯¯ä¿¡æ¯</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-2-el-select-%E8%AE%BE%E7%BD%AE-multiple-%E5%90%8E%E5%87%BA%E7%8E%B0%E7%9A%84%E9%97%AE%E9%A2%98"><span class="toc-text">10.2 el-select è®¾ç½® multiple åå‡ºç°çš„é—®é¢˜</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#11-%E5%89%8D%E7%AB%AF-%E5%85%B6%E4%BB%96"><span class="toc-text">11. å‰ç«¯ - å…¶ä»–</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#11-1-%E5%90%8E%E7%AB%AF-ID-%E5%BC%82%E5%B8%B8"><span class="toc-text">11.1 åç«¯ ID å¼‚å¸¸</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-2-Token-%E4%BF%A1%E6%81%AF%E7%9A%84%E5%AD%98%E5%82%A8"><span class="toc-text">11.2 Token ä¿¡æ¯çš„å­˜å‚¨</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#12-%E7%BB%93%E8%AF%AD"><span class="toc-text">12. ç»“è¯­</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/Something-About-Blog/" title="åšå®¢æ­å»ºä¸ç»´æŠ¤"><img src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/loading.gif" data-lazy-src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/ArticleCover/42.jpg" onerror="this.onerror=null;this.src='https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/404.jpg'" alt="åšå®¢æ­å»ºä¸ç»´æŠ¤"/></a><div class="content"><a class="title" href="/posts/Something-About-Blog/" title="åšå®¢æ­å»ºä¸ç»´æŠ¤">åšå®¢æ­å»ºä¸ç»´æŠ¤</a><time datetime="2026-01-24T16:00:00.000Z" title="æ›´æ–°äº 2026-01-25 00:00:00">2026-01-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/Java-Memory-Model/" title="Java å†…å­˜æ¨¡å‹"><img src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/loading.gif" data-lazy-src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/ArticleCover/174.png" onerror="this.onerror=null;this.src='https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/404.jpg'" alt="Java å†…å­˜æ¨¡å‹"/></a><div class="content"><a class="title" href="/posts/Java-Memory-Model/" title="Java å†…å­˜æ¨¡å‹">Java å†…å­˜æ¨¡å‹</a><time datetime="2026-01-02T16:00:00.000Z" title="æ›´æ–°äº 2026-01-03 00:00:00">2026-01-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/Java-Bytecode-And-Class-Loading/" title="å­—èŠ‚ç ä¸ç±»åŠ è½½"><img src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/loading.gif" data-lazy-src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/ArticleCover/173.png" onerror="this.onerror=null;this.src='https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/404.jpg'" alt="å­—èŠ‚ç ä¸ç±»åŠ è½½"/></a><div class="content"><a class="title" href="/posts/Java-Bytecode-And-Class-Loading/" title="å­—èŠ‚ç ä¸ç±»åŠ è½½">å­—èŠ‚ç ä¸ç±»åŠ è½½</a><time datetime="2026-01-01T16:00:00.000Z" title="æ›´æ–°äº 2026-01-02 00:00:00">2026-01-02</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/Class-Resource-Loading-In-Java/" title="Java çš„ç±»èµ„æºåŠ è½½"><img src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/loading.gif" data-lazy-src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/ArticleCover/103.png" onerror="this.onerror=null;this.src='https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/404.jpg'" alt="Java çš„ç±»èµ„æºåŠ è½½"/></a><div class="content"><a class="title" href="/posts/Class-Resource-Loading-In-Java/" title="Java çš„ç±»èµ„æºåŠ è½½">Java çš„ç±»èµ„æºåŠ è½½</a><time datetime="2026-01-01T16:00:00.000Z" title="æ›´æ–°äº 2026-01-02 00:00:00">2026-01-02</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/Annotation-And-Reflection/" title="æ³¨è§£ã€ç±»çš„åŠ è½½ã€åå°„"><img src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/loading.gif" data-lazy-src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/ArticleCover/20.jpg" onerror="this.onerror=null;this.src='https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/404.jpg'" alt="æ³¨è§£ã€ç±»çš„åŠ è½½ã€åå°„"/></a><div class="content"><a class="title" href="/posts/Annotation-And-Reflection/" title="æ³¨è§£ã€ç±»çš„åŠ è½½ã€åå°„">æ³¨è§£ã€ç±»çš„åŠ è½½ã€åå°„</a><time datetime="2026-01-01T16:00:00.000Z" title="æ›´æ–°äº 2026-01-02 00:00:00">2026-01-02</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/ren-zhi-jue-xing/" title="è®¤çŸ¥è§‰é†’"><img src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/loading.gif" data-lazy-src="https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/ArticleCover/172.webp" onerror="this.onerror=null;this.src='https://mofan-blog-pics.oss-cn-chengdu.aliyuncs.com/myblog/404.jpg'" alt="è®¤çŸ¥è§‰é†’"/></a><div class="content"><a class="title" href="/posts/ren-zhi-jue-xing/" title="è®¤çŸ¥è§‰é†’">è®¤çŸ¥è§‰é†’</a><time datetime="2025-12-28T16:00:00.000Z" title="æ›´æ–°äº 2025-12-29 00:00:00">2025-12-29</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2020 - 2026 By é»˜çƒ¦</span><span class="framework-info"><span>æ¡†æ¶ </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>ä¸»é¢˜ </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.5.3</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="æ—¥é—´å’Œå¤œé—´æ¨¡å¼åˆ‡æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.3"></script><script src="/js/main.js?v=5.5.3"></script><script src="https://testingcf.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><script src="https://testingcf.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://testingcf.jsdelivr.net/npm/vanilla-lazyload@latest/dist/lazyload.iife.min.js"></script><script src="https://testingcf.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><div class="js-pjax"><script>(() => {
  const runMermaid = ele => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

    ele.forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const config = mermaidSrc.dataset.config ? JSON.parse(mermaidSrc.dataset.config) : {}
      if (!config.theme) {
        config.theme = theme
      }
      const mermaidThemeConfig = `%%{init: ${JSON.stringify(config)}}%%\n`
      const mermaidID = `mermaid-${index}`
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)
      const renderMermaid = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      // mermaid v9 and v10 compatibility
      typeof renderFn === 'string' ? renderMermaid(renderFn) : renderFn.then(({ svg }) => renderMermaid(svg))
    })
  }

  const codeToMermaid = () => {
    const codeMermaidEle = document.querySelectorAll('pre > code.mermaid')
    if (codeMermaidEle.length === 0) return

    codeMermaidEle.forEach(ele => {
      const preEle = document.createElement('pre')
      preEle.className = 'mermaid-src'
      preEle.hidden = true
      preEle.textContent = ele.textContent
      const newEle = document.createElement('div')
      newEle.className = 'mermaid-wrap'
      newEle.appendChild(preEle)
      ele.parentNode.replaceWith(newEle)
    })
  }

  const loadMermaid = () => {
    if (true) codeToMermaid()
    const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
    if ($mermaid.length === 0) return

    const runMermaidFn = () => runMermaid($mermaid)
    btf.addGlobalFn('themeChange', runMermaidFn, 'mermaid')
    window.loadMermaid ? runMermaidFn() : btf.getScript('https://gcore.jsdelivr.net/npm/mermaid@11.12.0/dist/mermaid.min.js').then(runMermaidFn)
  }

  btf.addGlobalFn('encrypt', loadMermaid, 'mermaid')
  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script></div><script src="https://testingcf.jsdelivr.net/gh/mofan212/blog-static-resources@master/js/mine.min.js"></script><script src="/js/tip_portal.js"></script><script defer="defer" id="ribbon" src="https://testingcf.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="false"></script><script id="click-show-text" src="https://testingcf.jsdelivr.net/npm/butterfly-extsrc/dist/click-show-text.min.js" data-mobile="false" data-text="Azathoth,Yog-Sothoth,Shub-Niggurath,Nyarlathotep,Cthulhu,Hastur,Abhoth,Ghroth,Tsathoggua,Cthugha,Deep Ones,Dagon,Chaugnar Faugn,Mordiggian,Shoggoth,Old One,Mi-Go,Great Race of Yith,Flying Polyp,Hounds of Tindalos,Dhole" data-fontsize="15px" data-random="false" async="async"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div class="docsearch-wrap"><div id="docsearch" style="display:none"></div><link rel="stylesheet" href="https://testingcf.jsdelivr.net/npm/@docsearch/css/dist/style.min.css"/><script src="https://testingcf.jsdelivr.net/npm/@docsearch/js/dist/umd/index.min.js"></script><script>(() => {
  docsearch(Object.assign({
    appId: 'BAFEL7A6K1',
    apiKey: '89fcb5961984c5c054bf04149f345f38',
    indexName: 'mofan212io',
    container: '#docsearch',
    placeholder: 'è¾“å…¥å…³é”®å­—è¿›è¡Œæœç´¢',
  }, null))

  const handleClick = () => {
    document.querySelector('.DocSearch-Button').click()
  }

  const searchClickFn = () => {
    btf.addEventListenerPjax(document.querySelector('#search-button > .search'), 'click', handleClick)
  }

  searchClickFn()
  window.addEventListener('pjax:complete', searchClickFn)
})()</script></div></div></body></html>